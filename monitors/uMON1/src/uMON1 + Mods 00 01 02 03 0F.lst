0001   0000             ; ######################################
0002   0000             ; #                                    #
0003   0000             ; #         uMON1 Version 1.10         #
0004   0000             ; #  --------------------------------  #
0005   0000             ; #   Special Key Sequences            #
0006   0000             ; #  --------------------------------  #
0007   0000             ; #   Shift-+ - Insert byte.           #
0008   0000             ; #   Shift-- - Delete byte.           #
0009   0000             ; #                                    #
0010   0000             ; #  --------------------------------  #
0011   0000             ; #   Included Modules                 #
0012   0000             ; #  --------------------------------  #
0013   0000             ; #  MOD00 - RAM Test       (Shift-0)  #
0014   0000             ; #  MOD01 - Serial Send    (Shift-1)  #
0015   0000             ; #  MOD02 - Serial Receive (Shift-2)  #
0016   0000             ; #  MOD03 - RAM Block Copy (Shift-3)  #
0017   0000             ; #  MOD0F - Serial Echo    (Shift-F)  #
0018   0000             ; #  --------------------------------  #
0019   0000             ; #                                    #
0020   0000             ; #  by Scott Gregory                  #
0021   0000             ; #  13/06/2021                        #
0022   0000             ; #                                    #
0023   0000             ; #  Last update                       #
0024   0000             ; #  30/07/2021                        #
0025   0000             ; ######################################
0026   0000             ;
0027   0000             STACKTOP	.EQU	$08C0 ; Stack position.
0028   0000             ROMBASE		.EQU	$0000 ; Start of ROM.
0029   0000             ROMTOP		.EQU	$07FF ; End of ROM.
0030   0000             RAMBASE		.EQU	$0900 ; Start of user RAM.
0031   0000             RAMTOP		.EQU	$FFFF ; End of user RAM.
0032   0000             CATHDLY		.EQU	$40 ; Digit display delay.
0033   0000             KEYPORT		.EQU	$00 ; Keypad port.
0034   0000             CATHPORT	.EQU	$01 ; Display catchode port.
0035   0000             SEGPORT		.EQU	$02 ; Display segment port.
0036   0000             ;
0037   0000             ADDRESS		.EQU	$08C0 ; 2 Bytes - Current monitor address.
0038   0000             SCRATCH		.EQU	$08C2 ; 3 Bytes - Display scratch space.
0039   0000             MODE		.EQU	$08C5 ; 1 Byte - Mode flags.
0040   0000             KEYDATA		.EQU	$08C6 ; 1 Byte - Current Keyscan data.
0041   0000             BEEPLENGTH	.EQU	$08C7 ; 2 Bytes - Next beep length store.
0042   0000             BEEPFREQ	.EQU	$08C9 ; 1 Byte - Next beep frequency store.
0043   0000             RNDSEEDA	.EQU	$08CA ; 2 Bytes - Random Seed A.
0044   0000             RNDSEEDB	.EQU	$08CC ; 2 Bytes - Random Seed B.
0045   0000             RANDOM		.EQU	$08CE ; 2 Byte - Generated random number.
0046   0000             GENERALA	.EQU	$08D0 ; 2 Bytes - General use Address / Data address A.
0047   0000             GENERALB	.EQU	$08D2 ; 2 Bytes - General use Address / Data address B.
0048   0000             GENERALC	.EQU	$08D4 ; 2 Bytes - General use Address / Data address C.
0049   0000             GENERALD	.EQU	$08D6 ; 2 Bytes - General use Address / Data address D.
0050   0000             SHIFTGO		.EQU	$08D8 ; 2 Bytes - Shift-GO destination address.
0051   0000             ;
0052   0000             ; Begin included modules.
0053   0000             ; #DEFINE INCLUDE_MODXX
0054   0000             #DEFINE INCLUDE_MOD00
0055   0000             #DEFINE INCLUDE_MOD01
0056   0000             #DEFINE INCLUDE_MOD02
0057   0000             #DEFINE INCLUDE_MOD03
0058   0000             #DEFINE INCLUDE_MOD0F
0059   0000             ; End included modules.
0060   0000             ;
0061   0000             ; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
0062   0000             ; Nothing is really configurable below this point
0063   0000             ; unless you know what you are doing.
0064   0000             ; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
0065   0000 00 00 00 00 			.FILL	(ROMTOP - ROMBASE) + 1, $00
0065   0004 00 00 00 00 
0065   0008 00 00 00 00 
0065   000C 00 00 00 00 
0065   0010 00 00 00 00 
0065   0014 00 00 00 00 
0065   0018 00 00 00 00 
0065   001C 00 00 00 00 
0065   0020 00 00 00 00 
0065   0024 00 00 00 00 
0065   0028 00 00 00 00 
0065   002C 00 00 00 00 
0065   0030 00 00 00 00 
0065   0034 00 00 00 00 
0065   0038 00 00 00 00 
0065   003C 00 00 00 00 
0065   0040 00 00 00 00 
0065   0044 00 00 00 00 
0065   0048 00 00 00 00 
0065   004C 00 00 00 00 
0065   0050 00 00 00 00 
0065   0054 00 00 00 00 
0065   0058 00 00 00 00 
0065   005C 00 00 00 00 
0065   0060 00 00 00 00 
0065   0064 00 00 00 00 
0065   0068 00 00 00 00 
0065   006C 00 00 00 00 
0065   0070 00 00 00 00 
0065   0074 00 00 00 00 
0065   0078 00 00 00 00 
0065   007C 00 00 00 00 
0065   0080 00 00 00 00 
0065   0084 00 00 00 00 
0065   0088 00 00 00 00 
0065   008C 00 00 00 00 
0065   0090 00 00 00 00 
0065   0094 00 00 00 00 
0065   0098 00 00 00 00 
0065   009C 00 00 00 00 
0065   00A0 00 00 00 00 
0065   00A4 00 00 00 00 
0065   00A8 00 00 00 00 
0065   00AC 00 00 00 00 
0065   00B0 00 00 00 00 
0065   00B4 00 00 00 00 
0065   00B8 00 00 00 00 
0065   00BC 00 00 00 00 
0065   00C0 00 00 00 00 
0065   00C4 00 00 00 00 
0065   00C8 00 00 00 00 
0065   00CC 00 00 00 00 
0065   00D0 00 00 00 00 
0065   00D4 00 00 00 00 
0065   00D8 00 00 00 00 
0065   00DC 00 00 00 00 
0065   00E0 00 00 00 00 
0065   00E4 00 00 00 00 
0065   00E8 00 00 00 00 
0065   00EC 00 00 00 00 
0065   00F0 00 00 00 00 
0065   00F4 00 00 00 00 
0065   00F8 00 00 00 00 
0065   00FC 00 00 00 00 
0065   0100 00 00 00 00 
0065   0104 00 00 00 00 
0065   0108 00 00 00 00 
0065   010C 00 00 00 00 
0065   0110 00 00 00 00 
0065   0114 00 00 00 00 
0065   0118 00 00 00 00 
0065   011C 00 00 00 00 
0065   0120 00 00 00 00 
0065   0124 00 00 00 00 
0065   0128 00 00 00 00 
0065   012C 00 00 00 00 
0065   0130 00 00 00 00 
0065   0134 00 00 00 00 
0065   0138 00 00 00 00 
0065   013C 00 00 00 00 
0065   0140 00 00 00 00 
0065   0144 00 00 00 00 
0065   0148 00 00 00 00 
0065   014C 00 00 00 00 
0065   0150 00 00 00 00 
0065   0154 00 00 00 00 
0065   0158 00 00 00 00 
0065   015C 00 00 00 00 
0065   0160 00 00 00 00 
0065   0164 00 00 00 00 
0065   0168 00 00 00 00 
0065   016C 00 00 00 00 
0065   0170 00 00 00 00 
0065   0174 00 00 00 00 
0065   0178 00 00 00 00 
0065   017C 00 00 00 00 
0065   0180 00 00 00 00 
0065   0184 00 00 00 00 
0065   0188 00 00 00 00 
0065   018C 00 00 00 00 
0065   0190 00 00 00 00 
0065   0194 00 00 00 00 
0065   0198 00 00 00 00 
0065   019C 00 00 00 00 
0065   01A0 00 00 00 00 
0065   01A4 00 00 00 00 
0065   01A8 00 00 00 00 
0065   01AC 00 00 00 00 
0065   01B0 00 00 00 00 
0065   01B4 00 00 00 00 
0065   01B8 00 00 00 00 
0065   01BC 00 00 00 00 
0065   01C0 00 00 00 00 
0065   01C4 00 00 00 00 
0065   01C8 00 00 00 00 
0065   01CC 00 00 00 00 
0065   01D0 00 00 00 00 
0065   01D4 00 00 00 00 
0065   01D8 00 00 00 00 
0065   01DC 00 00 00 00 
0065   01E0 00 00 00 00 
0065   01E4 00 00 00 00 
0065   01E8 00 00 00 00 
0065   01EC 00 00 00 00 
0065   01F0 00 00 00 00 
0065   01F4 00 00 00 00 
0065   01F8 00 00 00 00 
0065   01FC 00 00 00 00 
0065   0200 00 00 00 00 
0065   0204 00 00 00 00 
0065   0208 00 00 00 00 
0065   020C 00 00 00 00 
0065   0210 00 00 00 00 
0065   0214 00 00 00 00 
0065   0218 00 00 00 00 
0065   021C 00 00 00 00 
0065   0220 00 00 00 00 
0065   0224 00 00 00 00 
0065   0228 00 00 00 00 
0065   022C 00 00 00 00 
0065   0230 00 00 00 00 
0065   0234 00 00 00 00 
0065   0238 00 00 00 00 
0065   023C 00 00 00 00 
0065   0240 00 00 00 00 
0065   0244 00 00 00 00 
0065   0248 00 00 00 00 
0065   024C 00 00 00 00 
0065   0250 00 00 00 00 
0065   0254 00 00 00 00 
0065   0258 00 00 00 00 
0065   025C 00 00 00 00 
0065   0260 00 00 00 00 
0065   0264 00 00 00 00 
0065   0268 00 00 00 00 
0065   026C 00 00 00 00 
0065   0270 00 00 00 00 
0065   0274 00 00 00 00 
0065   0278 00 00 00 00 
0065   027C 00 00 00 00 
0065   0280 00 00 00 00 
0065   0284 00 00 00 00 
0065   0288 00 00 00 00 
0065   028C 00 00 00 00 
0065   0290 00 00 00 00 
0065   0294 00 00 00 00 
0065   0298 00 00 00 00 
0065   029C 00 00 00 00 
0065   02A0 00 00 00 00 
0065   02A4 00 00 00 00 
0065   02A8 00 00 00 00 
0065   02AC 00 00 00 00 
0065   02B0 00 00 00 00 
0065   02B4 00 00 00 00 
0065   02B8 00 00 00 00 
0065   02BC 00 00 00 00 
0065   02C0 00 00 00 00 
0065   02C4 00 00 00 00 
0065   02C8 00 00 00 00 
0065   02CC 00 00 00 00 
0065   02D0 00 00 00 00 
0065   02D4 00 00 00 00 
0065   02D8 00 00 00 00 
0065   02DC 00 00 00 00 
0065   02E0 00 00 00 00 
0065   02E4 00 00 00 00 
0065   02E8 00 00 00 00 
0065   02EC 00 00 00 00 
0065   02F0 00 00 00 00 
0065   02F4 00 00 00 00 
0065   02F8 00 00 00 00 
0065   02FC 00 00 00 00 
0065   0300 00 00 00 00 
0065   0304 00 00 00 00 
0065   0308 00 00 00 00 
0065   030C 00 00 00 00 
0065   0310 00 00 00 00 
0065   0314 00 00 00 00 
0065   0318 00 00 00 00 
0065   031C 00 00 00 00 
0065   0320 00 00 00 00 
0065   0324 00 00 00 00 
0065   0328 00 00 00 00 
0065   032C 00 00 00 00 
0065   0330 00 00 00 00 
0065   0334 00 00 00 00 
0065   0338 00 00 00 00 
0065   033C 00 00 00 00 
0065   0340 00 00 00 00 
0065   0344 00 00 00 00 
0065   0348 00 00 00 00 
0065   034C 00 00 00 00 
0065   0350 00 00 00 00 
0065   0354 00 00 00 00 
0065   0358 00 00 00 00 
0065   035C 00 00 00 00 
0065   0360 00 00 00 00 
0065   0364 00 00 00 00 
0065   0368 00 00 00 00 
0065   036C 00 00 00 00 
0065   0370 00 00 00 00 
0065   0374 00 00 00 00 
0065   0378 00 00 00 00 
0065   037C 00 00 00 00 
0065   0380 00 00 00 00 
0065   0384 00 00 00 00 
0065   0388 00 00 00 00 
0065   038C 00 00 00 00 
0065   0390 00 00 00 00 
0065   0394 00 00 00 00 
0065   0398 00 00 00 00 
0065   039C 00 00 00 00 
0065   03A0 00 00 00 00 
0065   03A4 00 00 00 00 
0065   03A8 00 00 00 00 
0065   03AC 00 00 00 00 
0065   03B0 00 00 00 00 
0065   03B4 00 00 00 00 
0065   03B8 00 00 00 00 
0065   03BC 00 00 00 00 
0065   03C0 00 00 00 00 
0065   03C4 00 00 00 00 
0065   03C8 00 00 00 00 
0065   03CC 00 00 00 00 
0065   03D0 00 00 00 00 
0065   03D4 00 00 00 00 
0065   03D8 00 00 00 00 
0065   03DC 00 00 00 00 
0065   03E0 00 00 00 00 
0065   03E4 00 00 00 00 
0065   03E8 00 00 00 00 
0065   03EC 00 00 00 00 
0065   03F0 00 00 00 00 
0065   03F4 00 00 00 00 
0065   03F8 00 00 00 00 
0065   03FC 00 00 00 00 
0065   0400 00 00 00 00 
0065   0404 00 00 00 00 
0065   0408 00 00 00 00 
0065   040C 00 00 00 00 
0065   0410 00 00 00 00 
0065   0414 00 00 00 00 
0065   0418 00 00 00 00 
0065   041C 00 00 00 00 
0065   0420 00 00 00 00 
0065   0424 00 00 00 00 
0065   0428 00 00 00 00 
0065   042C 00 00 00 00 
0065   0430 00 00 00 00 
0065   0434 00 00 00 00 
0065   0438 00 00 00 00 
0065   043C 00 00 00 00 
0065   0440 00 00 00 00 
0065   0444 00 00 00 00 
0065   0448 00 00 00 00 
0065   044C 00 00 00 00 
0065   0450 00 00 00 00 
0065   0454 00 00 00 00 
0065   0458 00 00 00 00 
0065   045C 00 00 00 00 
0065   0460 00 00 00 00 
0065   0464 00 00 00 00 
0065   0468 00 00 00 00 
0065   046C 00 00 00 00 
0065   0470 00 00 00 00 
0065   0474 00 00 00 00 
0065   0478 00 00 00 00 
0065   047C 00 00 00 00 
0065   0480 00 00 00 00 
0065   0484 00 00 00 00 
0065   0488 00 00 00 00 
0065   048C 00 00 00 00 
0065   0490 00 00 00 00 
0065   0494 00 00 00 00 
0065   0498 00 00 00 00 
0065   049C 00 00 00 00 
0065   04A0 00 00 00 00 
0065   04A4 00 00 00 00 
0065   04A8 00 00 00 00 
0065   04AC 00 00 00 00 
0065   04B0 00 00 00 00 
0065   04B4 00 00 00 00 
0065   04B8 00 00 00 00 
0065   04BC 00 00 00 00 
0065   04C0 00 00 00 00 
0065   04C4 00 00 00 00 
0065   04C8 00 00 00 00 
0065   04CC 00 00 00 00 
0065   04D0 00 00 00 00 
0065   04D4 00 00 00 00 
0065   04D8 00 00 00 00 
0065   04DC 00 00 00 00 
0065   04E0 00 00 00 00 
0065   04E4 00 00 00 00 
0065   04E8 00 00 00 00 
0065   04EC 00 00 00 00 
0065   04F0 00 00 00 00 
0065   04F4 00 00 00 00 
0065   04F8 00 00 00 00 
0065   04FC 00 00 00 00 
0065   0500 00 00 00 00 
0065   0504 00 00 00 00 
0065   0508 00 00 00 00 
0065   050C 00 00 00 00 
0065   0510 00 00 00 00 
0065   0514 00 00 00 00 
0065   0518 00 00 00 00 
0065   051C 00 00 00 00 
0065   0520 00 00 00 00 
0065   0524 00 00 00 00 
0065   0528 00 00 00 00 
0065   052C 00 00 00 00 
0065   0530 00 00 00 00 
0065   0534 00 00 00 00 
0065   0538 00 00 00 00 
0065   053C 00 00 00 00 
0065   0540 00 00 00 00 
0065   0544 00 00 00 00 
0065   0548 00 00 00 00 
0065   054C 00 00 00 00 
0065   0550 00 00 00 00 
0065   0554 00 00 00 00 
0065   0558 00 00 00 00 
0065   055C 00 00 00 00 
0065   0560 00 00 00 00 
0065   0564 00 00 00 00 
0065   0568 00 00 00 00 
0065   056C 00 00 00 00 
0065   0570 00 00 00 00 
0065   0574 00 00 00 00 
0065   0578 00 00 00 00 
0065   057C 00 00 00 00 
0065   0580 00 00 00 00 
0065   0584 00 00 00 00 
0065   0588 00 00 00 00 
0065   058C 00 00 00 00 
0065   0590 00 00 00 00 
0065   0594 00 00 00 00 
0065   0598 00 00 00 00 
0065   059C 00 00 00 00 
0065   05A0 00 00 00 00 
0065   05A4 00 00 00 00 
0065   05A8 00 00 00 00 
0065   05AC 00 00 00 00 
0065   05B0 00 00 00 00 
0065   05B4 00 00 00 00 
0065   05B8 00 00 00 00 
0065   05BC 00 00 00 00 
0065   05C0 00 00 00 00 
0065   05C4 00 00 00 00 
0065   05C8 00 00 00 00 
0065   05CC 00 00 00 00 
0065   05D0 00 00 00 00 
0065   05D4 00 00 00 00 
0065   05D8 00 00 00 00 
0065   05DC 00 00 00 00 
0065   05E0 00 00 00 00 
0065   05E4 00 00 00 00 
0065   05E8 00 00 00 00 
0065   05EC 00 00 00 00 
0065   05F0 00 00 00 00 
0065   05F4 00 00 00 00 
0065   05F8 00 00 00 00 
0065   05FC 00 00 00 00 
0065   0600 00 00 00 00 
0065   0604 00 00 00 00 
0065   0608 00 00 00 00 
0065   060C 00 00 00 00 
0065   0610 00 00 00 00 
0065   0614 00 00 00 00 
0065   0618 00 00 00 00 
0065   061C 00 00 00 00 
0065   0620 00 00 00 00 
0065   0624 00 00 00 00 
0065   0628 00 00 00 00 
0065   062C 00 00 00 00 
0065   0630 00 00 00 00 
0065   0634 00 00 00 00 
0065   0638 00 00 00 00 
0065   063C 00 00 00 00 
0065   0640 00 00 00 00 
0065   0644 00 00 00 00 
0065   0648 00 00 00 00 
0065   064C 00 00 00 00 
0065   0650 00 00 00 00 
0065   0654 00 00 00 00 
0065   0658 00 00 00 00 
0065   065C 00 00 00 00 
0065   0660 00 00 00 00 
0065   0664 00 00 00 00 
0065   0668 00 00 00 00 
0065   066C 00 00 00 00 
0065   0670 00 00 00 00 
0065   0674 00 00 00 00 
0065   0678 00 00 00 00 
0065   067C 00 00 00 00 
0065   0680 00 00 00 00 
0065   0684 00 00 00 00 
0065   0688 00 00 00 00 
0065   068C 00 00 00 00 
0065   0690 00 00 00 00 
0065   0694 00 00 00 00 
0065   0698 00 00 00 00 
0065   069C 00 00 00 00 
0065   06A0 00 00 00 00 
0065   06A4 00 00 00 00 
0065   06A8 00 00 00 00 
0065   06AC 00 00 00 00 
0065   06B0 00 00 00 00 
0065   06B4 00 00 00 00 
0065   06B8 00 00 00 00 
0065   06BC 00 00 00 00 
0065   06C0 00 00 00 00 
0065   06C4 00 00 00 00 
0065   06C8 00 00 00 00 
0065   06CC 00 00 00 00 
0065   06D0 00 00 00 00 
0065   06D4 00 00 00 00 
0065   06D8 00 00 00 00 
0065   06DC 00 00 00 00 
0065   06E0 00 00 00 00 
0065   06E4 00 00 00 00 
0065   06E8 00 00 00 00 
0065   06EC 00 00 00 00 
0065   06F0 00 00 00 00 
0065   06F4 00 00 00 00 
0065   06F8 00 00 00 00 
0065   06FC 00 00 00 00 
0065   0700 00 00 00 00 
0065   0704 00 00 00 00 
0065   0708 00 00 00 00 
0065   070C 00 00 00 00 
0065   0710 00 00 00 00 
0065   0714 00 00 00 00 
0065   0718 00 00 00 00 
0065   071C 00 00 00 00 
0065   0720 00 00 00 00 
0065   0724 00 00 00 00 
0065   0728 00 00 00 00 
0065   072C 00 00 00 00 
0065   0730 00 00 00 00 
0065   0734 00 00 00 00 
0065   0738 00 00 00 00 
0065   073C 00 00 00 00 
0065   0740 00 00 00 00 
0065   0744 00 00 00 00 
0065   0748 00 00 00 00 
0065   074C 00 00 00 00 
0065   0750 00 00 00 00 
0065   0754 00 00 00 00 
0065   0758 00 00 00 00 
0065   075C 00 00 00 00 
0065   0760 00 00 00 00 
0065   0764 00 00 00 00 
0065   0768 00 00 00 00 
0065   076C 00 00 00 00 
0065   0770 00 00 00 00 
0065   0774 00 00 00 00 
0065   0778 00 00 00 00 
0065   077C 00 00 00 00 
0065   0780 00 00 00 00 
0065   0784 00 00 00 00 
0065   0788 00 00 00 00 
0065   078C 00 00 00 00 
0065   0790 00 00 00 00 
0065   0794 00 00 00 00 
0065   0798 00 00 00 00 
0065   079C 00 00 00 00 
0065   07A0 00 00 00 00 
0065   07A4 00 00 00 00 
0065   07A8 00 00 00 00 
0065   07AC 00 00 00 00 
0065   07B0 00 00 00 00 
0065   07B4 00 00 00 00 
0065   07B8 00 00 00 00 
0065   07BC 00 00 00 00 
0065   07C0 00 00 00 00 
0065   07C4 00 00 00 00 
0065   07C8 00 00 00 00 
0065   07CC 00 00 00 00 
0065   07D0 00 00 00 00 
0065   07D4 00 00 00 00 
0065   07D8 00 00 00 00 
0065   07DC 00 00 00 00 
0065   07E0 00 00 00 00 
0065   07E4 00 00 00 00 
0065   07E8 00 00 00 00 
0065   07EC 00 00 00 00 
0065   07F0 00 00 00 00 
0065   07F4 00 00 00 00 
0065   07F8 00 00 00 00 
0065   07FC 00 00 00 00 
0066   0000             			.ORG	$0000
0067   0000 F3          RESET_00:	DI
0068   0001 C3 B8 02    			JP		SETUP
0069   0004             ;
0070   0008             			.ORG	$0008
0071   0008 F3          RESET_08:	DI
0072   0009 C3 B8 02    			JP		SETUP
0073   000C             ;
0074   0010             			.ORG	$0010
0075   0010 F3          RESET_10:	DI
0076   0011 C3 B8 02    			JP		SETUP
0077   0014             ;
0078   0018             			.ORG	$0018
0079   0018 F3          RESET_18:	DI
0080   0019 C3 B8 02    			JP		SETUP
0081   001C             ;
0082   0020             			.ORG	$0020
0083   0020 F3          RESET_20:	DI
0084   0021 C3 B8 02    			JP		SETUP
0085   0024             ;
0086   0028             			.ORG	$0028
0087   0028 F3          RESET_28:	DI
0088   0029 C3 B8 02    			JP		SETUP
0089   002C             ;
0090   0030             			.ORG	$0030
0091   0030 F3          RESET_30:	DI
0092   0031 C3 B8 02    			JP		SETUP
0093   0034             ;
0094   0038             			.ORG	$0038
0095   0038 F3          RESET_38:	DI
0096   0039 C3 B8 02    			JP		SETUP
0097   003C             ;
0098   0040             			.ORG	$0040
0099   0040 75 4D 4F 4E VERSION:	.DB	"uMON V1.10 by Scott Gregory"
0099   0044 20 56 31 2E 
0099   0048 31 30 20 62 
0099   004C 79 20 53 63 
0099   0050 6F 74 74 20 
0099   0054 47 72 65 67 
0099   0058 6F 72 79 
0100   005B             ;
0101   0066             			.ORG	$0066
0102   0066 F5          NMISERVICE:	PUSH	af ; Keyboard service routine.
0103   0067 DB 00       			IN		a,(KEYPORT)
0104   0069 E6 3F       			AND		$3F	; We're only interested in the first 6 bits.
0105   006B EE 20       			XOR		$20	; Flip bit 5 because bit 5 is low when the Shift key is pressed.
0106   006D 32 C6 08    			LD		(KEYDATA),a
0107   0070 F1          			POP		af
0108   0071 ED 45       			RETN
0109   0073             ;
0110   0080             			.ORG	$0080
0111   0080 AF          DISPLAY:	XOR		a ; Display update routine.
0112   0081 D3 01       			OUT		(CATHPORT),a ; Blank the display.
0113   0083 D3 02       			OUT		(SEGPORT),a
0114   0085 0E 20       			LD		c,$20 ; Set the last digit.
0115   0087 2A C0 08    			LD		hl,(ADDRESS)
0116   008A 7E          			LD		a,(hl)
0117   008B EB          			EX		de,hl
0118   008C 21 C2 08    			LD		hl,SCRATCH
0119   008F 77          			LD		(hl),a ; Add the data from the current address to the scratchpad.
0120   0090 23          			INC		hl
0121   0091 73          			LD		(hl),e ; Add the current address LSB to the scratchpad.
0122   0092 23          			INC		hl
0123   0093 72          			LD		(hl),d ; Add the current address MSB to the scratchpad.
0124   0094 11 EE 02    			LD		de,HEX2SEG
0125   0097 3A C5 08    			LD		a,(MODE)
0126   009A E6 10       			AND		$10
0127   009C 47          			LD		b,a
0128   009D CD B1 00    			CALL	DGTPAIR ; Decode and display digits 5 and 4.
0129   00A0 2B          			DEC		hl
0130   00A1 CD B1 00    			CALL	DGTPAIR ; Decode and display digits 3 and 2.
0131   00A4 2B          			DEC		hl
0132   00A5 3A C5 08    			LD		a,(MODE)
0133   00A8 E6 10       			AND		$10
0134   00AA EE 10       			XOR		$10
0135   00AC 47          			LD		b,a
0136   00AD CD B1 00    			CALL	DGTPAIR ; Decode and display digits 1 and 0.
0137   00B0 C9          			RET
0138   00B1             ;
0139   00B1 AF          DGTPAIR:	XOR		a
0140   00B2 ED 6F       			RLD
0141   00B4 E5          			PUSH	hl
0142   00B5 CD C2 00    			CALL	DECNSHOW
0143   00B8 E1          			POP		hl
0144   00B9 AF          			XOR		a
0145   00BA ED 6F       			RLD
0146   00BC E5          			PUSH	hl
0147   00BD CD C2 00    			CALL	DECNSHOW
0148   00C0 E1          			POP		hl
0149   00C1 C9          			RET
0150   00C2             ;
0151   00C2 26 00       DECNSHOW:	LD		h,$00
0152   00C4 6F          			LD		l,a
0153   00C5 19          			ADD		hl,de
0154   00C6 7E          			LD		a,(hl)
0155   00C7 B0          			OR		b
0156   00C8 C5          			PUSH	bc
0157   00C9 47          			LD		b,a
0158   00CA CD D2 00    			CALL	UPDATE
0159   00CD C1          			POP		bc
0160   00CE 79          			LD		a,c
0161   00CF 1F          			RRA
0162   00D0 4F          			LD		c,a
0163   00D1 C9          			RET			
0164   00D2             ;
0165   00D2 78          UPDATE:		LD		a,b
0166   00D3 D3 02       			OUT		(SEGPORT),a
0167   00D5 79          			LD		a,c
0168   00D6 D3 01       			OUT		(CATHPORT),a
0169   00D8 06 40       			LD		b,CATHDLY
0170   00DA 10 FE       HOLD:		DJNZ	HOLD
0171   00DC AF          			XOR		a
0172   00DD D3 01       			OUT		(CATHPORT),a
0173   00DF C9          			RET
0174   00E0             ;
0175   00E0 E5          KEYBOARD:	PUSH	hl ; Key decoder routine.
0176   00E1 F5          			PUSH	af
0177   00E2 21 30 00    			LD		hl,$0030
0178   00E5 22 C7 08    			LD		(BEEPLENGTH),hl
0179   00E8 21 C9 08    			LD		hl,BEEPFREQ
0180   00EB 36 30       			LD		(hl),$30
0181   00ED 3A C6 08    			LD		a,(KEYDATA)
0182   00F0 FE FF       			CP		$FF
0183   00F2 CA F2 01    			JP		z,KEYDONE
0184   00F5 CD 2A 02    			CALL	BEEP
0185   00F8 CB 6F       			BIT		5,a ; Test for a shifted key.
0186   00FA CA 05 01    			JP		z,TESTFUNC ; If no shift, do this jump.
0187   00FD EE 20       			XOR		$20 ; Remove the shift bit.
0188   00FF 11 02 02    			LD		de,SHIFTTBL ; Load the shifted key table.
0189   0102 C3 6F 01    			JP		JUMP
0190   0105             ;
0191   0105 CB 67       TESTFUNC:	BIT		4,a ; Test for a function key press (+, -, GO, AD)
0192   0107 C2 6A 01    			JP		nz,SETFUNC ; If it is a function key, do this jump.
0193   010A             ;
0194   010A 47          KEYS0TOF:	LD		b,a
0195   010B 3A C5 08    			LD		a,(MODE)
0196   010E FE 10       			CP		$10
0197   0110 CA 44 01    			JP		z,ADDRENTRY ; Jump on first address mode entry.
0198   0113 FE 11       			CP		$11
0199   0115 CA 4E 01    			JP		z,NXTADNTRY ; Jump on subsequent address mode entries.
0200   0118 FE 01       			CP		$01
0201   011A C2 24 01    			JP		nz,NXTDATTST ; Jump on all but second data nibble entry to a location.
0202   011D 3C          			INC		a ; Do this on the second data nibble entry to a location.
0203   011E 32 C5 08    			LD		(MODE),a
0204   0121 C3 3B 01    			JP		NXTDATNTR
0205   0124             ;
0206   0124 FE 02       NXTDATTST:	CP		$02
0207   0126 C2 32 01    			JP		nz,FSTDATNTR ; Jump if this is the first data nibble entry to a location.
0208   0129 2A C0 08    			LD		hl,(ADDRESS) ; Do this on the third data nibble entry to a location.
0209   012C 23          			INC		hl
0210   012D 22 C0 08    			LD		(ADDRESS),hl
0211   0130 3E 00       			LD		a,$00
0212   0132 3C          FSTDATNTR:	INC		a ; Do this on the first data nibble entry to a location.
0213   0133 32 C5 08    			LD		(MODE),a
0214   0136 2A C0 08    			LD		hl,(ADDRESS)
0215   0139 36 00       			LD		(hl),$00
0216   013B 2A C0 08    NXTDATNTR:	LD		hl,(ADDRESS)
0217   013E 78          			LD		a,b
0218   013F ED 6F       			RLD
0219   0141 C3 F2 01    			JP		KEYDONE
0220   0144             ;
0221   0144 3C          ADDRENTRY:	INC		a ; do this on the first address nibble entry.
0222   0145 32 C5 08    			LD		(MODE),a
0223   0148 21 00 00    			LD		hl,$0000
0224   014B 22 C0 08    			LD		(ADDRESS),hl
0225   014E 78          NXTADNTRY:	LD		a,b ; Do this on first and subsequent address nibble entries.
0226   014F 21 C0 08    			LD		hl,ADDRESS
0227   0152 ED 6F       			RLD
0228   0154 2A C0 08    			LD		hl,(ADDRESS)
0229   0157 CB 24       			SLA		h
0230   0159 CB 24       			SLA		h
0231   015B CB 24       			SLA		h
0232   015D CB 24       			SLA		h
0233   015F 47          			LD		b,a
0234   0160 AF          			XOR		a
0235   0161 B4          			OR		h
0236   0162 B0          			OR		b
0237   0163 67          			LD		h,a
0238   0164 22 C0 08    			LD		(ADDRESS),hl
0239   0167 C3 F2 01    			JP		KEYDONE
0240   016A             ;
0241   016A EE 10       SETFUNC:	XOR		$10 ; Remove the function key bit.
0242   016C 11 FA 01    			LD		de,FUNCTBL ; Load the function table.
0243   016F 21 F2 01    JUMP:		LD		hl,KEYDONE ; Push where we go when we have finished onto the stack.
0244   0172 E5          			PUSH	hl
0245   0173 26 00       			LD		h,$00 ; Adjust the pointer in the selected table based on the key pressed.
0246   0175 6F          			LD		l,a
0247   0176 29          			ADD		hl,hl
0248   0177 EB          			EX		de,hl
0249   0178 19          			ADD		hl,de
0250   0179 5E          			LD		e,(hl)
0251   017A 23          			INC		hl
0252   017B 56          			LD		d,(hl)
0253   017C D5          			PUSH	de ; Push the new calculated function jump address onto the stack.
0254   017D C9          			RET ; Jump to the calculated function.
0255   017E             ;
0256   017E 2A C0 08    KEYPL:		LD		hl,(ADDRESS) ; Incrament the current monitor address.
0257   0181 23          			INC		hl
0258   0182 22 C0 08    			LD		(ADDRESS),hl
0259   0185 AF          			XOR		a ; Clear the Address / Data modes.
0260   0186 32 C5 08    			LD		(MODE),a
0261   0189 C9          			RET
0262   018A             ;
0263   018A 2A C0 08    KEYMN:		LD		hl,(ADDRESS) ; Decrement the current monitor address.
0264   018D 2B          			DEC		hl
0265   018E 22 C0 08    			LD		(ADDRESS),hl
0266   0191 AF          			XOR		a ; Clear the Address / Data modes.
0267   0192 32 C5 08    			LD		(MODE),a
0268   0195 C9          			RET
0269   0196             ;
0270   0196 E5          KEYGO:		PUSH	hl
0271   0197 F5          			PUSH	af
0272   0198 21 A0 01    			LD		hl,RETURN ; Start executing from the current monitor address.
0273   019B E5          			push	hl
0274   019C 2A C0 08    			LD		hl,(ADDRESS)
0275   019F E9          			JP		(hl)
0276   01A0 F1          RETURN:		POP		af
0277   01A1 E1          			POP		hl
0278   01A2 C9          			RET
0279   01A3             ;
0280   01A3 3A C5 08    KEYAD:		LD		a,(MODE)
0281   01A6 EE 10       			XOR		$10 ; Invert the address mode flag.
0282   01A8 32 C5 08    			LD		(MODE),a
0283   01AB C3 DF 01    			JP		CLRNBFLGS
0284   01AE             ;
0285   01AE 21 FF FF    SHFTPL:		LD		hl,RAMTOP ; Insert a byte at the current monitor address.
0286   01B1 ED 5B C0 08 			LD		de,(ADDRESS)
0287   01B5 ED 52       			SBC		hl,de
0288   01B7 44          			LD		b,h
0289   01B8 4D          			LD		c,l
0290   01B9 21 FF FF    			LD		hl,RAMTOP
0291   01BC 54          			LD		d,h
0292   01BD 5D          			LD		e,l
0293   01BE 2B          			DEC		hl
0294   01BF ED B8       			LDDR
0295   01C1 62          			LD		h,d
0296   01C2 6B          			LD		l,e
0297   01C3 36 00       			LD		(hl),$00
0298   01C5 C3 DF 01    			JP		CLRNBFLGS
0299   01C8             ;
0300   01C8 21 FF FF    SHFTMN:		LD		hl,RAMTOP ; Delete a byte from the current monitor address.
0301   01CB ED 5B C0 08 			LD		de,(ADDRESS)
0302   01CF ED 52       			SBC		hl,de
0303   01D1 44          			LD		b,h
0304   01D2 4D          			LD		c,l
0305   01D3 2A C0 08    			LD		hl,(ADDRESS)
0306   01D6 54          			LD		d,h
0307   01D7 5D          			LD		e,l
0308   01D8 23          			INC		hl
0309   01D9 ED B0       			LDIR
0310   01DB 62          			LD		h,d
0311   01DC 6B          			LD		l,e
0312   01DD 36 00       			LD		(hl),$00
0313   01DF 21 C5 08    CLRNBFLGS:	LD		hl,MODE ; Clear the nibble mode flags preserving the rest.
0314   01E2 CB 86       			RES		0,(hl)
0315   01E4 CB 8E       			RES		1,(hl)
0316   01E6 C9          			RET
0317   01E7             ;
0318   01E7 E5          SHFTGO:		PUSH	hl
0319   01E8 F5          			PUSH	af
0320   01E9 21 A0 01    			LD		hl,RETURN ; Start executing from the current monitor address.
0321   01EC E5          			push	hl
0322   01ED 2A D8 08    			LD		hl,(SHIFTGO)
0323   01F0 E9          			JP		(hl)
0324   01F1             ;
0325   01F1 C9          SHFTAD:		RET
0326   01F2             ;
0327   01F2 21 C6 08    KEYDONE:	LD		hl,KEYDATA ; Done with the key decoder.
0328   01F5 36 FF       			LD		(hl),$FF
0329   01F7 F1          			POP		af
0330   01F8 E1          			POP		hl
0331   01F9 C9          			RET
0332   01FA             ;
0333   01FA 7E 01 8A 01 FUNCTBL:	.dw		KEYPL, KEYMN, KEYGO, KEYAD
0333   01FE 96 01 A3 01 
0334   0202             ;
0335   0202             SHIFTTBL:
0336   0202             #IFDEF INCLUDE_MOD00 ; SHIFT-0
0337   0202 FF 02       			.dw		MOD00
0338   0204~            #ELSE
0339   0204~            			.dw		NOMOD
0340   0204             #ENDIF
0341   0204             #IFDEF INCLUDE_MOD01 ; SHIFT-1
0342   0204 42 03       			.dw		MOD01
0343   0206~            #ELSE
0344   0206~            			.dw		NOMOD
0345   0206             #ENDIF
0346   0206             #IFDEF INCLUDE_MOD02 ; SHIFT-2
0347   0206 70 03       			.dw		MOD02
0348   0208~            #ELSE
0349   0208~            			.dw		NOMOD
0350   0208             #ENDIF
0351   0208             #IFDEF INCLUDE_MOD03 ; SHIFT-3
0352   0208 9E 03       			.dw		MOD03
0353   020A~            #ELSE
0354   020A~            			.dw		NOMOD
0355   020A             #ENDIF
0356   020A~            #IFDEF INCLUDE_MOD04 ; SHIFT-4
0357   020A~            			.dw		MOD04
0358   020A             #ELSE
0359   020A FE 02       			.dw		NOMOD
0360   020C             #ENDIF
0361   020C~            #IFDEF INCLUDE_MOD05 ; SHIFT-5
0362   020C~            			.dw		MOD05
0363   020C             #ELSE
0364   020C FE 02       			.dw		NOMOD
0365   020E             #ENDIF
0366   020E~            #IFDEF INCLUDE_MOD06 ; SHIFT-6
0367   020E~            			.dw		MOD06
0368   020E             #ELSE
0369   020E FE 02       			.dw		NOMOD
0370   0210             #ENDIF
0371   0210~            #IFDEF INCLUDE_MOD07 ; SHIFT-7
0372   0210~            			.dw		MOD07
0373   0210             #ELSE
0374   0210 FE 02       			.dw		NOMOD
0375   0212             #ENDIF
0376   0212~            #IFDEF INCLUDE_MOD08 ; SHIFT-8
0377   0212~            			.dw		MOD08
0378   0212             #ELSE
0379   0212 FE 02       			.dw		NOMOD
0380   0214             #ENDIF
0381   0214~            #IFDEF INCLUDE_MOD09 ; SHIFT-9
0382   0214~            			.dw		MOD09
0383   0214             #ELSE
0384   0214 FE 02       			.dw		NOMOD
0385   0216             #ENDIF
0386   0216~            #IFDEF INCLUDE_MOD0A ; SHIFT-A
0387   0216~            			.dw		MOD0A
0388   0216             #ELSE
0389   0216 FE 02       			.dw		NOMOD
0390   0218             #ENDIF
0391   0218~            #IFDEF INCLUDE_MOD0B ; SHIFT-B
0392   0218~            			.dw		MOD0B
0393   0218             #ELSE
0394   0218 FE 02       			.dw		NOMOD
0395   021A             #ENDIF
0396   021A~            #IFDEF INCLUDE_MOD0C ; SHIFT-C
0397   021A~            			.dw		MOD0C
0398   021A             #ELSE
0399   021A FE 02       			.dw		NOMOD
0400   021C             #ENDIF
0401   021C~            #IFDEF INCLUDE_MOD0D ; SHIFT-D
0402   021C~            			.dw		MOD0D
0403   021C             #ELSE
0404   021C FE 02       			.dw		NOMOD
0405   021E             #ENDIF
0406   021E~            #IFDEF INCLUDE_MOD0E ; SHIFT-E
0407   021E~            			.dw		MOD0E
0408   021E             #ELSE
0409   021E FE 02       			.dw		NOMOD
0410   0220             #ENDIF
0411   0220             #IFDEF INCLUDE_MOD0F ; SHIFT-F
0412   0220 AC 03       			.dw		MOD0F
0413   0222~            #ELSE
0414   0222~            			.dw		NOMOD
0415   0222             #ENDIF
0416   0222             ;
0417   0222 AE 01 C8 01 			.dw		SHFTPL, SHFTMN, SHFTGO, SHFTAD
0417   0226 E7 01 F1 01 
0418   022A             ;
0419   022A E5          BEEP:		PUSH	hl
0420   022B F5          			PUSH	af
0421   022C 21 C9 08    			LD		hl,BEEPFREQ
0422   022F 4E          			LD		c,(hl)
0423   0230 2A C7 08    			LD		hl,(BEEPLENGTH)
0424   0233 AF          			XOR		a
0425   0234 57          			LD		d,a
0426   0235 41          BEEPL01:	LD		b,c
0427   0236 7A          			LD		a,d
0428   0237 D3 01       			OUT		(CATHPORT),a
0429   0239 10 FE       BEEPL02:	DJNZ	BEEPL02
0430   023B EE 80       			XOR		$80
0431   023D 2B          			DEC		hl
0432   023E 57          			LD		d,a
0433   023F 7C          			LD		a,h
0434   0240 B5          			OR		l
0435   0241 C2 35 02    			JP		nz,BEEPL01
0436   0244 AF          			XOR		a
0437   0245 D3 01       			OUT		(CATHPORT),a
0438   0247 F1          			POP		af
0439   0248 E1          			POP		hl
0440   0249 C9          			RET
0441   024A             ;
0442   024A E5          STARTBEEP:	PUSH	hl
0443   024B F5          			PUSH	af
0444   024C 21 7F 00    			LD		hl,$007F
0445   024F 22 C7 08    			LD		(BEEPLENGTH),hl
0446   0252 21 C9 08    			LD		hl,BEEPFREQ
0447   0255 36 35       			LD		(hl),$35
0448   0257 CD 2A 02    			CALL	BEEP
0449   025A 36 30       			LD		(hl),$30
0450   025C CD 2A 02    			CALL	BEEP
0451   025F 36 25       			LD		(hl),$25
0452   0261 CD 2A 02    			CALL	BEEP
0453   0264 36 20       			LD		(hl),$20
0454   0266 CD 2A 02    			CALL	BEEP
0455   0269 F1          			POP		af
0456   026A E1          			POP		hl
0457   026B C9          			RET
0458   026C             ;
0459   026C CD 7C 02    RAND:		CALL	RND
0460   026F 4F          			LD		c,a
0461   0270 CD 99 02    			CALL	UPDATESEED
0462   0273 CD 7C 02    			CALL	RND
0463   0276 47          			LD		b,a
0464   0277 ED 43 CE 08 			LD		(RANDOM),bc
0465   027B C9          			RET
0466   027C             ;
0467   027C 2A CA 08    RND:		LD		hl,(RNDSEEDA)
0468   027F ED 5B CC 08 			LD		de,(RNDSEEDB)
0469   0283 22 CC 08    			LD		(RNDSEEDB),hl
0470   0286 7D          			LD		a,l
0471   0287 87          			ADD		a,a
0472   0288 87          			ADD		a,a
0473   0289 87          			ADD		a,a
0474   028A AD          			XOR		l
0475   028B 6F          			LD		l,a
0476   028C 7A          			LD		a,d
0477   028D 87          			ADD		a,a
0478   028E AA          			XOR		d
0479   028F 67          			LD		h,a
0480   0290 1F          			RRA
0481   0291 AC          			XOR		h
0482   0292 AD          			XOR		l
0483   0293 63          			LD		h,e
0484   0294 6F          			LD		l,a
0485   0295 22 CA 08    			LD		(RNDSEEDA),hl
0486   0298 C9          			RET
0487   0299             ;
0488   0299 ED 4B CA 08 UPDATESEED:	LD		bc,(RNDSEEDA)
0489   029D ED 5B CC 08 			LD		de,(RNDSEEDB)
0490   02A1 03          			INC		bc
0491   02A2 1B          			DEC		de
0492   02A3 79          			LD		a,c
0493   02A4 AA          			XOR		d
0494   02A5 4F          			LD		c,a
0495   02A6 78          			LD		a,b
0496   02A7 AB          			XOR		e
0497   02A8 47          			LD		b,a
0498   02A9 7B          			LD		a,e
0499   02AA A9          			XOR		c
0500   02AB 5F          			LD		e,a
0501   02AC 7A          			LD		a,d
0502   02AD A8          			XOR		b
0503   02AE 57          			LD		d,a
0504   02AF ED 43 CA 08 			LD		(RNDSEEDA),bc
0505   02B3 ED 53 CC 08 			LD		(RNDSEEDB),de
0506   02B7 C9          			RET
0507   02B8             ;
0508   02B8 31 C0 08    SETUP:		LD		sp,STACKTOP ; Post reset/power up setup.
0509   02BB 21 00 09    			LD		hl,RAMBASE
0510   02BE 22 C0 08    			LD		(ADDRESS),hl
0511   02C1 AF          			XOR		a
0512   02C2 32 C5 08    			LD		(MODE),a
0513   02C5 3E FF       			LD		a,$FF
0514   02C7 32 C6 08    			LD		(KEYDATA),a
0515   02CA 21 21 DF    			LD		hl,$DF21
0516   02CD 22 CA 08    			LD		(RNDSEEDA),hl
0517   02D0 21 7B 63    			LD		hl,$637B
0518   02D3 22 CC 08    			LD		(RNDSEEDB),hl
0519   02D6 21 6C 02    			LD		hl,RAND
0520   02D9 22 D8 08    			LD		(SHIFTGO),hl
0521   02DC CD 4A 02    			CALL	STARTBEEP;
0522   02DF CD 99 02    MAIN:		CALL	UPDATESEED
0523   02E2 CD 80 00    			CALL	DISPLAY
0524   02E5 CD 99 02    			CALL	UPDATESEED
0525   02E8 CD E0 00    			CALL	KEYBOARD
0526   02EB C3 DF 02    			JP		MAIN
0527   02EE             ;
0528   02EE EB 28 CD AD HEX2SEG:	.DB		$EB,$28,$CD,$AD,$2E,$A7,$E7,$29 ; HEX Byte to LED Segment conversion.
0528   02F2 2E A7 E7 29 
0529   02F6 EF 2F 6F E6 			.DB		$EF,$2F,$6F,$E6,$C3,$EC,$C7,$47
0529   02FA C3 EC C7 47 
0530   02FE             ;
0531   02FE C9          NOMOD:		RET ; What to do when a mod isn't installed.
0532   02FF             ;
0533   02FF             ; BEGIN MODULES.
0534   02FF             #IFDEF INCLUDE_MOD00
0535   02FF             #INCLUDE "Modules/MOD00.asm"
0001+  02FF             #IFNDEF MOD00_CODE
0002+  02FF             #DEFINE MOD00_CODE
0003+  02FF             ; START MOD00 - Memory Test - V1.10 by Scott Gregory
0004+  02FF CD 32 03    MOD00:		CALL	M00SREG
0005+  0302 D9          			EXX
0006+  0303 CD 32 03    			CALL	M00SREG
0007+  0306 70          M00SETMEM:	LD		(hl),b
0008+  0307 7A          			LD		a,d
0009+  0308 B3          			OR		e
0010+  0309 CA 11 03    			JP		z,M00DELAY
0011+  030C 23          			INC		hl
0012+  030D 1B          			DEC		de
0013+  030E C3 06 03    			JP		M00SETMEM
0014+  0311 1B          M00DELAY:	DEC		de
0015+  0312 7A          			ld		a,d
0016+  0313 B3          			OR		e
0017+  0314 C2 11 03    			JP		nz,M00DELAY
0018+  0317 D9          			EXX
0019+  0318 DD 21 00 00 			LD		ix,$0000
0020+  031C 7E          M00TSTMEM:	LD		a,(hl)
0021+  031D B8          			CP		b
0022+  031E CA 23 03    			JP		z,M00TSTCNT
0023+  0321 DD 23       			INC		ix
0024+  0323 7A          M00TSTCNT:	LD		a,d
0025+  0324 B3          			OR		e
0026+  0325 CA 2D 03    			JP		z,M00END
0027+  0328 23          			INC		hl
0028+  0329 1B          			DEC		de
0029+  032A C3 1C 03    			JP		M00TSTMEM
0030+  032D             ;
0031+  032D DD 22 D6 08 M00END:		LD		(GENERALD),ix
0032+  0331 C9          			RET
0033+  0332             ;
0034+  0332 B7          M00SREG:	OR		a ; Clear the Carry Flag.
0035+  0333 ED 5B D0 08 			LD		de,(GENERALA)
0036+  0337 2A D2 08    			LD		hl,(GENERALB)
0037+  033A 3A D4 08    			LD		a,(GENERALC)
0038+  033D 47          			LD		b,a
0039+  033E ED 52       			SBC		hl,de
0040+  0340 EB          			EX		de,hl
0041+  0341 C9          			RET
0042+  0342             ; END MOD00
0043+  0342             #ENDIF
0536   0342             #ENDIF
0537   0342             #IFDEF INCLUDE_MOD01
0538   0342             #INCLUDE "Modules/MOD01.asm"
0001+  0342             #IFNDEF MOD01_GLOBALS
0002+  0342             #DEFINE MOD01_GLOBALS
0003+  0342             ; Begin global MOD assignments.
0004+  0342             SERSTATUS	.EQU	$06
0005+  0342             SERBUFFER	.EQU	$07
0006+  0342             RXAVAILFLAG	.EQU	$01 ; Binary value of the bit associated with RX Data Available flag.
0007+  0342             TXREADYFLAG	.EQU	$04 ; Binary value of the bit associated with TX Ready flag.
0008+  0342             ; End global MOD assignments.
0009+  0342             ;
0010+  0342             #ENDIF
0011+  0342             #IFNDEF MOD01_CODE
0012+  0342             #DEFINE MOD01_CODE
0013+  0342             ; START MOD01 - Serial Send - V1.10 by Scott Gregory
0014+  0342 DB 07       MOD01:		IN		a,(SERBUFFER)
0015+  0344 ED 5B D0 08 			LD		de,(GENERALA)
0016+  0348 2A D2 08    			LD		hl,(GENERALB)
0017+  034B 3A D4 08    			LD		a,(GENERALC)
0018+  034E FE 00       			CP		$00
0019+  0350 CA 57 03    			JP		z,M01SEADDR
0020+  0353 2B          			DEC		hl
0021+  0354 C3 5A 03    			JP		M01SET
0022+  0357             ;
0023+  0357 AF          M01SEADDR:	XOR		a ; Clear the Carry Flag.
0024+  0358 ED 52       			SBC		hl,de
0025+  035A EB          M01SET:		EX		de,hl
0026+  035B 3E 07       			LD		a,SERBUFFER
0027+  035D 4F          			LD		c,a
0028+  035E 43          			LD		b,e
0029+  035F DB 06       M01MAIN:	IN		a,(SERSTATUS)
0030+  0361 E6 04       			AND		TXREADYFLAG
0031+  0363 CA 5F 03    			JP		z,M01MAIN
0032+  0366 ED A3       			OUTI
0033+  0368 7A          			LD		a,d
0034+  0369 B3          			OR		e
0035+  036A C8          			RET		z
0036+  036B 1B          			DEC		de
0037+  036C 43          			LD		b,e
0038+  036D C3 5F 03    			JP		M01MAIN
0039+  0370             ; END MOD01
0040+  0370             #ENDIF
0539   0370             #ENDIF
0540   0370             #IFDEF INCLUDE_MOD02
0541   0370             #INCLUDE "Modules/MOD02.asm"
0001+  0370~            #IFNDEF MOD01_GLOBALS
0002+  0370~            #DEFINE MOD01_GLOBALS
0003+  0370~            ; Begin global MOD assignments.
0004+  0370~            SERSTATUS	.EQU	$06
0005+  0370~            SERBUFFER	.EQU	$07
0006+  0370~            RXAVAILFLAG	.EQU	$01 ; Binary value of the bit associated with RX Data Available flag.
0007+  0370~            TXREADYFLAG	.EQU	$04 ; Binary value of the bit associated with TX Ready flag.
0008+  0370~            ; End global MOD assignments.
0009+  0370~            ;
0010+  0370             #ENDIF
0011+  0370             #IFNDEF MOD02_CODE
0012+  0370             #DEFINE MOD02_CODE
0013+  0370             ; START MOD02 - Serial Receive - V1.10 by Scott Gregory
0014+  0370 DB 07       MOD02:		IN		a,(SERBUFFER)
0015+  0372 ED 5B D0 08 			LD		de,(GENERALA)
0016+  0376 2A D2 08    			LD		hl,(GENERALB)
0017+  0379 3A D4 08    			LD		a,(GENERALC)
0018+  037C FE 00       			CP		$00
0019+  037E CA 85 03    			JP		z,M02SEADDR
0020+  0381 2B          			DEC		hl
0021+  0382 C3 88 03    			JP		M02SET
0022+  0385             ;
0023+  0385 AF          M02SEADDR:	XOR		a ; Clear the Carry Flag.
0024+  0386 ED 52       			SBC		hl,de
0025+  0388 EB          M02SET:		EX		de,hl
0026+  0389 3E 07       			LD		a,SERBUFFER
0027+  038B 4F          			LD		c,a
0028+  038C 43          			LD		b,e
0029+  038D DB 06       M02MAIN:	IN		a,(SERSTATUS)
0030+  038F E6 01       			AND		RXAVAILFLAG
0031+  0391 CA 8D 03    			JP		z,M02MAIN
0032+  0394 ED A2       			INI
0033+  0396 7A          			LD		a,d
0034+  0397 B3          			OR		e
0035+  0398 C8          			RET		z
0036+  0399 1B          			DEC		de
0037+  039A 43          			LD		b,e
0038+  039B C3 8D 03    			JP		M02MAIN
0039+  039E             ; END MOD02
0040+  039E             #ENDIF
0542   039E             #ENDIF
0543   039E             #IFDEF INCLUDE_MOD03
0544   039E             #INCLUDE "Modules/MOD03.asm"
0001+  039E             #IFNDEF MOD03_CODE
0002+  039E             #DEFINE MOD03_CODE
0003+  039E             ; START MOD03 - RAM Copy - V1.10 by Scott Gregory
0004+  039E 2A D0 08    MOD03:		LD		hl,(GENERALA)
0005+  03A1 ED 5B D2 08 			LD		de,(GENERALB)
0006+  03A5 ED 4B D4 08 			LD		bc,(GENERALC)
0007+  03A9 ED B0       			LDIR
0008+  03AB C9          			RET
0009+  03AC             ; END MOD03
0010+  03AC             #ENDIF
0545   03AC             #ENDIF
0546   03AC~            #IFDEF INCLUDE_MOD04
0547   03AC~            #INCLUDE "Modules/MOD04.asm"
0548   03AC             #ENDIF
0549   03AC~            #IFDEF INCLUDE_MOD05
0550   03AC~            #INCLUDE "Modules/MOD05.asm"
0551   03AC             #ENDIF
0552   03AC~            #IFDEF INCLUDE_MOD06
0553   03AC~            #INCLUDE "Modules/MOD06.asm"
0554   03AC             #ENDIF
0555   03AC~            #IFDEF INCLUDE_MOD07
0556   03AC~            #INCLUDE "Modules/MOD07.asm"
0557   03AC             #ENDIF
0558   03AC~            #IFDEF INCLUDE_MOD08
0559   03AC~            #INCLUDE "Modules/MOD08.asm"
0560   03AC             #ENDIF
0561   03AC~            #IFDEF INCLUDE_MOD09
0562   03AC~            #INCLUDE "Modules/MOD09.asm"
0563   03AC             #ENDIF
0564   03AC~            #IFDEF INCLUDE_MOD0A
0565   03AC~            #INCLUDE "Modules/MOD0A.asm"
0566   03AC             #ENDIF
0567   03AC~            #IFDEF INCLUDE_MOD0B
0568   03AC~            #INCLUDE "Modules/MOD0B.asm"
0569   03AC             #ENDIF
0570   03AC~            #IFDEF INCLUDE_MOD0C
0571   03AC~            #INCLUDE "Modules/MOD0C.asm"
0572   03AC             #ENDIF
0573   03AC~            #IFDEF INCLUDE_MOD0D
0574   03AC~            #INCLUDE "Modules/MOD0D.asm"
0575   03AC             #ENDIF
0576   03AC~            #IFDEF INCLUDE_MOD0E
0577   03AC~            #INCLUDE "Modules/MOD0E.asm"
0578   03AC             #ENDIF
0579   03AC             #IFDEF INCLUDE_MOD0F
0580   03AC             #INCLUDE "Modules/MOD0F.asm"
0001+  03AC~            #IFNDEF MOD01_GLOBALS
0002+  03AC~            #DEFINE MOD01_GLOBALS
0003+  03AC~            ; Begin global MOD assignments.
0004+  03AC~            SERSTATUS	.EQU	$06
0005+  03AC~            SERBUFFER	.EQU	$07
0006+  03AC~            RXAVAILFLAG	.EQU	$01 ; Binary value of the bit associated with RX Data Available flag.
0007+  03AC~            TXREADYFLAG	.EQU	$04 ; Binary value of the bit associated with TX Ready flag.
0008+  03AC~            ; End global MOD assignments.
0009+  03AC~            ;
0010+  03AC             #ENDIF
0011+  03AC             #IFNDEF MOD0F_CODE
0012+  03AC             #DEFINE MOD0F_CODE
0013+  03AC             ; START MOD0F - Serial Echo - V1.10 by Scott Gregory
0014+  03AC 3E FF       MOD0F:		LD		a,$FF
0015+  03AE 32 C6 08    			LD		(KEYDATA),a ; Clear the key buffer.
0016+  03B1 DB 06       MOD0FMAIN:	IN		a,(SERSTATUS)
0017+  03B3 E6 01       			AND		RXAVAILFLAG
0018+  03B5 C4 C1 03    			CALL	nz,M0FRCV ; Have we received data?
0019+  03B8 3A C6 08    			LD		a,(KEYDATA)
0020+  03BB FE FF       			CP		$FF ; Has a key been pressed?
0021+  03BD CA B1 03    			JP		z,MOD0FMAIN
0022+  03C0 C9          			RET
0023+  03C1             
0024+  03C1 DB 07       M0FRCV:		IN		a,(SERBUFFER)
0025+  03C3 47          			LD		b,a
0026+  03C4 CD C8 03    			CALL	M0FXMIT
0027+  03C7 C9          			RET
0028+  03C8             
0029+  03C8 DB 06       M0FXMIT:	IN		a,(SERSTATUS)
0030+  03CA E6 04       			AND		TXREADYFLAG
0031+  03CC CA C8 03    			JP		z,M0FXMIT
0032+  03CF 78          			LD		a,b
0033+  03D0 D3 07       			OUT		(SERBUFFER),a
0034+  03D2 AF          			XOR		a
0035+  03D3 C9          			RET
0036+  03D4             ; END MOD0F
0037+  03D4             #ENDIF
0581   03D4             #ENDIF
0582   03D4             ; END MODULES.
0583   03D4             ;
0584   03D4             			.END
tasm: Number of errors = 0
