0001   0000             ; ######################################
0002   0000             ; #                                    #
0003   0000             ; #         uMON1 Version 1.00         #
0004   0000             ; #  --------------------------------  #
0005   0000             ; #   Special Key Sequences            #
0006   0000             ; #  --------------------------------  #
0007   0000             ; #   Shift-+ - Insert byte.           #
0008   0000             ; #   Shift-- - Delete byte.           #
0009   0000             ; #                                    #
0010   0000             ; #  --------------------------------  #
0011   0000             ; #   Included Modules                 #
0012   0000             ; #  --------------------------------  #
0013   0000             ; #   MOD01-RAMTest         (Shift-0)  #
0014   0000             ; #   MOD02-Serial Send     (Shift-1)  #
0015   0000             ; #   MOD03-Serial Receive  (Shift-2)  #
0016   0000             ; #   MOD10-Serial Loopback (Shift-F)  #
0017   0000             ; #  --------------------------------  #
0018   0000             ; #                                    #
0019   0000             ; #  by Scott Gregory                  #
0020   0000             ; #  13/06/2021                        #
0021   0000             ; #                                    #
0022   0000             ; ######################################
0023   0000             ;
0024   0000             STACKTOP	.EQU	$08C0 ; Stack position.
0025   0000             ROMBASE		.EQU	$0000 ; Start of ROM.
0026   0000             ROMTOP		.EQU	$07FF ; End of ROM.
0027   0000             RAMBASE		.EQU	$0900 ; Start of user RAM.
0028   0000             RAMTOP		.EQU	$FFFF ; End of user RAM.
0029   0000             CATHDLY		.EQU	$20 ; Digit display delay.
0030   0000             KEYPORT		.EQU	$00 ; Keypad port.
0031   0000             CATHPORT	.EQU	$01 ; Display catchode port.
0032   0000             SEGPORT		.EQU	$02 ; Display segment port.
0033   0000             ;
0034   0000             ADDRESS		.EQU	$08C1 ; 2 Bytes.
0035   0000             SCRATCH		.EQU	$08C3 ; 2 Bytes.
0036   0000             MODE		.EQU	$08C5 ; 1 Byte.
0037   0000             KEYDATA		.EQU	$08C6 ; 1 Byte.
0038   0000             BEEPLENGTH	.EQU	$08C7 ; 2 Bytes.
0039   0000             BEEPFREQ	.EQU	$08C9 ; 1 Byte.
0040   0000             ;
0041   0000             ; Begin global MOD assignments.
0042   0000             SERBUFFER	.EQU	$06
0043   0000             SERSTATUS	.EQU	$07
0044   0000             SERSTART	.EQU	$08F6
0045   0000             SEREND		.EQU	$08F8
0046   0000             ; End global MOD assignments.
0047   0000             ;
0048   0000             ; Begin MOD-01 assignments.
0049   0000             M01START	.EQU	$08F0
0050   0000             M01FINISH	.EQU	$08F2
0051   0000             M01PATTERN	.EQU	$08F4
0052   0000             ; End MOD-01 assignments.
0053   0000             ;
0054   0000             ; Begin MOD-02 assignments.
0055   0000             ; End MOD-02 assignments.
0056   0000             ;
0057   0000             ; Begin MOD-10 assignments.
0058   0000             ; End MOD-10 assignments.
0059   0000             ;
0060   0000 00 00 00 00 			.FILL	(ROMTOP - ROMBASE) + 1, $00
0060   0004 00 00 00 00 
0060   0008 00 00 00 00 
0060   000C 00 00 00 00 
0060   0010 00 00 00 00 
0060   0014 00 00 00 00 
0060   0018 00 00 00 00 
0060   001C 00 00 00 00 
0060   0020 00 00 00 00 
0060   0024 00 00 00 00 
0060   0028 00 00 00 00 
0060   002C 00 00 00 00 
0060   0030 00 00 00 00 
0060   0034 00 00 00 00 
0060   0038 00 00 00 00 
0060   003C 00 00 00 00 
0060   0040 00 00 00 00 
0060   0044 00 00 00 00 
0060   0048 00 00 00 00 
0060   004C 00 00 00 00 
0060   0050 00 00 00 00 
0060   0054 00 00 00 00 
0060   0058 00 00 00 00 
0060   005C 00 00 00 00 
0060   0060 00 00 00 00 
0060   0064 00 00 00 00 
0060   0068 00 00 00 00 
0060   006C 00 00 00 00 
0060   0070 00 00 00 00 
0060   0074 00 00 00 00 
0060   0078 00 00 00 00 
0060   007C 00 00 00 00 
0060   0080 00 00 00 00 
0060   0084 00 00 00 00 
0060   0088 00 00 00 00 
0060   008C 00 00 00 00 
0060   0090 00 00 00 00 
0060   0094 00 00 00 00 
0060   0098 00 00 00 00 
0060   009C 00 00 00 00 
0060   00A0 00 00 00 00 
0060   00A4 00 00 00 00 
0060   00A8 00 00 00 00 
0060   00AC 00 00 00 00 
0060   00B0 00 00 00 00 
0060   00B4 00 00 00 00 
0060   00B8 00 00 00 00 
0060   00BC 00 00 00 00 
0060   00C0 00 00 00 00 
0060   00C4 00 00 00 00 
0060   00C8 00 00 00 00 
0060   00CC 00 00 00 00 
0060   00D0 00 00 00 00 
0060   00D4 00 00 00 00 
0060   00D8 00 00 00 00 
0060   00DC 00 00 00 00 
0060   00E0 00 00 00 00 
0060   00E4 00 00 00 00 
0060   00E8 00 00 00 00 
0060   00EC 00 00 00 00 
0060   00F0 00 00 00 00 
0060   00F4 00 00 00 00 
0060   00F8 00 00 00 00 
0060   00FC 00 00 00 00 
0060   0100 00 00 00 00 
0060   0104 00 00 00 00 
0060   0108 00 00 00 00 
0060   010C 00 00 00 00 
0060   0110 00 00 00 00 
0060   0114 00 00 00 00 
0060   0118 00 00 00 00 
0060   011C 00 00 00 00 
0060   0120 00 00 00 00 
0060   0124 00 00 00 00 
0060   0128 00 00 00 00 
0060   012C 00 00 00 00 
0060   0130 00 00 00 00 
0060   0134 00 00 00 00 
0060   0138 00 00 00 00 
0060   013C 00 00 00 00 
0060   0140 00 00 00 00 
0060   0144 00 00 00 00 
0060   0148 00 00 00 00 
0060   014C 00 00 00 00 
0060   0150 00 00 00 00 
0060   0154 00 00 00 00 
0060   0158 00 00 00 00 
0060   015C 00 00 00 00 
0060   0160 00 00 00 00 
0060   0164 00 00 00 00 
0060   0168 00 00 00 00 
0060   016C 00 00 00 00 
0060   0170 00 00 00 00 
0060   0174 00 00 00 00 
0060   0178 00 00 00 00 
0060   017C 00 00 00 00 
0060   0180 00 00 00 00 
0060   0184 00 00 00 00 
0060   0188 00 00 00 00 
0060   018C 00 00 00 00 
0060   0190 00 00 00 00 
0060   0194 00 00 00 00 
0060   0198 00 00 00 00 
0060   019C 00 00 00 00 
0060   01A0 00 00 00 00 
0060   01A4 00 00 00 00 
0060   01A8 00 00 00 00 
0060   01AC 00 00 00 00 
0060   01B0 00 00 00 00 
0060   01B4 00 00 00 00 
0060   01B8 00 00 00 00 
0060   01BC 00 00 00 00 
0060   01C0 00 00 00 00 
0060   01C4 00 00 00 00 
0060   01C8 00 00 00 00 
0060   01CC 00 00 00 00 
0060   01D0 00 00 00 00 
0060   01D4 00 00 00 00 
0060   01D8 00 00 00 00 
0060   01DC 00 00 00 00 
0060   01E0 00 00 00 00 
0060   01E4 00 00 00 00 
0060   01E8 00 00 00 00 
0060   01EC 00 00 00 00 
0060   01F0 00 00 00 00 
0060   01F4 00 00 00 00 
0060   01F8 00 00 00 00 
0060   01FC 00 00 00 00 
0060   0200 00 00 00 00 
0060   0204 00 00 00 00 
0060   0208 00 00 00 00 
0060   020C 00 00 00 00 
0060   0210 00 00 00 00 
0060   0214 00 00 00 00 
0060   0218 00 00 00 00 
0060   021C 00 00 00 00 
0060   0220 00 00 00 00 
0060   0224 00 00 00 00 
0060   0228 00 00 00 00 
0060   022C 00 00 00 00 
0060   0230 00 00 00 00 
0060   0234 00 00 00 00 
0060   0238 00 00 00 00 
0060   023C 00 00 00 00 
0060   0240 00 00 00 00 
0060   0244 00 00 00 00 
0060   0248 00 00 00 00 
0060   024C 00 00 00 00 
0060   0250 00 00 00 00 
0060   0254 00 00 00 00 
0060   0258 00 00 00 00 
0060   025C 00 00 00 00 
0060   0260 00 00 00 00 
0060   0264 00 00 00 00 
0060   0268 00 00 00 00 
0060   026C 00 00 00 00 
0060   0270 00 00 00 00 
0060   0274 00 00 00 00 
0060   0278 00 00 00 00 
0060   027C 00 00 00 00 
0060   0280 00 00 00 00 
0060   0284 00 00 00 00 
0060   0288 00 00 00 00 
0060   028C 00 00 00 00 
0060   0290 00 00 00 00 
0060   0294 00 00 00 00 
0060   0298 00 00 00 00 
0060   029C 00 00 00 00 
0060   02A0 00 00 00 00 
0060   02A4 00 00 00 00 
0060   02A8 00 00 00 00 
0060   02AC 00 00 00 00 
0060   02B0 00 00 00 00 
0060   02B4 00 00 00 00 
0060   02B8 00 00 00 00 
0060   02BC 00 00 00 00 
0060   02C0 00 00 00 00 
0060   02C4 00 00 00 00 
0060   02C8 00 00 00 00 
0060   02CC 00 00 00 00 
0060   02D0 00 00 00 00 
0060   02D4 00 00 00 00 
0060   02D8 00 00 00 00 
0060   02DC 00 00 00 00 
0060   02E0 00 00 00 00 
0060   02E4 00 00 00 00 
0060   02E8 00 00 00 00 
0060   02EC 00 00 00 00 
0060   02F0 00 00 00 00 
0060   02F4 00 00 00 00 
0060   02F8 00 00 00 00 
0060   02FC 00 00 00 00 
0060   0300 00 00 00 00 
0060   0304 00 00 00 00 
0060   0308 00 00 00 00 
0060   030C 00 00 00 00 
0060   0310 00 00 00 00 
0060   0314 00 00 00 00 
0060   0318 00 00 00 00 
0060   031C 00 00 00 00 
0060   0320 00 00 00 00 
0060   0324 00 00 00 00 
0060   0328 00 00 00 00 
0060   032C 00 00 00 00 
0060   0330 00 00 00 00 
0060   0334 00 00 00 00 
0060   0338 00 00 00 00 
0060   033C 00 00 00 00 
0060   0340 00 00 00 00 
0060   0344 00 00 00 00 
0060   0348 00 00 00 00 
0060   034C 00 00 00 00 
0060   0350 00 00 00 00 
0060   0354 00 00 00 00 
0060   0358 00 00 00 00 
0060   035C 00 00 00 00 
0060   0360 00 00 00 00 
0060   0364 00 00 00 00 
0060   0368 00 00 00 00 
0060   036C 00 00 00 00 
0060   0370 00 00 00 00 
0060   0374 00 00 00 00 
0060   0378 00 00 00 00 
0060   037C 00 00 00 00 
0060   0380 00 00 00 00 
0060   0384 00 00 00 00 
0060   0388 00 00 00 00 
0060   038C 00 00 00 00 
0060   0390 00 00 00 00 
0060   0394 00 00 00 00 
0060   0398 00 00 00 00 
0060   039C 00 00 00 00 
0060   03A0 00 00 00 00 
0060   03A4 00 00 00 00 
0060   03A8 00 00 00 00 
0060   03AC 00 00 00 00 
0060   03B0 00 00 00 00 
0060   03B4 00 00 00 00 
0060   03B8 00 00 00 00 
0060   03BC 00 00 00 00 
0060   03C0 00 00 00 00 
0060   03C4 00 00 00 00 
0060   03C8 00 00 00 00 
0060   03CC 00 00 00 00 
0060   03D0 00 00 00 00 
0060   03D4 00 00 00 00 
0060   03D8 00 00 00 00 
0060   03DC 00 00 00 00 
0060   03E0 00 00 00 00 
0060   03E4 00 00 00 00 
0060   03E8 00 00 00 00 
0060   03EC 00 00 00 00 
0060   03F0 00 00 00 00 
0060   03F4 00 00 00 00 
0060   03F8 00 00 00 00 
0060   03FC 00 00 00 00 
0060   0400 00 00 00 00 
0060   0404 00 00 00 00 
0060   0408 00 00 00 00 
0060   040C 00 00 00 00 
0060   0410 00 00 00 00 
0060   0414 00 00 00 00 
0060   0418 00 00 00 00 
0060   041C 00 00 00 00 
0060   0420 00 00 00 00 
0060   0424 00 00 00 00 
0060   0428 00 00 00 00 
0060   042C 00 00 00 00 
0060   0430 00 00 00 00 
0060   0434 00 00 00 00 
0060   0438 00 00 00 00 
0060   043C 00 00 00 00 
0060   0440 00 00 00 00 
0060   0444 00 00 00 00 
0060   0448 00 00 00 00 
0060   044C 00 00 00 00 
0060   0450 00 00 00 00 
0060   0454 00 00 00 00 
0060   0458 00 00 00 00 
0060   045C 00 00 00 00 
0060   0460 00 00 00 00 
0060   0464 00 00 00 00 
0060   0468 00 00 00 00 
0060   046C 00 00 00 00 
0060   0470 00 00 00 00 
0060   0474 00 00 00 00 
0060   0478 00 00 00 00 
0060   047C 00 00 00 00 
0060   0480 00 00 00 00 
0060   0484 00 00 00 00 
0060   0488 00 00 00 00 
0060   048C 00 00 00 00 
0060   0490 00 00 00 00 
0060   0494 00 00 00 00 
0060   0498 00 00 00 00 
0060   049C 00 00 00 00 
0060   04A0 00 00 00 00 
0060   04A4 00 00 00 00 
0060   04A8 00 00 00 00 
0060   04AC 00 00 00 00 
0060   04B0 00 00 00 00 
0060   04B4 00 00 00 00 
0060   04B8 00 00 00 00 
0060   04BC 00 00 00 00 
0060   04C0 00 00 00 00 
0060   04C4 00 00 00 00 
0060   04C8 00 00 00 00 
0060   04CC 00 00 00 00 
0060   04D0 00 00 00 00 
0060   04D4 00 00 00 00 
0060   04D8 00 00 00 00 
0060   04DC 00 00 00 00 
0060   04E0 00 00 00 00 
0060   04E4 00 00 00 00 
0060   04E8 00 00 00 00 
0060   04EC 00 00 00 00 
0060   04F0 00 00 00 00 
0060   04F4 00 00 00 00 
0060   04F8 00 00 00 00 
0060   04FC 00 00 00 00 
0060   0500 00 00 00 00 
0060   0504 00 00 00 00 
0060   0508 00 00 00 00 
0060   050C 00 00 00 00 
0060   0510 00 00 00 00 
0060   0514 00 00 00 00 
0060   0518 00 00 00 00 
0060   051C 00 00 00 00 
0060   0520 00 00 00 00 
0060   0524 00 00 00 00 
0060   0528 00 00 00 00 
0060   052C 00 00 00 00 
0060   0530 00 00 00 00 
0060   0534 00 00 00 00 
0060   0538 00 00 00 00 
0060   053C 00 00 00 00 
0060   0540 00 00 00 00 
0060   0544 00 00 00 00 
0060   0548 00 00 00 00 
0060   054C 00 00 00 00 
0060   0550 00 00 00 00 
0060   0554 00 00 00 00 
0060   0558 00 00 00 00 
0060   055C 00 00 00 00 
0060   0560 00 00 00 00 
0060   0564 00 00 00 00 
0060   0568 00 00 00 00 
0060   056C 00 00 00 00 
0060   0570 00 00 00 00 
0060   0574 00 00 00 00 
0060   0578 00 00 00 00 
0060   057C 00 00 00 00 
0060   0580 00 00 00 00 
0060   0584 00 00 00 00 
0060   0588 00 00 00 00 
0060   058C 00 00 00 00 
0060   0590 00 00 00 00 
0060   0594 00 00 00 00 
0060   0598 00 00 00 00 
0060   059C 00 00 00 00 
0060   05A0 00 00 00 00 
0060   05A4 00 00 00 00 
0060   05A8 00 00 00 00 
0060   05AC 00 00 00 00 
0060   05B0 00 00 00 00 
0060   05B4 00 00 00 00 
0060   05B8 00 00 00 00 
0060   05BC 00 00 00 00 
0060   05C0 00 00 00 00 
0060   05C4 00 00 00 00 
0060   05C8 00 00 00 00 
0060   05CC 00 00 00 00 
0060   05D0 00 00 00 00 
0060   05D4 00 00 00 00 
0060   05D8 00 00 00 00 
0060   05DC 00 00 00 00 
0060   05E0 00 00 00 00 
0060   05E4 00 00 00 00 
0060   05E8 00 00 00 00 
0060   05EC 00 00 00 00 
0060   05F0 00 00 00 00 
0060   05F4 00 00 00 00 
0060   05F8 00 00 00 00 
0060   05FC 00 00 00 00 
0060   0600 00 00 00 00 
0060   0604 00 00 00 00 
0060   0608 00 00 00 00 
0060   060C 00 00 00 00 
0060   0610 00 00 00 00 
0060   0614 00 00 00 00 
0060   0618 00 00 00 00 
0060   061C 00 00 00 00 
0060   0620 00 00 00 00 
0060   0624 00 00 00 00 
0060   0628 00 00 00 00 
0060   062C 00 00 00 00 
0060   0630 00 00 00 00 
0060   0634 00 00 00 00 
0060   0638 00 00 00 00 
0060   063C 00 00 00 00 
0060   0640 00 00 00 00 
0060   0644 00 00 00 00 
0060   0648 00 00 00 00 
0060   064C 00 00 00 00 
0060   0650 00 00 00 00 
0060   0654 00 00 00 00 
0060   0658 00 00 00 00 
0060   065C 00 00 00 00 
0060   0660 00 00 00 00 
0060   0664 00 00 00 00 
0060   0668 00 00 00 00 
0060   066C 00 00 00 00 
0060   0670 00 00 00 00 
0060   0674 00 00 00 00 
0060   0678 00 00 00 00 
0060   067C 00 00 00 00 
0060   0680 00 00 00 00 
0060   0684 00 00 00 00 
0060   0688 00 00 00 00 
0060   068C 00 00 00 00 
0060   0690 00 00 00 00 
0060   0694 00 00 00 00 
0060   0698 00 00 00 00 
0060   069C 00 00 00 00 
0060   06A0 00 00 00 00 
0060   06A4 00 00 00 00 
0060   06A8 00 00 00 00 
0060   06AC 00 00 00 00 
0060   06B0 00 00 00 00 
0060   06B4 00 00 00 00 
0060   06B8 00 00 00 00 
0060   06BC 00 00 00 00 
0060   06C0 00 00 00 00 
0060   06C4 00 00 00 00 
0060   06C8 00 00 00 00 
0060   06CC 00 00 00 00 
0060   06D0 00 00 00 00 
0060   06D4 00 00 00 00 
0060   06D8 00 00 00 00 
0060   06DC 00 00 00 00 
0060   06E0 00 00 00 00 
0060   06E4 00 00 00 00 
0060   06E8 00 00 00 00 
0060   06EC 00 00 00 00 
0060   06F0 00 00 00 00 
0060   06F4 00 00 00 00 
0060   06F8 00 00 00 00 
0060   06FC 00 00 00 00 
0060   0700 00 00 00 00 
0060   0704 00 00 00 00 
0060   0708 00 00 00 00 
0060   070C 00 00 00 00 
0060   0710 00 00 00 00 
0060   0714 00 00 00 00 
0060   0718 00 00 00 00 
0060   071C 00 00 00 00 
0060   0720 00 00 00 00 
0060   0724 00 00 00 00 
0060   0728 00 00 00 00 
0060   072C 00 00 00 00 
0060   0730 00 00 00 00 
0060   0734 00 00 00 00 
0060   0738 00 00 00 00 
0060   073C 00 00 00 00 
0060   0740 00 00 00 00 
0060   0744 00 00 00 00 
0060   0748 00 00 00 00 
0060   074C 00 00 00 00 
0060   0750 00 00 00 00 
0060   0754 00 00 00 00 
0060   0758 00 00 00 00 
0060   075C 00 00 00 00 
0060   0760 00 00 00 00 
0060   0764 00 00 00 00 
0060   0768 00 00 00 00 
0060   076C 00 00 00 00 
0060   0770 00 00 00 00 
0060   0774 00 00 00 00 
0060   0778 00 00 00 00 
0060   077C 00 00 00 00 
0060   0780 00 00 00 00 
0060   0784 00 00 00 00 
0060   0788 00 00 00 00 
0060   078C 00 00 00 00 
0060   0790 00 00 00 00 
0060   0794 00 00 00 00 
0060   0798 00 00 00 00 
0060   079C 00 00 00 00 
0060   07A0 00 00 00 00 
0060   07A4 00 00 00 00 
0060   07A8 00 00 00 00 
0060   07AC 00 00 00 00 
0060   07B0 00 00 00 00 
0060   07B4 00 00 00 00 
0060   07B8 00 00 00 00 
0060   07BC 00 00 00 00 
0060   07C0 00 00 00 00 
0060   07C4 00 00 00 00 
0060   07C8 00 00 00 00 
0060   07CC 00 00 00 00 
0060   07D0 00 00 00 00 
0060   07D4 00 00 00 00 
0060   07D8 00 00 00 00 
0060   07DC 00 00 00 00 
0060   07E0 00 00 00 00 
0060   07E4 00 00 00 00 
0060   07E8 00 00 00 00 
0060   07EC 00 00 00 00 
0060   07F0 00 00 00 00 
0060   07F4 00 00 00 00 
0060   07F8 00 00 00 00 
0060   07FC 00 00 00 00 
0061   0000             			.ORG	$0000
0062   0000 C3 7D 03    RESET_00:	JP		SETUP
0063   0003             ;
0064   0008             			.ORG	$0008
0065   0008 C3 7D 03    RESET_08:	JP		SETUP
0066   000B             ;
0067   0010             			.ORG	$0010
0068   0010 C3 7D 03    RESET_10:	JP		SETUP
0069   0013             ;
0070   0018             			.ORG	$0018
0071   0018 C3 7D 03    RESET_18:	JP		SETUP
0072   001B             ;
0073   0020             			.ORG	$0020
0074   0020 C3 7D 03    RESET_20:	JP		SETUP
0075   0023             ;
0076   0028             			.ORG	$0028
0077   0028 C3 7D 03    RESET_28:	JP		SETUP
0078   002B             ;
0079   0030             			.ORG	$0030
0080   0030 C3 7D 03    RESET_30:	JP		SETUP
0081   0033             ;
0082   0038             			.ORG	$0038
0083   0038 C3 7D 03    RESET_38:	JP		SETUP
0084   003B             ;
0085   0040             			.ORG	$0040
0086   0040 75 4D 4F 4E VERSION:	.TEXT	"uMON V1.00 by Scott Gregory"
0086   0044 20 56 31 2E 
0086   0048 30 30 20 62 
0086   004C 79 20 53 63 
0086   0050 6F 74 74 20 
0086   0054 47 72 65 67 
0086   0058 6F 72 79 
0087   005B             ;
0088   0066             			.ORG	$0066
0089   0066 F5          NMISERVICE:	PUSH	af ; Keyboard service routine.
0090   0067 DB 00       			IN		a,(KEYPORT)
0091   0069 32 C6 08    			LD		(KEYDATA),a
0092   006C F1          			POP		af
0093   006D ED 45       			RETN
0094   006F             ;
0095   0080             			.ORG	$0080
0096   0080 AF          DISPLAY:	XOR		a ; Display update routine.
0097   0081 D3 01       			OUT		(CATHPORT),a
0098   0083 D3 02       			OUT		(SEGPORT),a
0099   0085 4F          			LD		c,a
0100   0086 CB E9       			SET		5,c
0101   0088 ED 5B C1 08 			LD		de,(ADDRESS)
0102   008C 7A          			LD		a,d
0103   008D 32 C3 08    			LD		(SCRATCH),a
0104   0090 AF          			XOR		a
0105   0091 21 C3 08    			LD		hl,SCRATCH
0106   0094 ED 6F       			RLD
0107   0096 DD 21 9B 03 			LD		ix,HEX2SEG
0108   009A 16 00       			LD		d,$00
0109   009C 5F          			LD		e,a
0110   009D DD 19       			ADD		ix,de
0111   009F DD 7E 00    			LD		a,(ix)
0112   00A2 E5          			PUSH	hl
0113   00A3 21 C5 08    			LD		hl,MODE
0114   00A6 CB 46       			BIT		0,(hl)
0115   00A8 CA AD 00    			JP		z,DISL00
0116   00AB F6 10       			OR		$10
0117   00AD E1          DISL00:		POP		hl
0118   00AE D3 02       			OUT		(SEGPORT),a
0119   00B0 79          			LD		a,c
0120   00B1 D3 01       			OUT		(CATHPORT),a
0121   00B3 06 20       			LD		b,CATHDLY
0122   00B5 10 FE       DISL01:		DJNZ	DISL01
0123   00B7 AF          			XOR		a
0124   00B8 D3 01       			OUT		(CATHPORT),a
0125   00BA D3 02       			OUT		(SEGPORT),a
0126   00BC CB 19       			RR			c
0127   00BE ED 6F       			RLD
0128   00C0 DD 21 9B 03 			LD		ix,HEX2SEG
0129   00C4 16 00       			LD		d,$00
0130   00C6 5F          			LD		e,a
0131   00C7 DD 19       			ADD		ix,de
0132   00C9 DD 7E 00    			LD		a,(ix)
0133   00CC E5          			PUSH	hl
0134   00CD 21 C5 08    			LD		hl,MODE
0135   00D0 CB 46       			BIT		0,(hl)
0136   00D2 CA D7 00    			JP		z,DISL02
0137   00D5 F6 10       			OR		$10
0138   00D7 E1          DISL02:		POP		hl
0139   00D8 D3 02       			OUT		(SEGPORT),a
0140   00DA 79          			LD		a,c
0141   00DB D3 01       			OUT		(CATHPORT),a
0142   00DD 06 20       			LD		b,CATHDLY
0143   00DF 10 FE       DISL03:		DJNZ	DISL03
0144   00E1 AF          			XOR		a
0145   00E2 D3 01       			OUT		(CATHPORT),a
0146   00E4 D3 02       			OUT		(SEGPORT),a
0147   00E6 CB 19       			RR		c
0148   00E8 ED 5B C1 08 			LD		de,(ADDRESS)
0149   00EC 7B          			LD		a,e
0150   00ED 32 C3 08    			LD		(SCRATCH),a
0151   00F0 AF          			XOR		a
0152   00F1 21 C3 08    			LD		hl,SCRATCH
0153   00F4 ED 6F       			RLD
0154   00F6 DD 21 9B 03 			LD		ix,HEX2SEG
0155   00FA 16 00       			LD		d,$00
0156   00FC 5F          			LD		e,a
0157   00FD DD 19       			ADD		ix,de
0158   00FF DD 7E 00    			LD		a,(ix)
0159   0102 E5          			PUSH	hl
0160   0103 21 C5 08    			LD		hl,MODE
0161   0106 CB 46       			BIT		0,(hl)
0162   0108 CA 0D 01    			JP		z,DISL04
0163   010B F6 10       			OR		$10
0164   010D E1          DISL04:		POP		hl
0165   010E D3 02       			OUT		(SEGPORT),a
0166   0110 79          			LD		a,c
0167   0111 D3 01       			OUT		(CATHPORT),a
0168   0113 06 20       			LD			b,CATHDLY
0169   0115 10 FE       DISL05:		DJNZ	DISL05
0170   0117 AF          			XOR		a
0171   0118 D3 01       			OUT		(CATHPORT),a
0172   011A D3 02       			OUT		(SEGPORT),a
0173   011C CB 19       			RR		c
0174   011E ED 6F       			RLD
0175   0120 DD 21 9B 03 			LD		ix,HEX2SEG
0176   0124 16 00       			LD		d,$00
0177   0126 5F          			LD		e,a
0178   0127 DD 19       			ADD		ix,de
0179   0129 DD 7E 00    			LD		a,(ix)
0180   012C E5          			PUSH	hl
0181   012D 21 C5 08    			LD		hl,MODE
0182   0130 CB 46       			BIT		0,(hl)
0183   0132 CA 37 01    			JP		z,DISL06
0184   0135 F6 10       			OR		$10
0185   0137 E1          DISL06:		POP		hl
0186   0138 D3 02       			OUT		(SEGPORT),a
0187   013A 79          			LD		a,c
0188   013B D3 01       			OUT		(CATHPORT),a
0189   013D 06 20       			LD		b,CATHDLY
0190   013F 10 FE       DISL07:		DJNZ	DISL07
0191   0141 AF          			XOR		a
0192   0142 D3 02       			OUT		(SEGPORT),a
0193   0144 D3 01       			OUT		(CATHPORT),a
0194   0146 CB 19       			RR		c
0195   0148 2A C1 08    			LD		hl,(ADDRESS)
0196   014B 7E          			LD		a,(hl)
0197   014C 32 C3 08    			LD		(SCRATCH),a
0198   014F AF          			XOR		a
0199   0150 21 C3 08    			LD		hl,SCRATCH
0200   0153 ED 6F       			RLD
0201   0155 DD 21 9B 03 			LD		ix,HEX2SEG
0202   0159 16 00       			LD		d,$00
0203   015B 5F          			LD		e,a
0204   015C DD 19       			ADD		ix,de
0205   015E DD 7E 00    			LD		a,(ix)
0206   0161 E5          			PUSH	hl
0207   0162 21 C5 08    			LD		hl,MODE
0208   0165 CB 46       			BIT		0,(hl)
0209   0167 C2 6C 01    			JP		nz,DISL08
0210   016A F6 10       			OR		$10
0211   016C E1          DISL08:		POP		hl
0212   016D D3 02       			OUT		(SEGPORT),a
0213   016F 79          			LD		a,c
0214   0170 D3 01       			OUT		(CATHPORT),a
0215   0172 06 20       			LD		b,CATHDLY
0216   0174 10 FE       DISL09:		DJNZ	DISL09
0217   0176 AF          			XOR		a
0218   0177 D3 02       			OUT		(SEGPORT),a
0219   0179 D3 01       			OUT		(CATHPORT),a
0220   017B CB 19       			RR		c
0221   017D ED 6F       			RLD
0222   017F DD 21 9B 03 			LD		ix,HEX2SEG
0223   0183 16 00       			LD		d,$00
0224   0185 5F          			LD		e,a
0225   0186 DD 19       			ADD		ix,de
0226   0188 DD 7E 00    			LD		a,(ix)
0227   018B E5          			PUSH	hl
0228   018C 21 C5 08    			LD		hl,MODE
0229   018F CB 46       			BIT		0,(hl)
0230   0191 C2 96 01    			JP		nz,DISL0A
0231   0194 F6 10       			OR		$10
0232   0196 E1          DISL0A:		POP		hl
0233   0197 D3 02       			OUT		($02),a
0234   0199 79          			LD		a,c
0235   019A D3 01       			OUT		($01),a
0236   019C 06 20       			LD		b,CATHDLY
0237   019E 10 FE       DISL0B:		DJNZ	DISL0B
0238   01A0 C9          			RET
0239   01A1             ;
0240   01A1 E5          KEYBOARD:	PUSH	hl ; Key decoder routine.
0241   01A2 F5          			PUSH	af
0242   01A3 21 30 00    			LD		hl,$0030
0243   01A6 22 C7 08    			LD		(BEEPLENGTH),hl
0244   01A9 21 C9 08    			LD		hl,BEEPFREQ
0245   01AC 36 30       			LD		(hl),$30
0246   01AE 21 C6 08    			LD		hl,KEYDATA
0247   01B1 3E FF       			LD		a,$FF
0248   01B3 BE          			CP		(hl)
0249   01B4 CA 36 03    			JP		z,KEYLXX
0250   01B7 CD 3E 03    			CALL	BEEP
0251   01BA 7E          			LD		a,(hl)
0252   01BB E6 3F       			AND		$3f ; We only want the first 6 bits.
0253   01BD EE 20       			XOR		$20 ; Flip bit 6 (Shift key) because it gives a 1 when not being pressed.
0254   01BF             ;
0255   01BF FE 10       			CP		$10 ; + key.
0256   01C1 C2 D7 01    			JP		nz,KEYL00
0257   01C4 2A C1 08    			LD		hl,(ADDRESS)
0258   01C7 23          			INC		hl
0259   01C8 22 C1 08    			LD		(ADDRESS),hl
0260   01CB 21 C5 08    			LD		hl,MODE
0261   01CE CB 86       			RES		0,(hl)
0262   01D0 CB 8E       			RES		1,(hl)
0263   01D2 CB 96       			RES		2,(hl)
0264   01D4 C3 36 03    			JP		KEYLXX
0265   01D7             ;
0266   01D7 FE 11       KEYL00:		CP		$11 ; - key.
0267   01D9 C2 EF 01    			JP		nz,KEYL01
0268   01DC 2A C1 08    			LD		hl,(ADDRESS)
0269   01DF 2B          			DEC		hl
0270   01E0 22 C1 08    			LD		(ADDRESS),hl
0271   01E3 21 C5 08    			LD		hl,MODE
0272   01E6 CB 86       			RES		0,(hl)
0273   01E8 CB 8E       			RES		1,(hl)
0274   01EA CB 96       			RES		2,(hl)
0275   01EC C3 36 03    			JP		KEYLXX
0276   01EF             ;
0277   01EF FE 12       KEYL01:		CP		$12 ; GO key.
0278   01F1 C2 FB 01    			JP		nz,KEYL02
0279   01F4 31 C0 08    			LD		sp,STACKTOP
0280   01F7 2A C1 08    			LD		hl,(ADDRESS)
0281   01FA E9          			JP		(hl)
0282   01FB             ;
0283   01FB FE 13       KEYL02:		CP		$13 ; AD key.
0284   01FD C2 11 02    			JP		nz,KEYL03
0285   0200 47          			LD		b,a
0286   0201 3A C5 08    			LD		a,(MODE)
0287   0204 EE 01       			XOR		$01
0288   0206 CB 8F       			RES		1,a
0289   0208 CB 97       			RES		2,a
0290   020A 32 C5 08    			LD		(MODE),a
0291   020D 78          			LD		a,b
0292   020E C3 36 03    			JP		KEYLXX
0293   0211             ;
0294   0211 FE 20       KEYL03:		CP		$20 ; Shift-0 key - MOD-01: RAMTest
0295   0213 C2 20 02    			JP		nz,KEYL04
0296   0216 F5          			PUSH	af
0297   0217 E5          			PUSH	hl
0298   0218 CD AB 03    			CALL	MOD01
0299   021B E1          			POP		hl
0300   021C F1          			POP		af
0301   021D C3 36 03    			JP		KEYLXX
0302   0220             ;
0303   0220 FE 21       KEYL04:		CP		$21 ; Shift-1 key - MOD-02: Serial Send
0304   0222 C2 2F 02    			JP		nz,KEYL05
0305   0225 F5          			PUSH	af
0306   0226 E5          			PUSH	hl
0307   0227 CD FF 03    			CALL	MOD02
0308   022A E1          			POP		hl
0309   022B F1          			POP		af
0310   022C C3 36 03    			JP		KEYLXX
0311   022F             ;
0312   022F FE 22       KEYL05:		CP		$22 ; Shift-2 key - MOD-03: Serial Receive
0313   0231 C2 3E 02    			JP		nz,KEYL06
0314   0234 F5          			PUSH	af
0315   0235 E5          			PUSH	hl
0316   0236 CD 20 04    			CALL	MOD03
0317   0239 E1          			POP		hl
0318   023A F1          			POP		af
0319   023B CA 36 03    			JP		z,KEYLXX
0320   023E             ;
0321   023E FE 23       KEYL06:		CP		$23 ; Shift-3 key.
0322   0240 CA 36 03    			JP		z,KEYLXX
0323   0243 FE 24       KEYL07:		CP		$24 ; Shift-4 key.
0324   0245 CA 36 03    			JP		z,KEYLXX
0325   0248 FE 25       KEYL08:		CP		$25 ; Shift-5 key.
0326   024A CA 36 03    			JP		z,KEYLXX
0327   024D FE 26       KEYL09:		CP		$26 ; Shift-6 key.
0328   024F CA 36 03    			JP		z,KEYLXX
0329   0252 FE 27       KEYL0A:		CP		$27 ; Shift-7 key.
0330   0254 CA 36 03    			JP		z,KEYLXX
0331   0257 FE 28       KEYL0B:		CP		$28 ; Shift-8 key.
0332   0259 CA 36 03    			JP		z,KEYLXX
0333   025C FE 29       KEYL0C:		CP		$29 ; Shift-9 key.
0334   025E CA 36 03    			JP		z,KEYLXX
0335   0261 FE 2A       KEYL0D:		CP		$2A ; Shift-A key.
0336   0263 CA 36 03    			JP		z,KEYLXX
0337   0266 FE 2B       KEYL0E:		CP		$2B ; Shift-B key.
0338   0268 CA 36 03    			JP		z,KEYLXX
0339   026B FE 2C       KEYL0F:		CP		$2C ; Shift-C key.
0340   026D CA 36 03    			JP		z,KEYLXX
0341   0270 FE 2D       KEYL10:		CP		$2D ; Shift-D key.
0342   0272 CA 36 03    			JP		z,KEYLXX
0343   0275 FE 2E       KEYL11:		CP		$2E ; Shift-E key.
0344   0277 CA 36 03    			JP		z,KEYLXX
0345   027A FE 2F       KEYL12:		CP		$2F ; Shift-F key - MOD-10: Serial Echo
0346   027C C2 82 02    			JP		nz,KEYL13
0347   027F C3 41 04    			JP		MOD10
0348   0282             ;
0349   0282 FE 30       KEYL13:		CP		$30 ; Shift-+ key.
0350   0284 C2 A8 02    			JP		nz,KEYL14
0351   0287 21 FF FF    			LD		hl,RAMTOP
0352   028A ED 5B C1 08 			LD		de,(ADDRESS)
0353   028E ED 52       			SBC		hl,de
0354   0290 44          			LD		b,h
0355   0291 4D          			LD		c,l
0356   0292 21 FF FF    			LD		hl,RAMTOP
0357   0295 54          			LD		d,h
0358   0296 5D          			LD		e,l
0359   0297 2B          			DEC		hl
0360   0298 ED B8       			LDDR
0361   029A 62          			LD		h,d
0362   029B 6B          			LD		l,e
0363   029C 36 00       			LD		(hl),$00
0364   029E 21 C5 08    			LD		hl,MODE
0365   02A1 CB 8E       			RES		1,(hl)
0366   02A3 CB 96       			RES		2,(hl)
0367   02A5 C3 36 03    			JP		KEYLXX
0368   02A8             ;
0369   02A8 FE 31       KEYL14:		CP		$31 ; Shift-- key.
0370   02AA C2 CE 02    			JP		nz,KEYL15
0371   02AD 21 FF FF    			LD		hl,RAMTOP
0372   02B0 ED 5B C1 08 			LD		de,(ADDRESS)
0373   02B4 ED 52       			SBC		hl,de
0374   02B6 44          			LD		b,h
0375   02B7 4D          			LD		c,l
0376   02B8 2A C1 08    			LD		hl,(ADDRESS)
0377   02BB 54          			LD		d,h
0378   02BC 5D          			LD		e,l
0379   02BD 23          			INC		hl
0380   02BE ED B0       			LDIR
0381   02C0 62          			LD		h,d
0382   02C1 6B          			LD		l,e
0383   02C2 36 00       			LD		(hl),$00
0384   02C4 21 C5 08    			LD		hl,MODE
0385   02C7 CB 8E       			RES		1,(hl)
0386   02C9 CB 96       			RES		2,(hl)
0387   02CB C3 36 03    			JP		KEYLXX
0388   02CE             ;
0389   02CE FE 32       KEYL15:		CP		$32 ; Shift-GO key.
0390   02D0 CA 36 03    			JP		z,KEYLXX
0391   02D3 FE 33       KEYL16:		CP		$33 ; Shift-AD key.
0392   02D5 CA 36 03    			JP		z,KEYLXX
0393   02D8             ;
0394   02D8 21 C5 08    KEYL17:		LD		hl,MODE ; Non-shifted digit keys entry.
0395   02DB CB 46       			BIT		0,(hl) ; 0 = Data Mode, 1 = Address Mode.
0396   02DD C2 11 03    			JP		nz,KEYL19
0397   02E0 CB 4E       			BIT		1,(hl)
0398   02E2 CA FD 02    			JP		z,KEYL17B ; Jump on 1st time through a data edit.
0399   02E5 CB 56       			BIT		2,(hl)
0400   02E7 CA FB 02    			JP		z,KEYL17A ; Jump on 2nd time through a data edit.
0401   02EA CB 8E       			RES		1,(hl) ; Do this the 3rd time round a data edit.
0402   02EC CB 96       			RES		2,(hl)
0403   02EE 2A C1 08    			LD		hl,(ADDRESS)
0404   02F1 23          			INC		hl
0405   02F2 22 C1 08    			LD		(ADDRESS),hl
0406   02F5 21 C5 08    			LD		hl,MODE
0407   02F8 C3 FD 02    			JP		KEYL17B
0408   02FB CB D6       KEYL17A:	SET		2,(hl)
0409   02FD CB 4E       KEYL17B:	BIT		1,(hl) ; 0 = first nibble, 1 = second nibble.
0410   02FF C2 09 03    			JP		nz,KEYL18
0411   0302 CB CE       			SET		1,(hl)
0412   0304 2A C1 08    			LD		hl,(ADDRESS)
0413   0307 36 00       			LD		(hl),$00
0414   0309             ;
0415   0309 2A C1 08    KEYL18:		LD		hl,(ADDRESS)
0416   030C ED 6F       			RLD
0417   030E C3 36 03    KEYL18A:	JP		KEYLXX
0418   0311             ;
0419   0311 CB 4E       KEYL19:		BIT		1,(hl) ; 0 = first nibble, 1 = subsequent nibbles.
0420   0313 C2 1E 03    			JP		nz,KEYL1A
0421   0316 CB CE       			SET		1,(hl)
0422   0318 21 00 00    			LD		hl,$0000
0423   031B 22 C1 08    			LD		(ADDRESS),hl
0424   031E             ;
0425   031E 21 C1 08    KEYL1A:		LD		hl,ADDRESS
0426   0321 ED 6F       			RLD
0427   0323 2A C1 08    			LD		hl,(ADDRESS)
0428   0326 CB 24       			SLA		h
0429   0328 CB 24       			SLA		h
0430   032A CB 24       			SLA		h
0431   032C CB 24       			SLA		h
0432   032E 47          			LD		b,a
0433   032F AF          			XOR		a
0434   0330 B4          			OR		h
0435   0331 B0          			OR		b
0436   0332 67          			LD		h,a
0437   0333 22 C1 08    			LD		(ADDRESS),hl
0438   0336             ;
0439   0336 21 C6 08    KEYLXX:		LD		hl,KEYDATA ; Done with the key decoder.
0440   0339 36 FF       			LD		(hl),$FF
0441   033B F1          			POP		af
0442   033C E1          			POP		hl
0443   033D C9          			RET
0444   033E             ;
0445   033E E5          BEEP:		PUSH	hl
0446   033F F5          			PUSH	af
0447   0340 21 C9 08    			LD		hl,BEEPFREQ
0448   0343 4E          			LD		c,(hl)
0449   0344 2A C7 08    			LD		hl,(BEEPLENGTH)
0450   0347 AF          			XOR		a
0451   0348 57          			LD		d,a
0452   0349 41          BEEPL01:	LD		b,c
0453   034A 7A          			LD		a,d
0454   034B D3 01       			OUT		(CATHPORT),a
0455   034D 10 FE       BEEPL02:	DJNZ	BEEPL02
0456   034F EE 80       			XOR		$80
0457   0351 2B          			DEC		hl
0458   0352 57          			LD		d,a
0459   0353 7C          			LD		a,h
0460   0354 B5          			OR		l
0461   0355 C2 49 03    			JP		nz,BEEPL01
0462   0358 F1          			POP		af
0463   0359 E1          			POP		hl
0464   035A C9          			RET
0465   035B             ;
0466   035B E5          STARTBEEP:	PUSH	hl
0467   035C F5          			PUSH	af
0468   035D 21 7F 00    			LD		hl,$007F
0469   0360 22 C7 08    			LD		(BEEPLENGTH),hl
0470   0363 21 C9 08    			LD		hl,BEEPFREQ
0471   0366 36 35       			LD		(hl),$35
0472   0368 CD 3E 03    			CALL	BEEP
0473   036B 36 30       			LD		(hl),$30
0474   036D CD 3E 03    			CALL	BEEP
0475   0370 36 25       			LD		(hl),$25
0476   0372 CD 3E 03    			CALL	BEEP
0477   0375 36 20       			LD		(hl),$20
0478   0377 CD 3E 03    			CALL	BEEP
0479   037A F1          			POP		af
0480   037B E1          			POP		hl
0481   037C C9          			RET
0482   037D             ;			
0483   037D 31 C0 08    SETUP:		LD		sp,STACKTOP ; Post reset/power up setup.
0484   0380 21 00 09    			LD		hl,RAMBASE
0485   0383 22 C1 08    			LD		(ADDRESS),hl
0486   0386 AF          			XOR		a
0487   0387 32 C5 08    			LD		(MODE),a
0488   038A 3E FF       			LD		a,$FF
0489   038C 32 C6 08    			LD		(KEYDATA),a
0490   038F CD 5B 03    			CALL	STARTBEEP
0491   0392             ;
0492   0392 CD 80 00    MAIN:		CALL	DISPLAY
0493   0395 CD A1 01    			CALL	KEYBOARD
0494   0398 C3 92 03    			JP		MAIN
0495   039B             ;
0496   039B EB 28 CD AD HEX2SEG:	.DB		$EB,$28,$CD,$AD,$2E,$A7,$E7,$29 ; HEX Byte to LED Segment conversion.
0496   039F 2E A7 E7 29 
0497   03A3 EF 2F 6F E6 			.DB		$EF,$2F,$6F,$E6,$C3,$EC,$C7,$47
0497   03A7 C3 EC C7 47 
0498   03AB             ;
0499   03AB             ; BEGIN MODULES.
0500   03AB             ; START MOD-01 - Memory Test
0501   03AB 2A F2 08    MOD01:		LD		hl,(M01FINISH)
0502   03AE 23          			INC		hl
0503   03AF ED 5B F0 08 			LD		de,(M01START)
0504   03B3 AF          			XOR		a
0505   03B4 ED 52       			SBC		hl,de
0506   03B6 44          			LD		b,h
0507   03B7 4D          			LD		c,l
0508   03B8 ED 43 F2 08 			LD		(M01FINISH),bc
0509   03BC 2A F0 08    			LD		hl,(M01START)
0510   03BF ED 5B F4 08 			LD		de,(M01PATTERN)
0511   03C3 D9          			EXX
0512   03C4 2A F0 08    			LD		hl,(M01START)
0513   03C7 ED 4B F2 08 			LD		bc,(M01FINISH)
0514   03CB ED 5B F4 08 			LD		de,(M01PATTERN)
0515   03CF             ;
0516   03CF 72          M01LDBLK:	LD		(hl),d
0517   03D0 23          			INC		hl
0518   03D1 0B          			DEC		bc
0519   03D2 78          			LD		a,b
0520   03D3 B1          			OR		c
0521   03D4 C2 CF 03    			JP		nz,M01LDBLK
0522   03D7 11 00 00    			LD		de,$0000
0523   03DA             ;
0524   03DA 1B          M01DELAY:	DEC		de
0525   03DB 7A          			LD		a,d
0526   03DC B3          			OR		e
0527   03DD C2 DA 03    			JP		nz,M01DELAY
0528   03E0 11 00 00    			LD		de,$0000
0529   03E3 D9          			EXX
0530   03E4             ;
0531   03E4 C3 ED 03    M01TSTBLK:	JP		M01TEST01
0532   03E7 D9          M01TEST00:	EXX
0533   03E8 13          			INC		de
0534   03E9 D9          			EXX
0535   03EA C3 F2 03    			JP		M01TEST02
0536   03ED 7E          M01TEST01:	LD		a,(hl)
0537   03EE BA          			CP		d
0538   03EF C2 E7 03    			JP		nz,M01TEST00
0539   03F2 23          M01TEST02:	INC		hl
0540   03F3 0B          			DEC		bc
0541   03F4 78          			LD		a,b
0542   03F5 B1          			OR		c
0543   03F6 C2 ED 03    			JP		nz,M01TEST01
0544   03F9             ;
0545   03F9 D9          M01STORE:	EXX
0546   03FA ED 53 F0 08 			LD		(M01START),de
0547   03FE C9          			RET
0548   03FF             ; END MOD-01
0549   03FF             ;
0550   03FF             ; START MOD-02 - Serial Send
0551   03FF DB 06       MOD02:		IN		a,(SERBUFFER)
0552   0401 2A F8 08    			LD		hl,(SEREND)
0553   0404 ED 5B F6 08 			LD		de,(SERSTART)
0554   0408 ED 52       			SBC		hl,de
0555   040A EB          			EX		de,hl
0556   040B 3E 06       			LD		a,SERBUFFER
0557   040D 4F          			LD		c,a
0558   040E 43          			LD		b,e
0559   040F             ;
0560   040F DB 07       M02MAIN:	IN		a,(SERSTATUS)
0561   0411 CB 47       			BIT		0,a
0562   0413 C2 0F 04    			JP		nz,M02MAIN
0563   0416 ED A3       			OUTI
0564   0418 7A          			LD		a,d
0565   0419 B3          			OR		e
0566   041A C8          			RET		z
0567   041B 1B          			DEC		de
0568   041C 43          			LD		b,e
0569   041D C3 0F 04    			JP		M02MAIN
0570   0420             
0571   0420             ; END MOD-02
0572   0420             ;
0573   0420             ; START MOD-03 - Serial Receive
0574   0420 DB 06       MOD03:		IN		a,(SERBUFFER)
0575   0422 2A F8 08    			LD		hl,(SEREND)
0576   0425 ED 5B F6 08 			LD		de,(SERSTART)
0577   0429 ED 52       			SBC		hl,de
0578   042B EB          			EX		de,hl
0579   042C 3E 06       			LD		a,SERBUFFER
0580   042E 4F          			LD		c,a
0581   042F 43          			LD		b,e
0582   0430             ;
0583   0430 DB 07       M03MAIN:	IN		a,(SERSTATUS)
0584   0432 CB 4F       			BIT		1,a
0585   0434 CA 30 04    			JP		z,M03MAIN
0586   0437 ED A2       			INI
0587   0439 7A          			LD		a,d
0588   043A B3          			OR		e
0589   043B C8          			RET		z
0590   043C 1B          			DEC		de
0591   043D 43          			LD		b,e
0592   043E C3 30 04    			JP		M03MAIN
0593   0441             ; END MOD-03
0594   0441             ;
0595   0441             ; START MOD-10 - Serial Echo
0596   0441 DB 07       MOD10:		IN		a,(SERSTATUS)
0597   0443 CB 4F       			BIT		1,a
0598   0445 C4 4B 04    			CALL	nz,M10RCV ; Have we received data?
0599   0448 C3 41 04    			JP		MOD10
0600   044B             
0601   044B DB 06       M10RCV:		IN		a,(SERBUFFER)
0602   044D 47          			LD		b,a
0603   044E CD 52 04    			CALL	M10XMIT
0604   0451 C9          			RET
0605   0452             
0606   0452 DB 07       M10XMIT:	IN		a,(SERSTATUS)
0607   0454 CB 47       			BIT		0,a
0608   0456 C2 52 04    			JP		nz,M10XMIT
0609   0459 78          			LD		a,b
0610   045A D3 06       			OUT		(SERBUFFER),a
0611   045C AF          			XOR		a
0612   045D C9          			RET
0613   045E             ; END MOD-10
0614   045E             ; END MODULES.
0615   045E             ;
0616   045E             			.END
tasm: Number of errors = 0
