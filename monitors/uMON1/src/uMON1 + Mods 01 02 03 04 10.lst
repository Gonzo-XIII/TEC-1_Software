0001   0000             ; ######################################
0002   0000             ; #                                    #
0003   0000             ; #         uMON1 Version 1.04         #
0004   0000             ; #  --------------------------------  #
0005   0000             ; #   Special Key Sequences            #
0006   0000             ; #  --------------------------------  #
0007   0000             ; #   Shift-+ - Insert byte.           #
0008   0000             ; #   Shift-- - Delete byte.           #
0009   0000             ; #                                    #
0010   0000             ; #  --------------------------------  #
0011   0000             ; #   Included Modules                 #
0012   0000             ; #  --------------------------------  #
0013   0000             ; #   MOD01-RAMTest         (Shift-0)  #
0014   0000             ; #   MOD02-Serial Send     (Shift-1)  #
0015   0000             ; #   MOD03-Serial Receive  (Shift-2)  #
0016   0000             ; #   MOD04-Memory Copy     (Shift-3)  #
0017   0000             ; #   MOD10-Serial Loopback (Shift-F)  #
0018   0000             ; #  --------------------------------  #
0019   0000             ; #                                    #
0020   0000             ; #  by Scott Gregory                  #
0021   0000             ; #  13/06/2021                        #
0022   0000             ; #                                    #
0023   0000             ; #  Last update                       #
0024   0000             ; #  18/07/2021                        #
0025   0000             ; ######################################
0026   0000             ;
0027   0000             STACKTOP	.EQU	$08C0 ; Stack position.
0028   0000             ROMBASE		.EQU	$0000 ; Start of ROM.
0029   0000             ROMTOP		.EQU	$07FF ; End of ROM.
0030   0000             RAMBASE		.EQU	$0900 ; Start of user RAM.
0031   0000             RAMTOP		.EQU	$FFFF ; End of user RAM.
0032   0000             CATHDLY		.EQU	$40 ; Digit display delay.
0033   0000             KEYPORT		.EQU	$00 ; Keypad port.
0034   0000             CATHPORT	.EQU	$01 ; Display catchode port.
0035   0000             SEGPORT		.EQU	$02 ; Display segment port.
0036   0000             ;
0037   0000             ADDRESS		.EQU	$08C1 ; 2 Bytes.
0038   0000             SCRATCH		.EQU	$08C3 ; 2 Bytes.
0039   0000             MODE		.EQU	$08C5 ; 1 Byte.
0040   0000             KEYDATA		.EQU	$08C6 ; 1 Byte.
0041   0000             BEEPLENGTH	.EQU	$08C7 ; 2 Bytes.
0042   0000             BEEPFREQ	.EQU	$08C9 ; 1 Byte.
0043   0000             ;
0044   0000             ; Begin global MOD assignments.
0045   0000             SERBUFFER	.EQU	$06
0046   0000             SERSTATUS	.EQU	$07
0047   0000             SERSTART	.EQU	$08F6
0048   0000             SEREND		.EQU	$08F8
0049   0000             ; End global MOD assignments.
0050   0000             ;
0051   0000             ; Begin MOD-01 assignments.
0052   0000             M01START	.EQU	$08F0
0053   0000             M01FINISH	.EQU	$08F2
0054   0000             M01PATTERN	.EQU	$08F4
0055   0000             ; End MOD-01 assignments.
0056   0000             ;
0057   0000             ; Begin MOD-02 assignments.
0058   0000             ; End MOD-02 assignments.
0059   0000             ;
0060   0000             ; Begin MOD-03 assignments.
0061   0000             ; End MOD-03 assignments.
0062   0000             ;
0063   0000             ; Begin MOD-04 assignments.
0064   0000             SRCRAM		.EQU	$08E0
0065   0000             DESTRAM		.EQU	$08E2
0066   0000             BLKSIZE		.EQU	$08E4
0067   0000             ; End MOD-04 assignments.
0068   0000             ;
0069   0000             ; Begin MOD-10 assignments.
0070   0000             ; End MOD-10 assignments.
0071   0000             ;
0072   0000 00 00 00 00 			.FILL	(ROMTOP - ROMBASE) + 1, $00
0072   0004 00 00 00 00 
0072   0008 00 00 00 00 
0072   000C 00 00 00 00 
0072   0010 00 00 00 00 
0072   0014 00 00 00 00 
0072   0018 00 00 00 00 
0072   001C 00 00 00 00 
0072   0020 00 00 00 00 
0072   0024 00 00 00 00 
0072   0028 00 00 00 00 
0072   002C 00 00 00 00 
0072   0030 00 00 00 00 
0072   0034 00 00 00 00 
0072   0038 00 00 00 00 
0072   003C 00 00 00 00 
0072   0040 00 00 00 00 
0072   0044 00 00 00 00 
0072   0048 00 00 00 00 
0072   004C 00 00 00 00 
0072   0050 00 00 00 00 
0072   0054 00 00 00 00 
0072   0058 00 00 00 00 
0072   005C 00 00 00 00 
0072   0060 00 00 00 00 
0072   0064 00 00 00 00 
0072   0068 00 00 00 00 
0072   006C 00 00 00 00 
0072   0070 00 00 00 00 
0072   0074 00 00 00 00 
0072   0078 00 00 00 00 
0072   007C 00 00 00 00 
0072   0080 00 00 00 00 
0072   0084 00 00 00 00 
0072   0088 00 00 00 00 
0072   008C 00 00 00 00 
0072   0090 00 00 00 00 
0072   0094 00 00 00 00 
0072   0098 00 00 00 00 
0072   009C 00 00 00 00 
0072   00A0 00 00 00 00 
0072   00A4 00 00 00 00 
0072   00A8 00 00 00 00 
0072   00AC 00 00 00 00 
0072   00B0 00 00 00 00 
0072   00B4 00 00 00 00 
0072   00B8 00 00 00 00 
0072   00BC 00 00 00 00 
0072   00C0 00 00 00 00 
0072   00C4 00 00 00 00 
0072   00C8 00 00 00 00 
0072   00CC 00 00 00 00 
0072   00D0 00 00 00 00 
0072   00D4 00 00 00 00 
0072   00D8 00 00 00 00 
0072   00DC 00 00 00 00 
0072   00E0 00 00 00 00 
0072   00E4 00 00 00 00 
0072   00E8 00 00 00 00 
0072   00EC 00 00 00 00 
0072   00F0 00 00 00 00 
0072   00F4 00 00 00 00 
0072   00F8 00 00 00 00 
0072   00FC 00 00 00 00 
0072   0100 00 00 00 00 
0072   0104 00 00 00 00 
0072   0108 00 00 00 00 
0072   010C 00 00 00 00 
0072   0110 00 00 00 00 
0072   0114 00 00 00 00 
0072   0118 00 00 00 00 
0072   011C 00 00 00 00 
0072   0120 00 00 00 00 
0072   0124 00 00 00 00 
0072   0128 00 00 00 00 
0072   012C 00 00 00 00 
0072   0130 00 00 00 00 
0072   0134 00 00 00 00 
0072   0138 00 00 00 00 
0072   013C 00 00 00 00 
0072   0140 00 00 00 00 
0072   0144 00 00 00 00 
0072   0148 00 00 00 00 
0072   014C 00 00 00 00 
0072   0150 00 00 00 00 
0072   0154 00 00 00 00 
0072   0158 00 00 00 00 
0072   015C 00 00 00 00 
0072   0160 00 00 00 00 
0072   0164 00 00 00 00 
0072   0168 00 00 00 00 
0072   016C 00 00 00 00 
0072   0170 00 00 00 00 
0072   0174 00 00 00 00 
0072   0178 00 00 00 00 
0072   017C 00 00 00 00 
0072   0180 00 00 00 00 
0072   0184 00 00 00 00 
0072   0188 00 00 00 00 
0072   018C 00 00 00 00 
0072   0190 00 00 00 00 
0072   0194 00 00 00 00 
0072   0198 00 00 00 00 
0072   019C 00 00 00 00 
0072   01A0 00 00 00 00 
0072   01A4 00 00 00 00 
0072   01A8 00 00 00 00 
0072   01AC 00 00 00 00 
0072   01B0 00 00 00 00 
0072   01B4 00 00 00 00 
0072   01B8 00 00 00 00 
0072   01BC 00 00 00 00 
0072   01C0 00 00 00 00 
0072   01C4 00 00 00 00 
0072   01C8 00 00 00 00 
0072   01CC 00 00 00 00 
0072   01D0 00 00 00 00 
0072   01D4 00 00 00 00 
0072   01D8 00 00 00 00 
0072   01DC 00 00 00 00 
0072   01E0 00 00 00 00 
0072   01E4 00 00 00 00 
0072   01E8 00 00 00 00 
0072   01EC 00 00 00 00 
0072   01F0 00 00 00 00 
0072   01F4 00 00 00 00 
0072   01F8 00 00 00 00 
0072   01FC 00 00 00 00 
0072   0200 00 00 00 00 
0072   0204 00 00 00 00 
0072   0208 00 00 00 00 
0072   020C 00 00 00 00 
0072   0210 00 00 00 00 
0072   0214 00 00 00 00 
0072   0218 00 00 00 00 
0072   021C 00 00 00 00 
0072   0220 00 00 00 00 
0072   0224 00 00 00 00 
0072   0228 00 00 00 00 
0072   022C 00 00 00 00 
0072   0230 00 00 00 00 
0072   0234 00 00 00 00 
0072   0238 00 00 00 00 
0072   023C 00 00 00 00 
0072   0240 00 00 00 00 
0072   0244 00 00 00 00 
0072   0248 00 00 00 00 
0072   024C 00 00 00 00 
0072   0250 00 00 00 00 
0072   0254 00 00 00 00 
0072   0258 00 00 00 00 
0072   025C 00 00 00 00 
0072   0260 00 00 00 00 
0072   0264 00 00 00 00 
0072   0268 00 00 00 00 
0072   026C 00 00 00 00 
0072   0270 00 00 00 00 
0072   0274 00 00 00 00 
0072   0278 00 00 00 00 
0072   027C 00 00 00 00 
0072   0280 00 00 00 00 
0072   0284 00 00 00 00 
0072   0288 00 00 00 00 
0072   028C 00 00 00 00 
0072   0290 00 00 00 00 
0072   0294 00 00 00 00 
0072   0298 00 00 00 00 
0072   029C 00 00 00 00 
0072   02A0 00 00 00 00 
0072   02A4 00 00 00 00 
0072   02A8 00 00 00 00 
0072   02AC 00 00 00 00 
0072   02B0 00 00 00 00 
0072   02B4 00 00 00 00 
0072   02B8 00 00 00 00 
0072   02BC 00 00 00 00 
0072   02C0 00 00 00 00 
0072   02C4 00 00 00 00 
0072   02C8 00 00 00 00 
0072   02CC 00 00 00 00 
0072   02D0 00 00 00 00 
0072   02D4 00 00 00 00 
0072   02D8 00 00 00 00 
0072   02DC 00 00 00 00 
0072   02E0 00 00 00 00 
0072   02E4 00 00 00 00 
0072   02E8 00 00 00 00 
0072   02EC 00 00 00 00 
0072   02F0 00 00 00 00 
0072   02F4 00 00 00 00 
0072   02F8 00 00 00 00 
0072   02FC 00 00 00 00 
0072   0300 00 00 00 00 
0072   0304 00 00 00 00 
0072   0308 00 00 00 00 
0072   030C 00 00 00 00 
0072   0310 00 00 00 00 
0072   0314 00 00 00 00 
0072   0318 00 00 00 00 
0072   031C 00 00 00 00 
0072   0320 00 00 00 00 
0072   0324 00 00 00 00 
0072   0328 00 00 00 00 
0072   032C 00 00 00 00 
0072   0330 00 00 00 00 
0072   0334 00 00 00 00 
0072   0338 00 00 00 00 
0072   033C 00 00 00 00 
0072   0340 00 00 00 00 
0072   0344 00 00 00 00 
0072   0348 00 00 00 00 
0072   034C 00 00 00 00 
0072   0350 00 00 00 00 
0072   0354 00 00 00 00 
0072   0358 00 00 00 00 
0072   035C 00 00 00 00 
0072   0360 00 00 00 00 
0072   0364 00 00 00 00 
0072   0368 00 00 00 00 
0072   036C 00 00 00 00 
0072   0370 00 00 00 00 
0072   0374 00 00 00 00 
0072   0378 00 00 00 00 
0072   037C 00 00 00 00 
0072   0380 00 00 00 00 
0072   0384 00 00 00 00 
0072   0388 00 00 00 00 
0072   038C 00 00 00 00 
0072   0390 00 00 00 00 
0072   0394 00 00 00 00 
0072   0398 00 00 00 00 
0072   039C 00 00 00 00 
0072   03A0 00 00 00 00 
0072   03A4 00 00 00 00 
0072   03A8 00 00 00 00 
0072   03AC 00 00 00 00 
0072   03B0 00 00 00 00 
0072   03B4 00 00 00 00 
0072   03B8 00 00 00 00 
0072   03BC 00 00 00 00 
0072   03C0 00 00 00 00 
0072   03C4 00 00 00 00 
0072   03C8 00 00 00 00 
0072   03CC 00 00 00 00 
0072   03D0 00 00 00 00 
0072   03D4 00 00 00 00 
0072   03D8 00 00 00 00 
0072   03DC 00 00 00 00 
0072   03E0 00 00 00 00 
0072   03E4 00 00 00 00 
0072   03E8 00 00 00 00 
0072   03EC 00 00 00 00 
0072   03F0 00 00 00 00 
0072   03F4 00 00 00 00 
0072   03F8 00 00 00 00 
0072   03FC 00 00 00 00 
0072   0400 00 00 00 00 
0072   0404 00 00 00 00 
0072   0408 00 00 00 00 
0072   040C 00 00 00 00 
0072   0410 00 00 00 00 
0072   0414 00 00 00 00 
0072   0418 00 00 00 00 
0072   041C 00 00 00 00 
0072   0420 00 00 00 00 
0072   0424 00 00 00 00 
0072   0428 00 00 00 00 
0072   042C 00 00 00 00 
0072   0430 00 00 00 00 
0072   0434 00 00 00 00 
0072   0438 00 00 00 00 
0072   043C 00 00 00 00 
0072   0440 00 00 00 00 
0072   0444 00 00 00 00 
0072   0448 00 00 00 00 
0072   044C 00 00 00 00 
0072   0450 00 00 00 00 
0072   0454 00 00 00 00 
0072   0458 00 00 00 00 
0072   045C 00 00 00 00 
0072   0460 00 00 00 00 
0072   0464 00 00 00 00 
0072   0468 00 00 00 00 
0072   046C 00 00 00 00 
0072   0470 00 00 00 00 
0072   0474 00 00 00 00 
0072   0478 00 00 00 00 
0072   047C 00 00 00 00 
0072   0480 00 00 00 00 
0072   0484 00 00 00 00 
0072   0488 00 00 00 00 
0072   048C 00 00 00 00 
0072   0490 00 00 00 00 
0072   0494 00 00 00 00 
0072   0498 00 00 00 00 
0072   049C 00 00 00 00 
0072   04A0 00 00 00 00 
0072   04A4 00 00 00 00 
0072   04A8 00 00 00 00 
0072   04AC 00 00 00 00 
0072   04B0 00 00 00 00 
0072   04B4 00 00 00 00 
0072   04B8 00 00 00 00 
0072   04BC 00 00 00 00 
0072   04C0 00 00 00 00 
0072   04C4 00 00 00 00 
0072   04C8 00 00 00 00 
0072   04CC 00 00 00 00 
0072   04D0 00 00 00 00 
0072   04D4 00 00 00 00 
0072   04D8 00 00 00 00 
0072   04DC 00 00 00 00 
0072   04E0 00 00 00 00 
0072   04E4 00 00 00 00 
0072   04E8 00 00 00 00 
0072   04EC 00 00 00 00 
0072   04F0 00 00 00 00 
0072   04F4 00 00 00 00 
0072   04F8 00 00 00 00 
0072   04FC 00 00 00 00 
0072   0500 00 00 00 00 
0072   0504 00 00 00 00 
0072   0508 00 00 00 00 
0072   050C 00 00 00 00 
0072   0510 00 00 00 00 
0072   0514 00 00 00 00 
0072   0518 00 00 00 00 
0072   051C 00 00 00 00 
0072   0520 00 00 00 00 
0072   0524 00 00 00 00 
0072   0528 00 00 00 00 
0072   052C 00 00 00 00 
0072   0530 00 00 00 00 
0072   0534 00 00 00 00 
0072   0538 00 00 00 00 
0072   053C 00 00 00 00 
0072   0540 00 00 00 00 
0072   0544 00 00 00 00 
0072   0548 00 00 00 00 
0072   054C 00 00 00 00 
0072   0550 00 00 00 00 
0072   0554 00 00 00 00 
0072   0558 00 00 00 00 
0072   055C 00 00 00 00 
0072   0560 00 00 00 00 
0072   0564 00 00 00 00 
0072   0568 00 00 00 00 
0072   056C 00 00 00 00 
0072   0570 00 00 00 00 
0072   0574 00 00 00 00 
0072   0578 00 00 00 00 
0072   057C 00 00 00 00 
0072   0580 00 00 00 00 
0072   0584 00 00 00 00 
0072   0588 00 00 00 00 
0072   058C 00 00 00 00 
0072   0590 00 00 00 00 
0072   0594 00 00 00 00 
0072   0598 00 00 00 00 
0072   059C 00 00 00 00 
0072   05A0 00 00 00 00 
0072   05A4 00 00 00 00 
0072   05A8 00 00 00 00 
0072   05AC 00 00 00 00 
0072   05B0 00 00 00 00 
0072   05B4 00 00 00 00 
0072   05B8 00 00 00 00 
0072   05BC 00 00 00 00 
0072   05C0 00 00 00 00 
0072   05C4 00 00 00 00 
0072   05C8 00 00 00 00 
0072   05CC 00 00 00 00 
0072   05D0 00 00 00 00 
0072   05D4 00 00 00 00 
0072   05D8 00 00 00 00 
0072   05DC 00 00 00 00 
0072   05E0 00 00 00 00 
0072   05E4 00 00 00 00 
0072   05E8 00 00 00 00 
0072   05EC 00 00 00 00 
0072   05F0 00 00 00 00 
0072   05F4 00 00 00 00 
0072   05F8 00 00 00 00 
0072   05FC 00 00 00 00 
0072   0600 00 00 00 00 
0072   0604 00 00 00 00 
0072   0608 00 00 00 00 
0072   060C 00 00 00 00 
0072   0610 00 00 00 00 
0072   0614 00 00 00 00 
0072   0618 00 00 00 00 
0072   061C 00 00 00 00 
0072   0620 00 00 00 00 
0072   0624 00 00 00 00 
0072   0628 00 00 00 00 
0072   062C 00 00 00 00 
0072   0630 00 00 00 00 
0072   0634 00 00 00 00 
0072   0638 00 00 00 00 
0072   063C 00 00 00 00 
0072   0640 00 00 00 00 
0072   0644 00 00 00 00 
0072   0648 00 00 00 00 
0072   064C 00 00 00 00 
0072   0650 00 00 00 00 
0072   0654 00 00 00 00 
0072   0658 00 00 00 00 
0072   065C 00 00 00 00 
0072   0660 00 00 00 00 
0072   0664 00 00 00 00 
0072   0668 00 00 00 00 
0072   066C 00 00 00 00 
0072   0670 00 00 00 00 
0072   0674 00 00 00 00 
0072   0678 00 00 00 00 
0072   067C 00 00 00 00 
0072   0680 00 00 00 00 
0072   0684 00 00 00 00 
0072   0688 00 00 00 00 
0072   068C 00 00 00 00 
0072   0690 00 00 00 00 
0072   0694 00 00 00 00 
0072   0698 00 00 00 00 
0072   069C 00 00 00 00 
0072   06A0 00 00 00 00 
0072   06A4 00 00 00 00 
0072   06A8 00 00 00 00 
0072   06AC 00 00 00 00 
0072   06B0 00 00 00 00 
0072   06B4 00 00 00 00 
0072   06B8 00 00 00 00 
0072   06BC 00 00 00 00 
0072   06C0 00 00 00 00 
0072   06C4 00 00 00 00 
0072   06C8 00 00 00 00 
0072   06CC 00 00 00 00 
0072   06D0 00 00 00 00 
0072   06D4 00 00 00 00 
0072   06D8 00 00 00 00 
0072   06DC 00 00 00 00 
0072   06E0 00 00 00 00 
0072   06E4 00 00 00 00 
0072   06E8 00 00 00 00 
0072   06EC 00 00 00 00 
0072   06F0 00 00 00 00 
0072   06F4 00 00 00 00 
0072   06F8 00 00 00 00 
0072   06FC 00 00 00 00 
0072   0700 00 00 00 00 
0072   0704 00 00 00 00 
0072   0708 00 00 00 00 
0072   070C 00 00 00 00 
0072   0710 00 00 00 00 
0072   0714 00 00 00 00 
0072   0718 00 00 00 00 
0072   071C 00 00 00 00 
0072   0720 00 00 00 00 
0072   0724 00 00 00 00 
0072   0728 00 00 00 00 
0072   072C 00 00 00 00 
0072   0730 00 00 00 00 
0072   0734 00 00 00 00 
0072   0738 00 00 00 00 
0072   073C 00 00 00 00 
0072   0740 00 00 00 00 
0072   0744 00 00 00 00 
0072   0748 00 00 00 00 
0072   074C 00 00 00 00 
0072   0750 00 00 00 00 
0072   0754 00 00 00 00 
0072   0758 00 00 00 00 
0072   075C 00 00 00 00 
0072   0760 00 00 00 00 
0072   0764 00 00 00 00 
0072   0768 00 00 00 00 
0072   076C 00 00 00 00 
0072   0770 00 00 00 00 
0072   0774 00 00 00 00 
0072   0778 00 00 00 00 
0072   077C 00 00 00 00 
0072   0780 00 00 00 00 
0072   0784 00 00 00 00 
0072   0788 00 00 00 00 
0072   078C 00 00 00 00 
0072   0790 00 00 00 00 
0072   0794 00 00 00 00 
0072   0798 00 00 00 00 
0072   079C 00 00 00 00 
0072   07A0 00 00 00 00 
0072   07A4 00 00 00 00 
0072   07A8 00 00 00 00 
0072   07AC 00 00 00 00 
0072   07B0 00 00 00 00 
0072   07B4 00 00 00 00 
0072   07B8 00 00 00 00 
0072   07BC 00 00 00 00 
0072   07C0 00 00 00 00 
0072   07C4 00 00 00 00 
0072   07C8 00 00 00 00 
0072   07CC 00 00 00 00 
0072   07D0 00 00 00 00 
0072   07D4 00 00 00 00 
0072   07D8 00 00 00 00 
0072   07DC 00 00 00 00 
0072   07E0 00 00 00 00 
0072   07E4 00 00 00 00 
0072   07E8 00 00 00 00 
0072   07EC 00 00 00 00 
0072   07F0 00 00 00 00 
0072   07F4 00 00 00 00 
0072   07F8 00 00 00 00 
0072   07FC 00 00 00 00 
0073   0000             			.ORG	$0000
0074   0000 C3 F2 03    RESET_00:	JP		SETUP
0075   0003             ;
0076   0008             			.ORG	$0008
0077   0008 C3 F2 03    RESET_08:	JP		SETUP
0078   000B             ;
0079   0010             			.ORG	$0010
0080   0010 C3 F2 03    RESET_10:	JP		SETUP
0081   0013             ;
0082   0018             			.ORG	$0018
0083   0018 C3 F2 03    RESET_18:	JP		SETUP
0084   001B             ;
0085   0020             			.ORG	$0020
0086   0020 C3 F2 03    RESET_20:	JP		SETUP
0087   0023             ;
0088   0028             			.ORG	$0028
0089   0028 C3 F2 03    RESET_28:	JP		SETUP
0090   002B             ;
0091   0030             			.ORG	$0030
0092   0030 C3 F2 03    RESET_30:	JP		SETUP
0093   0033             ;
0094   0038             			.ORG	$0038
0095   0038 C3 F2 03    RESET_38:	JP		SETUP
0096   003B             ;
0097   0040             			.ORG	$0040
0098   0040 75 4D 4F 4E VERSION:	.TEXT	"uMON V1.04 by Scott Gregory"
0098   0044 20 56 31 2E 
0098   0048 30 34 20 62 
0098   004C 79 20 53 63 
0098   0050 6F 74 74 20 
0098   0054 47 72 65 67 
0098   0058 6F 72 79 
0099   005B             ;
0100   0066             			.ORG	$0066
0101   0066 F5          NMISERVICE:	PUSH	af ; Keyboard service routine.
0102   0067 DB 00       			IN		a,(KEYPORT)
0103   0069 32 C6 08    			LD		(KEYDATA),a
0104   006C F1          			POP		af
0105   006D ED 45       			RETN
0106   006F             ;
0107   0080             			.ORG	$0080
0108   0080 AF          DISPLAY:	XOR		a ; Display update routine.
0109   0081 D3 01       			OUT		(CATHPORT),a
0110   0083 D3 02       			OUT		(SEGPORT),a
0111   0085 4F          			LD		c,a
0112   0086 CB E9       			SET		5,c
0113   0088 ED 5B C1 08 			LD		de,(ADDRESS)
0114   008C 7A          			LD		a,d
0115   008D 32 C3 08    			LD		(SCRATCH),a
0116   0090 AF          			XOR		a
0117   0091 21 C3 08    			LD		hl,SCRATCH
0118   0094 ED 6F       			RLD
0119   0096 DD 21 10 04 			LD		ix,HEX2SEG
0120   009A 16 00       			LD		d,$00
0121   009C 5F          			LD		e,a
0122   009D DD 19       			ADD		ix,de
0123   009F DD 7E 00    			LD		a,(ix)
0124   00A2 E5          			PUSH	hl
0125   00A3 21 C5 08    			LD		hl,MODE
0126   00A6 CB 46       			BIT		0,(hl)
0127   00A8 CA AD 00    			JP		z,DISL00
0128   00AB F6 10       			OR		$10
0129   00AD E1          DISL00:		POP		hl
0130   00AE D3 02       			OUT		(SEGPORT),a
0131   00B0 79          			LD		a,c
0132   00B1 D3 01       			OUT		(CATHPORT),a
0133   00B3 06 40       			LD		b,CATHDLY
0134   00B5 10 FE       DISL01:		DJNZ	DISL01
0135   00B7 AF          			XOR		a
0136   00B8 D3 01       			OUT		(CATHPORT),a
0137   00BA CB 19       			RR		c
0138   00BC ED 6F       			RLD
0139   00BE DD 21 10 04 			LD		ix,HEX2SEG
0140   00C2 16 00       			LD		d,$00
0141   00C4 5F          			LD		e,a
0142   00C5 DD 19       			ADD		ix,de
0143   00C7 DD 7E 00    			LD		a,(ix)
0144   00CA E5          			PUSH	hl
0145   00CB 21 C5 08    			LD		hl,MODE
0146   00CE CB 46       			BIT		0,(hl)
0147   00D0 CA D5 00    			JP		z,DISL02
0148   00D3 F6 10       			OR		$10
0149   00D5 E1          DISL02:		POP		hl
0150   00D6 D3 02       			OUT		(SEGPORT),a
0151   00D8 79          			LD		a,c
0152   00D9 D3 01       			OUT		(CATHPORT),a
0153   00DB 06 40       			LD		b,CATHDLY
0154   00DD 10 FE       DISL03:		DJNZ	DISL03
0155   00DF AF          			XOR		a
0156   00E0 D3 01       			OUT		(CATHPORT),a
0157   00E2 CB 19       			RR		c
0158   00E4 ED 5B C1 08 			LD		de,(ADDRESS)
0159   00E8 7B          			LD		a,e
0160   00E9 32 C3 08    			LD		(SCRATCH),a
0161   00EC AF          			XOR		a
0162   00ED 21 C3 08    			LD		hl,SCRATCH
0163   00F0 ED 6F       			RLD
0164   00F2 DD 21 10 04 			LD		ix,HEX2SEG
0165   00F6 16 00       			LD		d,$00
0166   00F8 5F          			LD		e,a
0167   00F9 DD 19       			ADD		ix,de
0168   00FB DD 7E 00    			LD		a,(ix)
0169   00FE E5          			PUSH	hl
0170   00FF 21 C5 08    			LD		hl,MODE
0171   0102 CB 46       			BIT		0,(hl)
0172   0104 CA 09 01    			JP		z,DISL04
0173   0107 F6 10       			OR		$10
0174   0109 E1          DISL04:		POP		hl
0175   010A D3 02       			OUT		(SEGPORT),a
0176   010C 79          			LD		a,c
0177   010D D3 01       			OUT		(CATHPORT),a
0178   010F 06 40       			LD			b,CATHDLY
0179   0111 10 FE       DISL05:		DJNZ	DISL05
0180   0113 AF          			XOR		a
0181   0114 D3 01       			OUT		(CATHPORT),a
0182   0116 CB 19       			RR		c
0183   0118 ED 6F       			RLD
0184   011A DD 21 10 04 			LD		ix,HEX2SEG
0185   011E 16 00       			LD		d,$00
0186   0120 5F          			LD		e,a
0187   0121 DD 19       			ADD		ix,de
0188   0123 DD 7E 00    			LD		a,(ix)
0189   0126 E5          			PUSH	hl
0190   0127 21 C5 08    			LD		hl,MODE
0191   012A CB 46       			BIT		0,(hl)
0192   012C CA 31 01    			JP		z,DISL06
0193   012F F6 10       			OR		$10
0194   0131 E1          DISL06:		POP		hl
0195   0132 D3 02       			OUT		(SEGPORT),a
0196   0134 79          			LD		a,c
0197   0135 D3 01       			OUT		(CATHPORT),a
0198   0137 06 40       			LD		b,CATHDLY
0199   0139 10 FE       DISL07:		DJNZ	DISL07
0200   013B AF          			XOR		a
0201   013C D3 01       			OUT		(CATHPORT),a
0202   013E CB 19       			RR		c
0203   0140 2A C1 08    			LD		hl,(ADDRESS)
0204   0143 7E          			LD		a,(hl)
0205   0144 32 C3 08    			LD		(SCRATCH),a
0206   0147 AF          			XOR		a
0207   0148 21 C3 08    			LD		hl,SCRATCH
0208   014B ED 6F       			RLD
0209   014D DD 21 10 04 			LD		ix,HEX2SEG
0210   0151 16 00       			LD		d,$00
0211   0153 5F          			LD		e,a
0212   0154 DD 19       			ADD		ix,de
0213   0156 DD 7E 00    			LD		a,(ix)
0214   0159 E5          			PUSH	hl
0215   015A 21 C5 08    			LD		hl,MODE
0216   015D CB 46       			BIT		0,(hl)
0217   015F C2 64 01    			JP		nz,DISL08
0218   0162 F6 10       			OR		$10
0219   0164 E1          DISL08:		POP		hl
0220   0165 D3 02       			OUT		(SEGPORT),a
0221   0167 79          			LD		a,c
0222   0168 D3 01       			OUT		(CATHPORT),a
0223   016A 06 40       			LD		b,CATHDLY
0224   016C 10 FE       DISL09:		DJNZ	DISL09
0225   016E AF          			XOR		a
0226   016F D3 01       			OUT		(CATHPORT),a
0227   0171 CB 19       			RR		c
0228   0173 ED 6F       			RLD
0229   0175 DD 21 10 04 			LD		ix,HEX2SEG
0230   0179 16 00       			LD		d,$00
0231   017B 5F          			LD		e,a
0232   017C DD 19       			ADD		ix,de
0233   017E DD 7E 00    			LD		a,(ix)
0234   0181 E5          			PUSH	hl
0235   0182 21 C5 08    			LD		hl,MODE
0236   0185 CB 46       			BIT		0,(hl)
0237   0187 C2 8C 01    			JP		nz,DISL0A
0238   018A F6 10       			OR		$10
0239   018C E1          DISL0A:		POP		hl
0240   018D D3 02       			OUT		(SEGPORT),a
0241   018F 79          			LD		a,c
0242   0190 D3 01       			OUT		(CATHPORT),a
0243   0192 06 40       			LD		b,CATHDLY
0244   0194 10 FE       DISL0B:		DJNZ	DISL0B
0245   0196 C9          			RET
0246   0197             ;
0247   0197 E5          KEYBOARD:	PUSH	hl ; Key decoder routine.
0248   0198 F5          			PUSH	af
0249   0199 21 30 00    			LD		hl,$0030
0250   019C 22 C7 08    			LD		(BEEPLENGTH),hl
0251   019F 21 C9 08    			LD		hl,BEEPFREQ
0252   01A2 36 30       			LD		(hl),$30
0253   01A4 21 C6 08    			LD		hl,KEYDATA
0254   01A7 3E FF       			LD		a,$FF
0255   01A9 BE          			CP		(hl)
0256   01AA CA AB 03    			JP		z,KEYLXX
0257   01AD CD B3 03    			CALL	BEEP
0258   01B0 7E          			LD		a,(hl)
0259   01B1 E6 3F       			AND		$3f ; We only want the first 6 bits.
0260   01B3 EE 20       			XOR		$20 ; Flip bit 6 (Shift key) because it gives a 1 when not being pressed.
0261   01B5             ;
0262   01B5 FE 10       			CP		$10 ; + key.
0263   01B7 C2 CD 01    			JP		nz,KEYL00
0264   01BA 2A C1 08    			LD		hl,(ADDRESS)
0265   01BD 23          			INC		hl
0266   01BE 22 C1 08    			LD		(ADDRESS),hl
0267   01C1 21 C5 08    			LD		hl,MODE
0268   01C4 CB 86       			RES		0,(hl)
0269   01C6 CB 8E       			RES		1,(hl)
0270   01C8 CB 96       			RES		2,(hl)
0271   01CA C3 AB 03    			JP		KEYLXX
0272   01CD             ;
0273   01CD FE 11       KEYL00:		CP		$11 ; - key.
0274   01CF C2 E5 01    			JP		nz,KEYL01
0275   01D2 2A C1 08    			LD		hl,(ADDRESS)
0276   01D5 2B          			DEC		hl
0277   01D6 22 C1 08    			LD		(ADDRESS),hl
0278   01D9 21 C5 08    			LD		hl,MODE
0279   01DC CB 86       			RES		0,(hl)
0280   01DE CB 8E       			RES		1,(hl)
0281   01E0 CB 96       			RES		2,(hl)
0282   01E2 C3 AB 03    			JP		KEYLXX
0283   01E5             ;
0284   01E5 FE 12       KEYL01:		CP		$12 ; GO key.
0285   01E7 C2 F1 01    			JP		nz,KEYL02
0286   01EA 31 C0 08    			LD		sp,STACKTOP
0287   01ED 2A C1 08    			LD		hl,(ADDRESS)
0288   01F0 E9          			JP		(hl)
0289   01F1             ;
0290   01F1 FE 13       KEYL02:		CP		$13 ; AD key.
0291   01F3 C2 07 02    			JP		nz,KEYL03
0292   01F6 47          			LD		b,a
0293   01F7 3A C5 08    			LD		a,(MODE)
0294   01FA EE 01       			XOR		$01
0295   01FC CB 8F       			RES		1,a
0296   01FE CB 97       			RES		2,a
0297   0200 32 C5 08    			LD		(MODE),a
0298   0203 78          			LD		a,b
0299   0204 C3 AB 03    			JP		KEYLXX
0300   0207             ;
0301   0207 FE 20       KEYL03:		CP		$20 ; Shift-0 key - MOD-01: RAMTest
0302   0209 C2 16 02    			JP		nz,KEYL04
0303   020C F5          			PUSH	af
0304   020D E5          			PUSH	hl
0305   020E CD 20 04    			CALL	MOD01
0306   0211 E1          			POP		hl
0307   0212 F1          			POP		af
0308   0213 C3 AB 03    			JP		KEYLXX
0309   0216             ;
0310   0216 FE 21       KEYL04:		CP		$21 ; Shift-1 key - MOD-02: Serial Send
0311   0218 C2 25 02    			JP		nz,KEYL05
0312   021B F5          			PUSH	af
0313   021C E5          			PUSH	hl
0314   021D CD 74 04    			CALL	MOD02
0315   0220 E1          			POP		hl
0316   0221 F1          			POP		af
0317   0222 C3 AB 03    			JP		KEYLXX
0318   0225             ;
0319   0225 FE 22       KEYL05:		CP		$22 ; Shift-2 key - MOD-03: Serial Receive
0320   0227 C2 34 02    			JP		nz,KEYL06
0321   022A F5          			PUSH	af
0322   022B E5          			PUSH	hl
0323   022C CD 95 04    			CALL	MOD03
0324   022F E1          			POP		hl
0325   0230 F1          			POP		af
0326   0231 C3 AB 03    			JP		KEYLXX
0327   0234             ;
0328   0234 FE 23       KEYL06:		CP		$23 ; Shift-3 key - MOD-04: RAM Copy
0329   0236 C2 43 02    			JP		nz,KEYL07
0330   0239 F5          			PUSH	af
0331   023A E5          			PUSH	hl
0332   023B CD B6 04    			CALL	MOD04
0333   023E E1          			POP		hl
0334   023F F1          			POP		af
0335   0240 C3 AB 03    			JP		KEYLXX
0336   0243             ;
0337   0243 FE 24       KEYL07:		CP		$24 ; Shift-4 key.
0338   0245 C2 52 02    			JP		nz,KEYL08
0339   0248 F5          			PUSH	af
0340   0249 E5          			PUSH	hl
0341   024A CD C4 04    			CALL	MOD05
0342   024D E1          			POP		hl
0343   024E F1          			POP		af
0344   024F C3 AB 03    			JP		KEYLXX
0345   0252             ;
0346   0252 FE 25       KEYL08:		CP		$25 ; Shift-5 key.
0347   0254 C2 61 02    			JP		nz,KEYL09
0348   0257 F5          			PUSH	af
0349   0258 E5          			PUSH	hl
0350   0259 CD C5 04    			CALL	MOD06
0351   025C E1          			POP		hl
0352   025D F1          			POP		af
0353   025E C3 AB 03    			JP		KEYLXX
0354   0261             ;
0355   0261 FE 26       KEYL09:		CP		$26 ; Shift-6 key.
0356   0263 C2 70 02    			JP		nz,KEYL0A
0357   0266 F5          			PUSH	af
0358   0267 E5          			PUSH	hl
0359   0268 CD C6 04    			CALL	MOD07
0360   026B E1          			POP		hl
0361   026C F1          			POP		af
0362   026D C3 AB 03    			JP		KEYLXX
0363   0270             ;
0364   0270 FE 27       KEYL0A:		CP		$27 ; Shift-7 key.
0365   0272 C2 7F 02    			JP		nz,KEYL0B
0366   0275 F5          			PUSH	af
0367   0276 E5          			PUSH	hl
0368   0277 CD C7 04    			CALL	MOD08
0369   027A E1          			POP		hl
0370   027B F1          			POP		af
0371   027C C3 AB 03    			JP		KEYLXX
0372   027F             ;
0373   027F FE 28       KEYL0B:		CP		$28 ; Shift-8 key.
0374   0281 C2 8E 02    			JP		nz,KEYL0C
0375   0284 F5          			PUSH	af
0376   0285 E5          			PUSH	hl
0377   0286 CD C8 04    			CALL	MOD09
0378   0289 E1          			POP		hl
0379   028A F1          			POP		af
0380   028B C3 AB 03    			JP		KEYLXX
0381   028E             ;
0382   028E FE 29       KEYL0C:		CP		$29 ; Shift-9 key.
0383   0290 C2 9D 02    			JP		nz,KEYL0D
0384   0293 F5          			PUSH	af
0385   0294 E5          			PUSH	hl
0386   0295 CD C9 04    			CALL	MOD0A
0387   0298 E1          			POP		hl
0388   0299 F1          			POP		af
0389   029A C3 AB 03    			JP		KEYLXX
0390   029D             ;
0391   029D FE 2A       KEYL0D:		CP		$2A ; Shift-A key.
0392   029F C2 AC 02    			JP		nz,KEYL0E
0393   02A2 F5          			PUSH	af
0394   02A3 E5          			PUSH	hl
0395   02A4 CD CA 04    			CALL	MOD0B
0396   02A7 E1          			POP		hl
0397   02A8 F1          			POP		af
0398   02A9 C3 AB 03    			JP		KEYLXX
0399   02AC             ;
0400   02AC FE 2B       KEYL0E:		CP		$2B ; Shift-B key.
0401   02AE C2 BB 02    			JP		nz,KEYL0F
0402   02B1 F5          			PUSH	af
0403   02B2 E5          			PUSH	hl
0404   02B3 CD CB 04    			CALL	MOD0C
0405   02B6 E1          			POP		hl
0406   02B7 F1          			POP		af
0407   02B8 C3 AB 03    			JP		KEYLXX
0408   02BB             ;
0409   02BB FE 2C       KEYL0F:		CP		$2C ; Shift-C key.
0410   02BD C2 CA 02    			JP		nz,KEYL10
0411   02C0 F5          			PUSH	af
0412   02C1 E5          			PUSH	hl
0413   02C2 CD CC 04    			CALL	MOD0D
0414   02C5 E1          			POP		hl
0415   02C6 F1          			POP		af
0416   02C7 C3 AB 03    			JP		KEYLXX
0417   02CA             ;
0418   02CA FE 2D       KEYL10:		CP		$2D ; Shift-D key.
0419   02CC C2 D9 02    			JP		nz,KEYL11
0420   02CF F5          			PUSH	af
0421   02D0 E5          			PUSH	hl
0422   02D1 CD CD 04    			CALL	MOD0E
0423   02D4 E1          			POP		hl
0424   02D5 F1          			POP		af
0425   02D6 C3 AB 03    			JP		KEYLXX
0426   02D9             ;
0427   02D9 FE 2E       KEYL11:		CP		$2E ; Shift-E key.
0428   02DB C2 E8 02    			JP		nz,KEYL12
0429   02DE F5          			PUSH	af
0430   02DF E5          			PUSH	hl
0431   02E0 CD CE 04    			CALL	MOD0F
0432   02E3 E1          			POP		hl
0433   02E4 F1          			POP		af
0434   02E5 C3 AB 03    			JP		KEYLXX
0435   02E8             ;
0436   02E8 FE 2F       KEYL12:		CP		$2F ; Shift-F key - MOD-10: Serial Echo
0437   02EA C2 F7 02    			JP		nz,KEYL13
0438   02ED F5          			PUSH	af
0439   02EE E5          			PUSH	hl
0440   02EF CD CF 04    			CALL	MOD10
0441   02F2 E1          			POP		hl
0442   02F3 F1          			POP		af
0443   02F4 C3 AB 03    			JP		KEYLXX
0444   02F7             ;
0445   02F7 FE 30       KEYL13:		CP		$30 ; Shift-+ key.
0446   02F9 C2 1D 03    			JP		nz,KEYL14
0447   02FC 21 FF FF    			LD		hl,RAMTOP
0448   02FF ED 5B C1 08 			LD		de,(ADDRESS)
0449   0303 ED 52       			SBC		hl,de
0450   0305 44          			LD		b,h
0451   0306 4D          			LD		c,l
0452   0307 21 FF FF    			LD		hl,RAMTOP
0453   030A 54          			LD		d,h
0454   030B 5D          			LD		e,l
0455   030C 2B          			DEC		hl
0456   030D ED B8       			LDDR
0457   030F 62          			LD		h,d
0458   0310 6B          			LD		l,e
0459   0311 36 00       			LD		(hl),$00
0460   0313 21 C5 08    			LD		hl,MODE
0461   0316 CB 8E       			RES		1,(hl)
0462   0318 CB 96       			RES		2,(hl)
0463   031A C3 AB 03    			JP		KEYLXX
0464   031D             ;
0465   031D FE 31       KEYL14:		CP		$31 ; Shift-- key.
0466   031F C2 43 03    			JP		nz,KEYL15
0467   0322 21 FF FF    			LD		hl,RAMTOP
0468   0325 ED 5B C1 08 			LD		de,(ADDRESS)
0469   0329 ED 52       			SBC		hl,de
0470   032B 44          			LD		b,h
0471   032C 4D          			LD		c,l
0472   032D 2A C1 08    			LD		hl,(ADDRESS)
0473   0330 54          			LD		d,h
0474   0331 5D          			LD		e,l
0475   0332 23          			INC		hl
0476   0333 ED B0       			LDIR
0477   0335 62          			LD		h,d
0478   0336 6B          			LD		l,e
0479   0337 36 00       			LD		(hl),$00
0480   0339 21 C5 08    			LD		hl,MODE
0481   033C CB 8E       			RES		1,(hl)
0482   033E CB 96       			RES		2,(hl)
0483   0340 C3 AB 03    			JP		KEYLXX
0484   0343             ;
0485   0343 FE 32       KEYL15:		CP		$32 ; Shift-GO key.
0486   0345 CA AB 03    			JP		z,KEYLXX
0487   0348 FE 33       KEYL16:		CP		$33 ; Shift-AD key.
0488   034A CA AB 03    			JP		z,KEYLXX
0489   034D             ;
0490   034D 21 C5 08    KEYL17:		LD		hl,MODE ; Non-shifted digit keys entry.
0491   0350 CB 46       			BIT		0,(hl) ; 0 = Data Mode, 1 = Address Mode.
0492   0352 C2 86 03    			JP		nz,KEYL19
0493   0355 CB 4E       			BIT		1,(hl)
0494   0357 CA 72 03    			JP		z,KEYL17B ; Jump on 1st time through a data edit.
0495   035A CB 56       			BIT		2,(hl)
0496   035C CA 70 03    			JP		z,KEYL17A ; Jump on 2nd time through a data edit.
0497   035F CB 8E       			RES		1,(hl) ; Do this the 3rd time round a data edit.
0498   0361 CB 96       			RES		2,(hl)
0499   0363 2A C1 08    			LD		hl,(ADDRESS)
0500   0366 23          			INC		hl
0501   0367 22 C1 08    			LD		(ADDRESS),hl
0502   036A 21 C5 08    			LD		hl,MODE
0503   036D C3 72 03    			JP		KEYL17B
0504   0370 CB D6       KEYL17A:	SET		2,(hl)
0505   0372 CB 4E       KEYL17B:	BIT		1,(hl) ; 0 = first nibble, 1 = second nibble.
0506   0374 C2 7E 03    			JP		nz,KEYL18
0507   0377 CB CE       			SET		1,(hl)
0508   0379 2A C1 08    			LD		hl,(ADDRESS)
0509   037C 36 00       			LD		(hl),$00
0510   037E             ;
0511   037E 2A C1 08    KEYL18:		LD		hl,(ADDRESS)
0512   0381 ED 6F       			RLD
0513   0383 C3 AB 03    KEYL18A:	JP		KEYLXX
0514   0386             ;
0515   0386 CB 4E       KEYL19:		BIT		1,(hl) ; 0 = first nibble, 1 = subsequent nibbles.
0516   0388 C2 93 03    			JP		nz,KEYL1A
0517   038B CB CE       			SET		1,(hl)
0518   038D 21 00 00    			LD		hl,$0000
0519   0390 22 C1 08    			LD		(ADDRESS),hl
0520   0393             ;
0521   0393 21 C1 08    KEYL1A:		LD		hl,ADDRESS
0522   0396 ED 6F       			RLD
0523   0398 2A C1 08    			LD		hl,(ADDRESS)
0524   039B CB 24       			SLA		h
0525   039D CB 24       			SLA		h
0526   039F CB 24       			SLA		h
0527   03A1 CB 24       			SLA		h
0528   03A3 47          			LD		b,a
0529   03A4 AF          			XOR		a
0530   03A5 B4          			OR		h
0531   03A6 B0          			OR		b
0532   03A7 67          			LD		h,a
0533   03A8 22 C1 08    			LD		(ADDRESS),hl
0534   03AB             ;
0535   03AB 21 C6 08    KEYLXX:		LD		hl,KEYDATA ; Done with the key decoder.
0536   03AE 36 FF       			LD		(hl),$FF
0537   03B0 F1          			POP		af
0538   03B1 E1          			POP		hl
0539   03B2 C9          			RET
0540   03B3             ;
0541   03B3 E5          BEEP:		PUSH	hl
0542   03B4 F5          			PUSH	af
0543   03B5 21 C9 08    			LD		hl,BEEPFREQ
0544   03B8 4E          			LD		c,(hl)
0545   03B9 2A C7 08    			LD		hl,(BEEPLENGTH)
0546   03BC AF          			XOR		a
0547   03BD 57          			LD		d,a
0548   03BE 41          BEEPL01:	LD		b,c
0549   03BF 7A          			LD		a,d
0550   03C0 D3 01       			OUT		(CATHPORT),a
0551   03C2 10 FE       BEEPL02:	DJNZ	BEEPL02
0552   03C4 EE 80       			XOR		$80
0553   03C6 2B          			DEC		hl
0554   03C7 57          			LD		d,a
0555   03C8 7C          			LD		a,h
0556   03C9 B5          			OR		l
0557   03CA C2 BE 03    			JP		nz,BEEPL01
0558   03CD F1          			POP		af
0559   03CE E1          			POP		hl
0560   03CF C9          			RET
0561   03D0             ;
0562   03D0 E5          STARTBEEP:	PUSH	hl
0563   03D1 F5          			PUSH	af
0564   03D2 21 7F 00    			LD		hl,$007F
0565   03D5 22 C7 08    			LD		(BEEPLENGTH),hl
0566   03D8 21 C9 08    			LD		hl,BEEPFREQ
0567   03DB 36 35       			LD		(hl),$35
0568   03DD CD B3 03    			CALL	BEEP
0569   03E0 36 30       			LD		(hl),$30
0570   03E2 CD B3 03    			CALL	BEEP
0571   03E5 36 25       			LD		(hl),$25
0572   03E7 CD B3 03    			CALL	BEEP
0573   03EA 36 20       			LD		(hl),$20
0574   03EC CD B3 03    			CALL	BEEP
0575   03EF F1          			POP		af
0576   03F0 E1          			POP		hl
0577   03F1 C9          			RET
0578   03F2             ;			
0579   03F2 31 C0 08    SETUP:		LD		sp,STACKTOP ; Post reset/power up setup.
0580   03F5 21 00 09    			LD		hl,RAMBASE
0581   03F8 22 C1 08    			LD		(ADDRESS),hl
0582   03FB AF          			XOR		a
0583   03FC 32 C5 08    			LD		(MODE),a
0584   03FF 3E FF       			LD		a,$FF
0585   0401 32 C6 08    			LD		(KEYDATA),a
0586   0404 CD D0 03    			CALL	STARTBEEP
0587   0407             ;
0588   0407 CD 80 00    MAIN:		CALL	DISPLAY
0589   040A CD 97 01    			CALL	KEYBOARD
0590   040D C3 07 04    			JP		MAIN
0591   0410             ;
0592   0410 EB 28 CD AD HEX2SEG:	.DB		$EB,$28,$CD,$AD,$2E,$A7,$E7,$29 ; HEX Byte to LED Segment conversion.
0592   0414 2E A7 E7 29 
0593   0418 EF 2F 6F E6 			.DB		$EF,$2F,$6F,$E6,$C3,$EC,$C7,$47
0593   041C C3 EC C7 47 
0594   0420             ;
0595   0420             ; BEGIN MODULES.
0596   0420             ; START MOD-01 - Memory Test
0597   0420 2A F2 08    MOD01:		LD		hl,(M01FINISH)
0598   0423 23          			INC		hl
0599   0424 ED 5B F0 08 			LD		de,(M01START)
0600   0428 AF          			XOR		a
0601   0429 ED 52       			SBC		hl,de
0602   042B 44          			LD		b,h
0603   042C 4D          			LD		c,l
0604   042D ED 43 F2 08 			LD		(M01FINISH),bc
0605   0431 2A F0 08    			LD		hl,(M01START)
0606   0434 ED 5B F4 08 			LD		de,(M01PATTERN)
0607   0438 D9          			EXX
0608   0439 2A F0 08    			LD		hl,(M01START)
0609   043C ED 4B F2 08 			LD		bc,(M01FINISH)
0610   0440 ED 5B F4 08 			LD		de,(M01PATTERN)
0611   0444             ;
0612   0444 72          M01LDBLK:	LD		(hl),d
0613   0445 23          			INC		hl
0614   0446 0B          			DEC		bc
0615   0447 78          			LD		a,b
0616   0448 B1          			OR		c
0617   0449 C2 44 04    			JP		nz,M01LDBLK
0618   044C 11 00 00    			LD		de,$0000
0619   044F             ;
0620   044F 1B          M01DELAY:	DEC		de
0621   0450 7A          			LD		a,d
0622   0451 B3          			OR		e
0623   0452 C2 4F 04    			JP		nz,M01DELAY
0624   0455 11 00 00    			LD		de,$0000
0625   0458 D9          			EXX
0626   0459             ;
0627   0459 C3 62 04    M01TSTBLK:	JP		M01TEST01
0628   045C D9          M01TEST00:	EXX
0629   045D 13          			INC		de
0630   045E D9          			EXX
0631   045F C3 67 04    			JP		M01TEST02
0632   0462 7E          M01TEST01:	LD		a,(hl)
0633   0463 BA          			CP		d
0634   0464 C2 5C 04    			JP		nz,M01TEST00
0635   0467 23          M01TEST02:	INC		hl
0636   0468 0B          			DEC		bc
0637   0469 78          			LD		a,b
0638   046A B1          			OR		c
0639   046B C2 62 04    			JP		nz,M01TEST01
0640   046E             ;
0641   046E D9          M01STORE:	EXX
0642   046F ED 53 F0 08 			LD		(M01START),de
0643   0473 C9          			RET
0644   0474             ; END MOD-01
0645   0474             ;
0646   0474             ; START MOD-02 - Serial Send
0647   0474 DB 06       MOD02:		IN		a,(SERBUFFER)
0648   0476 2A F8 08    			LD		hl,(SEREND)
0649   0479 ED 5B F6 08 			LD		de,(SERSTART)
0650   047D ED 52       			SBC		hl,de
0651   047F EB          			EX		de,hl
0652   0480 3E 06       			LD		a,SERBUFFER
0653   0482 4F          			LD		c,a
0654   0483 43          			LD		b,e
0655   0484             ;
0656   0484 DB 07       M02MAIN:	IN		a,(SERSTATUS)
0657   0486 CB 47       			BIT		0,a
0658   0488 C2 84 04    			JP		nz,M02MAIN
0659   048B ED A3       			OUTI
0660   048D 7A          			LD		a,d
0661   048E B3          			OR		e
0662   048F C8          			RET		z
0663   0490 1B          			DEC		de
0664   0491 43          			LD		b,e
0665   0492 C3 84 04    			JP		M02MAIN
0666   0495             
0667   0495             ; END MOD-02
0668   0495             ;
0669   0495             ; START MOD-03 - Serial Receive
0670   0495 DB 06       MOD03:		IN		a,(SERBUFFER)
0671   0497 2A F8 08    			LD		hl,(SEREND)
0672   049A ED 5B F6 08 			LD		de,(SERSTART)
0673   049E ED 52       			SBC		hl,de
0674   04A0 EB          			EX		de,hl
0675   04A1 3E 06       			LD		a,SERBUFFER
0676   04A3 4F          			LD		c,a
0677   04A4 43          			LD		b,e
0678   04A5             ;
0679   04A5 DB 07       M03MAIN:	IN		a,(SERSTATUS)
0680   04A7 CB 4F       			BIT		1,a
0681   04A9 CA A5 04    			JP		z,M03MAIN
0682   04AC ED A2       			INI
0683   04AE 7A          			LD		a,d
0684   04AF B3          			OR		e
0685   04B0 C8          			RET		z
0686   04B1 1B          			DEC		de
0687   04B2 43          			LD		b,e
0688   04B3 C3 A5 04    			JP		M03MAIN
0689   04B6             ; END MOD-03
0690   04B6             ;
0691   04B6             ; START MOD-04 - RAM Copy
0692   04B6 2A E0 08    MOD04:		LD		hl,(SRCRAM)
0693   04B9 ED 5B E2 08 			LD		de,(DESTRAM)
0694   04BD ED 4B E4 08 			LD		bc,(BLKSIZE)
0695   04C1 ED B0       			LDIR
0696   04C3 C9          			RET
0697   04C4             ; END MOD-04
0698   04C4             ;
0699   04C4             ; START MOD-05 - xxxxx.
0700   04C4 C9          MOD05:		RET
0701   04C5             ; END MOD-05
0702   04C5             ;
0703   04C5             ; START MOD-06 - xxxxx.
0704   04C5 C9          MOD06:		RET
0705   04C6             ; END MOD-06
0706   04C6             ;
0707   04C6             ; START MOD-07 - xxxxx.
0708   04C6 C9          MOD07:		RET
0709   04C7             ; END MOD-07
0710   04C7             ;
0711   04C7             ; START MOD-08 - xxxxx.
0712   04C7 C9          MOD08:		RET
0713   04C8             ; END MOD-08
0714   04C8             ;
0715   04C8             ; START MOD-09 - xxxxx.
0716   04C8 C9          MOD09:		RET
0717   04C9             ; END MOD-09
0718   04C9             ;
0719   04C9             ; START MOD-0A - xxxxx.
0720   04C9 C9          MOD0A:		RET
0721   04CA             ; END MOD-0A
0722   04CA             ;
0723   04CA             ; START MOD-0B - xxxxx.
0724   04CA C9          MOD0B:		RET
0725   04CB             ; END MOD-0B
0726   04CB             ;
0727   04CB             ; START MOD-0C - xxxxx.
0728   04CB C9          MOD0C:		RET
0729   04CC             ; END MOD-0C
0730   04CC             ;
0731   04CC             ; START MOD-0D - xxxxx.
0732   04CC C9          MOD0D:		RET
0733   04CD             ; END MOD-0D
0734   04CD             ;
0735   04CD             ; START MOD-0E - xxxxx.
0736   04CD C9          MOD0E:		RET
0737   04CE             ; END MOD-0E
0738   04CE             ;
0739   04CE             ; START MOD-0F - xxxxx.
0740   04CE C9          MOD0F:		RET
0741   04CF             ; END MOD-0F
0742   04CF             ;
0743   04CF             ; START MOD-10 - Serial Echo
0744   04CF DB 07       MOD10:		IN		a,(SERSTATUS)
0745   04D1 CB 4F       			BIT		1,a
0746   04D3 C4 D9 04    			CALL	nz,M10RCV ; Have we received data?
0747   04D6 C3 CF 04    			JP		MOD10
0748   04D9             
0749   04D9 DB 06       M10RCV:		IN		a,(SERBUFFER)
0750   04DB 47          			LD		b,a
0751   04DC CD E0 04    			CALL	M10XMIT
0752   04DF C9          			RET
0753   04E0             
0754   04E0 DB 07       M10XMIT:	IN		a,(SERSTATUS)
0755   04E2 CB 47       			BIT		0,a
0756   04E4 C2 E0 04    			JP		nz,M10XMIT
0757   04E7 78          			LD		a,b
0758   04E8 D3 06       			OUT		(SERBUFFER),a
0759   04EA AF          			XOR		a
0760   04EB C9          			RET
0761   04EC             ; END MOD-10
0762   04EC             ;
0763   04EC             ; END MODULES.
0764   04EC             ;
0765   04EC             			.END
tasm: Number of errors = 0
