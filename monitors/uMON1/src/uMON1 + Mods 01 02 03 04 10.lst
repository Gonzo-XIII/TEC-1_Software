0001   0000             ; ######################################
0002   0000             ; #                                    #
0003   0000             ; #         uMON1 Version 1.03         #
0004   0000             ; #  --------------------------------  #
0005   0000             ; #   Special Key Sequences            #
0006   0000             ; #  --------------------------------  #
0007   0000             ; #   Shift-+ - Insert byte.           #
0008   0000             ; #   Shift-- - Delete byte.           #
0009   0000             ; #                                    #
0010   0000             ; #  --------------------------------  #
0011   0000             ; #   Included Modules                 #
0012   0000             ; #  --------------------------------  #
0013   0000             ; #   MOD01-RAMTest         (Shift-0)  #
0014   0000             ; #   MOD02-Serial Send     (Shift-1)  #
0015   0000             ; #   MOD03-Serial Receive  (Shift-2)  #
0016   0000             ; #   MOD04-Memory Copy     (Shift-3)  #
0017   0000             ; #   MOD10-Serial Loopback (Shift-F)  #
0018   0000             ; #  --------------------------------  #
0019   0000             ; #                                    #
0020   0000             ; #  by Scott Gregory                  #
0021   0000             ; #  13/06/2021                        #
0022   0000             ; #                                    #
0023   0000             ; ######################################
0024   0000             ;
0025   0000             STACKTOP	.EQU	$08C0 ; Stack position.
0026   0000             ROMBASE		.EQU	$0000 ; Start of ROM.
0027   0000             ROMTOP		.EQU	$07FF ; End of ROM.
0028   0000             RAMBASE		.EQU	$0900 ; Start of user RAM.
0029   0000             RAMTOP		.EQU	$FFFF ; End of user RAM.
0030   0000             CATHDLY		.EQU	$40 ; Digit display delay.
0031   0000             KEYPORT		.EQU	$00 ; Keypad port.
0032   0000             CATHPORT	.EQU	$01 ; Display catchode port.
0033   0000             SEGPORT		.EQU	$02 ; Display segment port.
0034   0000             ;
0035   0000             ADDRESS		.EQU	$08C1 ; 2 Bytes.
0036   0000             SCRATCH		.EQU	$08C3 ; 2 Bytes.
0037   0000             MODE		.EQU	$08C5 ; 1 Byte.
0038   0000             KEYDATA		.EQU	$08C6 ; 1 Byte.
0039   0000             BEEPLENGTH	.EQU	$08C7 ; 2 Bytes.
0040   0000             BEEPFREQ	.EQU	$08C9 ; 1 Byte.
0041   0000             ;
0042   0000             ; Begin global MOD assignments.
0043   0000             SERBUFFER	.EQU	$06
0044   0000             SERSTATUS	.EQU	$07
0045   0000             SERSTART	.EQU	$08F6
0046   0000             SEREND		.EQU	$08F8
0047   0000             ; End global MOD assignments.
0048   0000             ;
0049   0000             ; Begin MOD-01 assignments.
0050   0000             M01START	.EQU	$08F0
0051   0000             M01FINISH	.EQU	$08F2
0052   0000             M01PATTERN	.EQU	$08F4
0053   0000             ; End MOD-01 assignments.
0054   0000             ;
0055   0000             ; Begin MOD-02 assignments.
0056   0000             ; End MOD-02 assignments.
0057   0000             ;
0058   0000             ; Begin MOD-03 assignments.
0059   0000             ; End MOD-03 assignments.
0060   0000             ;
0061   0000             ; Begin MOD-04 assignments.
0062   0000             SRCRAM		.EQU	$08E0
0063   0000             DESTRAM		.EQU	$08E2
0064   0000             BLKSIZE		.EQU	$08E4
0065   0000             ; End MOD-04 assignments.
0066   0000             ;
0067   0000             ; Begin MOD-10 assignments.
0068   0000             ; End MOD-10 assignments.
0069   0000             ;
0070   0000 00 00 00 00 			.FILL	(ROMTOP - ROMBASE) + 1, $00
0070   0004 00 00 00 00 
0070   0008 00 00 00 00 
0070   000C 00 00 00 00 
0070   0010 00 00 00 00 
0070   0014 00 00 00 00 
0070   0018 00 00 00 00 
0070   001C 00 00 00 00 
0070   0020 00 00 00 00 
0070   0024 00 00 00 00 
0070   0028 00 00 00 00 
0070   002C 00 00 00 00 
0070   0030 00 00 00 00 
0070   0034 00 00 00 00 
0070   0038 00 00 00 00 
0070   003C 00 00 00 00 
0070   0040 00 00 00 00 
0070   0044 00 00 00 00 
0070   0048 00 00 00 00 
0070   004C 00 00 00 00 
0070   0050 00 00 00 00 
0070   0054 00 00 00 00 
0070   0058 00 00 00 00 
0070   005C 00 00 00 00 
0070   0060 00 00 00 00 
0070   0064 00 00 00 00 
0070   0068 00 00 00 00 
0070   006C 00 00 00 00 
0070   0070 00 00 00 00 
0070   0074 00 00 00 00 
0070   0078 00 00 00 00 
0070   007C 00 00 00 00 
0070   0080 00 00 00 00 
0070   0084 00 00 00 00 
0070   0088 00 00 00 00 
0070   008C 00 00 00 00 
0070   0090 00 00 00 00 
0070   0094 00 00 00 00 
0070   0098 00 00 00 00 
0070   009C 00 00 00 00 
0070   00A0 00 00 00 00 
0070   00A4 00 00 00 00 
0070   00A8 00 00 00 00 
0070   00AC 00 00 00 00 
0070   00B0 00 00 00 00 
0070   00B4 00 00 00 00 
0070   00B8 00 00 00 00 
0070   00BC 00 00 00 00 
0070   00C0 00 00 00 00 
0070   00C4 00 00 00 00 
0070   00C8 00 00 00 00 
0070   00CC 00 00 00 00 
0070   00D0 00 00 00 00 
0070   00D4 00 00 00 00 
0070   00D8 00 00 00 00 
0070   00DC 00 00 00 00 
0070   00E0 00 00 00 00 
0070   00E4 00 00 00 00 
0070   00E8 00 00 00 00 
0070   00EC 00 00 00 00 
0070   00F0 00 00 00 00 
0070   00F4 00 00 00 00 
0070   00F8 00 00 00 00 
0070   00FC 00 00 00 00 
0070   0100 00 00 00 00 
0070   0104 00 00 00 00 
0070   0108 00 00 00 00 
0070   010C 00 00 00 00 
0070   0110 00 00 00 00 
0070   0114 00 00 00 00 
0070   0118 00 00 00 00 
0070   011C 00 00 00 00 
0070   0120 00 00 00 00 
0070   0124 00 00 00 00 
0070   0128 00 00 00 00 
0070   012C 00 00 00 00 
0070   0130 00 00 00 00 
0070   0134 00 00 00 00 
0070   0138 00 00 00 00 
0070   013C 00 00 00 00 
0070   0140 00 00 00 00 
0070   0144 00 00 00 00 
0070   0148 00 00 00 00 
0070   014C 00 00 00 00 
0070   0150 00 00 00 00 
0070   0154 00 00 00 00 
0070   0158 00 00 00 00 
0070   015C 00 00 00 00 
0070   0160 00 00 00 00 
0070   0164 00 00 00 00 
0070   0168 00 00 00 00 
0070   016C 00 00 00 00 
0070   0170 00 00 00 00 
0070   0174 00 00 00 00 
0070   0178 00 00 00 00 
0070   017C 00 00 00 00 
0070   0180 00 00 00 00 
0070   0184 00 00 00 00 
0070   0188 00 00 00 00 
0070   018C 00 00 00 00 
0070   0190 00 00 00 00 
0070   0194 00 00 00 00 
0070   0198 00 00 00 00 
0070   019C 00 00 00 00 
0070   01A0 00 00 00 00 
0070   01A4 00 00 00 00 
0070   01A8 00 00 00 00 
0070   01AC 00 00 00 00 
0070   01B0 00 00 00 00 
0070   01B4 00 00 00 00 
0070   01B8 00 00 00 00 
0070   01BC 00 00 00 00 
0070   01C0 00 00 00 00 
0070   01C4 00 00 00 00 
0070   01C8 00 00 00 00 
0070   01CC 00 00 00 00 
0070   01D0 00 00 00 00 
0070   01D4 00 00 00 00 
0070   01D8 00 00 00 00 
0070   01DC 00 00 00 00 
0070   01E0 00 00 00 00 
0070   01E4 00 00 00 00 
0070   01E8 00 00 00 00 
0070   01EC 00 00 00 00 
0070   01F0 00 00 00 00 
0070   01F4 00 00 00 00 
0070   01F8 00 00 00 00 
0070   01FC 00 00 00 00 
0070   0200 00 00 00 00 
0070   0204 00 00 00 00 
0070   0208 00 00 00 00 
0070   020C 00 00 00 00 
0070   0210 00 00 00 00 
0070   0214 00 00 00 00 
0070   0218 00 00 00 00 
0070   021C 00 00 00 00 
0070   0220 00 00 00 00 
0070   0224 00 00 00 00 
0070   0228 00 00 00 00 
0070   022C 00 00 00 00 
0070   0230 00 00 00 00 
0070   0234 00 00 00 00 
0070   0238 00 00 00 00 
0070   023C 00 00 00 00 
0070   0240 00 00 00 00 
0070   0244 00 00 00 00 
0070   0248 00 00 00 00 
0070   024C 00 00 00 00 
0070   0250 00 00 00 00 
0070   0254 00 00 00 00 
0070   0258 00 00 00 00 
0070   025C 00 00 00 00 
0070   0260 00 00 00 00 
0070   0264 00 00 00 00 
0070   0268 00 00 00 00 
0070   026C 00 00 00 00 
0070   0270 00 00 00 00 
0070   0274 00 00 00 00 
0070   0278 00 00 00 00 
0070   027C 00 00 00 00 
0070   0280 00 00 00 00 
0070   0284 00 00 00 00 
0070   0288 00 00 00 00 
0070   028C 00 00 00 00 
0070   0290 00 00 00 00 
0070   0294 00 00 00 00 
0070   0298 00 00 00 00 
0070   029C 00 00 00 00 
0070   02A0 00 00 00 00 
0070   02A4 00 00 00 00 
0070   02A8 00 00 00 00 
0070   02AC 00 00 00 00 
0070   02B0 00 00 00 00 
0070   02B4 00 00 00 00 
0070   02B8 00 00 00 00 
0070   02BC 00 00 00 00 
0070   02C0 00 00 00 00 
0070   02C4 00 00 00 00 
0070   02C8 00 00 00 00 
0070   02CC 00 00 00 00 
0070   02D0 00 00 00 00 
0070   02D4 00 00 00 00 
0070   02D8 00 00 00 00 
0070   02DC 00 00 00 00 
0070   02E0 00 00 00 00 
0070   02E4 00 00 00 00 
0070   02E8 00 00 00 00 
0070   02EC 00 00 00 00 
0070   02F0 00 00 00 00 
0070   02F4 00 00 00 00 
0070   02F8 00 00 00 00 
0070   02FC 00 00 00 00 
0070   0300 00 00 00 00 
0070   0304 00 00 00 00 
0070   0308 00 00 00 00 
0070   030C 00 00 00 00 
0070   0310 00 00 00 00 
0070   0314 00 00 00 00 
0070   0318 00 00 00 00 
0070   031C 00 00 00 00 
0070   0320 00 00 00 00 
0070   0324 00 00 00 00 
0070   0328 00 00 00 00 
0070   032C 00 00 00 00 
0070   0330 00 00 00 00 
0070   0334 00 00 00 00 
0070   0338 00 00 00 00 
0070   033C 00 00 00 00 
0070   0340 00 00 00 00 
0070   0344 00 00 00 00 
0070   0348 00 00 00 00 
0070   034C 00 00 00 00 
0070   0350 00 00 00 00 
0070   0354 00 00 00 00 
0070   0358 00 00 00 00 
0070   035C 00 00 00 00 
0070   0360 00 00 00 00 
0070   0364 00 00 00 00 
0070   0368 00 00 00 00 
0070   036C 00 00 00 00 
0070   0370 00 00 00 00 
0070   0374 00 00 00 00 
0070   0378 00 00 00 00 
0070   037C 00 00 00 00 
0070   0380 00 00 00 00 
0070   0384 00 00 00 00 
0070   0388 00 00 00 00 
0070   038C 00 00 00 00 
0070   0390 00 00 00 00 
0070   0394 00 00 00 00 
0070   0398 00 00 00 00 
0070   039C 00 00 00 00 
0070   03A0 00 00 00 00 
0070   03A4 00 00 00 00 
0070   03A8 00 00 00 00 
0070   03AC 00 00 00 00 
0070   03B0 00 00 00 00 
0070   03B4 00 00 00 00 
0070   03B8 00 00 00 00 
0070   03BC 00 00 00 00 
0070   03C0 00 00 00 00 
0070   03C4 00 00 00 00 
0070   03C8 00 00 00 00 
0070   03CC 00 00 00 00 
0070   03D0 00 00 00 00 
0070   03D4 00 00 00 00 
0070   03D8 00 00 00 00 
0070   03DC 00 00 00 00 
0070   03E0 00 00 00 00 
0070   03E4 00 00 00 00 
0070   03E8 00 00 00 00 
0070   03EC 00 00 00 00 
0070   03F0 00 00 00 00 
0070   03F4 00 00 00 00 
0070   03F8 00 00 00 00 
0070   03FC 00 00 00 00 
0070   0400 00 00 00 00 
0070   0404 00 00 00 00 
0070   0408 00 00 00 00 
0070   040C 00 00 00 00 
0070   0410 00 00 00 00 
0070   0414 00 00 00 00 
0070   0418 00 00 00 00 
0070   041C 00 00 00 00 
0070   0420 00 00 00 00 
0070   0424 00 00 00 00 
0070   0428 00 00 00 00 
0070   042C 00 00 00 00 
0070   0430 00 00 00 00 
0070   0434 00 00 00 00 
0070   0438 00 00 00 00 
0070   043C 00 00 00 00 
0070   0440 00 00 00 00 
0070   0444 00 00 00 00 
0070   0448 00 00 00 00 
0070   044C 00 00 00 00 
0070   0450 00 00 00 00 
0070   0454 00 00 00 00 
0070   0458 00 00 00 00 
0070   045C 00 00 00 00 
0070   0460 00 00 00 00 
0070   0464 00 00 00 00 
0070   0468 00 00 00 00 
0070   046C 00 00 00 00 
0070   0470 00 00 00 00 
0070   0474 00 00 00 00 
0070   0478 00 00 00 00 
0070   047C 00 00 00 00 
0070   0480 00 00 00 00 
0070   0484 00 00 00 00 
0070   0488 00 00 00 00 
0070   048C 00 00 00 00 
0070   0490 00 00 00 00 
0070   0494 00 00 00 00 
0070   0498 00 00 00 00 
0070   049C 00 00 00 00 
0070   04A0 00 00 00 00 
0070   04A4 00 00 00 00 
0070   04A8 00 00 00 00 
0070   04AC 00 00 00 00 
0070   04B0 00 00 00 00 
0070   04B4 00 00 00 00 
0070   04B8 00 00 00 00 
0070   04BC 00 00 00 00 
0070   04C0 00 00 00 00 
0070   04C4 00 00 00 00 
0070   04C8 00 00 00 00 
0070   04CC 00 00 00 00 
0070   04D0 00 00 00 00 
0070   04D4 00 00 00 00 
0070   04D8 00 00 00 00 
0070   04DC 00 00 00 00 
0070   04E0 00 00 00 00 
0070   04E4 00 00 00 00 
0070   04E8 00 00 00 00 
0070   04EC 00 00 00 00 
0070   04F0 00 00 00 00 
0070   04F4 00 00 00 00 
0070   04F8 00 00 00 00 
0070   04FC 00 00 00 00 
0070   0500 00 00 00 00 
0070   0504 00 00 00 00 
0070   0508 00 00 00 00 
0070   050C 00 00 00 00 
0070   0510 00 00 00 00 
0070   0514 00 00 00 00 
0070   0518 00 00 00 00 
0070   051C 00 00 00 00 
0070   0520 00 00 00 00 
0070   0524 00 00 00 00 
0070   0528 00 00 00 00 
0070   052C 00 00 00 00 
0070   0530 00 00 00 00 
0070   0534 00 00 00 00 
0070   0538 00 00 00 00 
0070   053C 00 00 00 00 
0070   0540 00 00 00 00 
0070   0544 00 00 00 00 
0070   0548 00 00 00 00 
0070   054C 00 00 00 00 
0070   0550 00 00 00 00 
0070   0554 00 00 00 00 
0070   0558 00 00 00 00 
0070   055C 00 00 00 00 
0070   0560 00 00 00 00 
0070   0564 00 00 00 00 
0070   0568 00 00 00 00 
0070   056C 00 00 00 00 
0070   0570 00 00 00 00 
0070   0574 00 00 00 00 
0070   0578 00 00 00 00 
0070   057C 00 00 00 00 
0070   0580 00 00 00 00 
0070   0584 00 00 00 00 
0070   0588 00 00 00 00 
0070   058C 00 00 00 00 
0070   0590 00 00 00 00 
0070   0594 00 00 00 00 
0070   0598 00 00 00 00 
0070   059C 00 00 00 00 
0070   05A0 00 00 00 00 
0070   05A4 00 00 00 00 
0070   05A8 00 00 00 00 
0070   05AC 00 00 00 00 
0070   05B0 00 00 00 00 
0070   05B4 00 00 00 00 
0070   05B8 00 00 00 00 
0070   05BC 00 00 00 00 
0070   05C0 00 00 00 00 
0070   05C4 00 00 00 00 
0070   05C8 00 00 00 00 
0070   05CC 00 00 00 00 
0070   05D0 00 00 00 00 
0070   05D4 00 00 00 00 
0070   05D8 00 00 00 00 
0070   05DC 00 00 00 00 
0070   05E0 00 00 00 00 
0070   05E4 00 00 00 00 
0070   05E8 00 00 00 00 
0070   05EC 00 00 00 00 
0070   05F0 00 00 00 00 
0070   05F4 00 00 00 00 
0070   05F8 00 00 00 00 
0070   05FC 00 00 00 00 
0070   0600 00 00 00 00 
0070   0604 00 00 00 00 
0070   0608 00 00 00 00 
0070   060C 00 00 00 00 
0070   0610 00 00 00 00 
0070   0614 00 00 00 00 
0070   0618 00 00 00 00 
0070   061C 00 00 00 00 
0070   0620 00 00 00 00 
0070   0624 00 00 00 00 
0070   0628 00 00 00 00 
0070   062C 00 00 00 00 
0070   0630 00 00 00 00 
0070   0634 00 00 00 00 
0070   0638 00 00 00 00 
0070   063C 00 00 00 00 
0070   0640 00 00 00 00 
0070   0644 00 00 00 00 
0070   0648 00 00 00 00 
0070   064C 00 00 00 00 
0070   0650 00 00 00 00 
0070   0654 00 00 00 00 
0070   0658 00 00 00 00 
0070   065C 00 00 00 00 
0070   0660 00 00 00 00 
0070   0664 00 00 00 00 
0070   0668 00 00 00 00 
0070   066C 00 00 00 00 
0070   0670 00 00 00 00 
0070   0674 00 00 00 00 
0070   0678 00 00 00 00 
0070   067C 00 00 00 00 
0070   0680 00 00 00 00 
0070   0684 00 00 00 00 
0070   0688 00 00 00 00 
0070   068C 00 00 00 00 
0070   0690 00 00 00 00 
0070   0694 00 00 00 00 
0070   0698 00 00 00 00 
0070   069C 00 00 00 00 
0070   06A0 00 00 00 00 
0070   06A4 00 00 00 00 
0070   06A8 00 00 00 00 
0070   06AC 00 00 00 00 
0070   06B0 00 00 00 00 
0070   06B4 00 00 00 00 
0070   06B8 00 00 00 00 
0070   06BC 00 00 00 00 
0070   06C0 00 00 00 00 
0070   06C4 00 00 00 00 
0070   06C8 00 00 00 00 
0070   06CC 00 00 00 00 
0070   06D0 00 00 00 00 
0070   06D4 00 00 00 00 
0070   06D8 00 00 00 00 
0070   06DC 00 00 00 00 
0070   06E0 00 00 00 00 
0070   06E4 00 00 00 00 
0070   06E8 00 00 00 00 
0070   06EC 00 00 00 00 
0070   06F0 00 00 00 00 
0070   06F4 00 00 00 00 
0070   06F8 00 00 00 00 
0070   06FC 00 00 00 00 
0070   0700 00 00 00 00 
0070   0704 00 00 00 00 
0070   0708 00 00 00 00 
0070   070C 00 00 00 00 
0070   0710 00 00 00 00 
0070   0714 00 00 00 00 
0070   0718 00 00 00 00 
0070   071C 00 00 00 00 
0070   0720 00 00 00 00 
0070   0724 00 00 00 00 
0070   0728 00 00 00 00 
0070   072C 00 00 00 00 
0070   0730 00 00 00 00 
0070   0734 00 00 00 00 
0070   0738 00 00 00 00 
0070   073C 00 00 00 00 
0070   0740 00 00 00 00 
0070   0744 00 00 00 00 
0070   0748 00 00 00 00 
0070   074C 00 00 00 00 
0070   0750 00 00 00 00 
0070   0754 00 00 00 00 
0070   0758 00 00 00 00 
0070   075C 00 00 00 00 
0070   0760 00 00 00 00 
0070   0764 00 00 00 00 
0070   0768 00 00 00 00 
0070   076C 00 00 00 00 
0070   0770 00 00 00 00 
0070   0774 00 00 00 00 
0070   0778 00 00 00 00 
0070   077C 00 00 00 00 
0070   0780 00 00 00 00 
0070   0784 00 00 00 00 
0070   0788 00 00 00 00 
0070   078C 00 00 00 00 
0070   0790 00 00 00 00 
0070   0794 00 00 00 00 
0070   0798 00 00 00 00 
0070   079C 00 00 00 00 
0070   07A0 00 00 00 00 
0070   07A4 00 00 00 00 
0070   07A8 00 00 00 00 
0070   07AC 00 00 00 00 
0070   07B0 00 00 00 00 
0070   07B4 00 00 00 00 
0070   07B8 00 00 00 00 
0070   07BC 00 00 00 00 
0070   07C0 00 00 00 00 
0070   07C4 00 00 00 00 
0070   07C8 00 00 00 00 
0070   07CC 00 00 00 00 
0070   07D0 00 00 00 00 
0070   07D4 00 00 00 00 
0070   07D8 00 00 00 00 
0070   07DC 00 00 00 00 
0070   07E0 00 00 00 00 
0070   07E4 00 00 00 00 
0070   07E8 00 00 00 00 
0070   07EC 00 00 00 00 
0070   07F0 00 00 00 00 
0070   07F4 00 00 00 00 
0070   07F8 00 00 00 00 
0070   07FC 00 00 00 00 
0071   0000             			.ORG	$0000
0072   0000 C3 F2 03    RESET_00:	JP		SETUP
0073   0003             ;
0074   0008             			.ORG	$0008
0075   0008 C3 F2 03    RESET_08:	JP		SETUP
0076   000B             ;
0077   0010             			.ORG	$0010
0078   0010 C3 F2 03    RESET_10:	JP		SETUP
0079   0013             ;
0080   0018             			.ORG	$0018
0081   0018 C3 F2 03    RESET_18:	JP		SETUP
0082   001B             ;
0083   0020             			.ORG	$0020
0084   0020 C3 F2 03    RESET_20:	JP		SETUP
0085   0023             ;
0086   0028             			.ORG	$0028
0087   0028 C3 F2 03    RESET_28:	JP		SETUP
0088   002B             ;
0089   0030             			.ORG	$0030
0090   0030 C3 F2 03    RESET_30:	JP		SETUP
0091   0033             ;
0092   0038             			.ORG	$0038
0093   0038 C3 F2 03    RESET_38:	JP		SETUP
0094   003B             ;
0095   0040             			.ORG	$0040
0096   0040 75 4D 4F 4E VERSION:	.TEXT	"uMON V1.03 by Scott Gregory"
0096   0044 20 56 31 2E 
0096   0048 30 33 20 62 
0096   004C 79 20 53 63 
0096   0050 6F 74 74 20 
0096   0054 47 72 65 67 
0096   0058 6F 72 79 
0097   005B             ;
0098   0066             			.ORG	$0066
0099   0066 F5          NMISERVICE:	PUSH	af ; Keyboard service routine.
0100   0067 DB 00       			IN		a,(KEYPORT)
0101   0069 32 C6 08    			LD		(KEYDATA),a
0102   006C F1          			POP		af
0103   006D ED 45       			RETN
0104   006F             ;
0105   0080             			.ORG	$0080
0106   0080 AF          DISPLAY:	XOR		a ; Display update routine.
0107   0081 D3 01       			OUT		(CATHPORT),a
0108   0083 D3 02       			OUT		(SEGPORT),a
0109   0085 4F          			LD		c,a
0110   0086 CB E9       			SET		5,c
0111   0088 ED 5B C1 08 			LD		de,(ADDRESS)
0112   008C 7A          			LD		a,d
0113   008D 32 C3 08    			LD		(SCRATCH),a
0114   0090 AF          			XOR		a
0115   0091 21 C3 08    			LD		hl,SCRATCH
0116   0094 ED 6F       			RLD
0117   0096 DD 21 10 04 			LD		ix,HEX2SEG
0118   009A 16 00       			LD		d,$00
0119   009C 5F          			LD		e,a
0120   009D DD 19       			ADD		ix,de
0121   009F DD 7E 00    			LD		a,(ix)
0122   00A2 E5          			PUSH	hl
0123   00A3 21 C5 08    			LD		hl,MODE
0124   00A6 CB 46       			BIT		0,(hl)
0125   00A8 CA AD 00    			JP		z,DISL00
0126   00AB F6 10       			OR		$10
0127   00AD E1          DISL00:		POP		hl
0128   00AE D3 02       			OUT		(SEGPORT),a
0129   00B0 79          			LD		a,c
0130   00B1 D3 01       			OUT		(CATHPORT),a
0131   00B3 06 40       			LD		b,CATHDLY
0132   00B5 10 FE       DISL01:		DJNZ	DISL01
0133   00B7 AF          			XOR		a
0134   00B8 D3 01       			OUT		(CATHPORT),a
0135   00BA CB 19       			RR		c
0136   00BC ED 6F       			RLD
0137   00BE DD 21 10 04 			LD		ix,HEX2SEG
0138   00C2 16 00       			LD		d,$00
0139   00C4 5F          			LD		e,a
0140   00C5 DD 19       			ADD		ix,de
0141   00C7 DD 7E 00    			LD		a,(ix)
0142   00CA E5          			PUSH	hl
0143   00CB 21 C5 08    			LD		hl,MODE
0144   00CE CB 46       			BIT		0,(hl)
0145   00D0 CA D5 00    			JP		z,DISL02
0146   00D3 F6 10       			OR		$10
0147   00D5 E1          DISL02:		POP		hl
0148   00D6 D3 02       			OUT		(SEGPORT),a
0149   00D8 79          			LD		a,c
0150   00D9 D3 01       			OUT		(CATHPORT),a
0151   00DB 06 40       			LD		b,CATHDLY
0152   00DD 10 FE       DISL03:		DJNZ	DISL03
0153   00DF AF          			XOR		a
0154   00E0 D3 01       			OUT		(CATHPORT),a
0155   00E2 CB 19       			RR		c
0156   00E4 ED 5B C1 08 			LD		de,(ADDRESS)
0157   00E8 7B          			LD		a,e
0158   00E9 32 C3 08    			LD		(SCRATCH),a
0159   00EC AF          			XOR		a
0160   00ED 21 C3 08    			LD		hl,SCRATCH
0161   00F0 ED 6F       			RLD
0162   00F2 DD 21 10 04 			LD		ix,HEX2SEG
0163   00F6 16 00       			LD		d,$00
0164   00F8 5F          			LD		e,a
0165   00F9 DD 19       			ADD		ix,de
0166   00FB DD 7E 00    			LD		a,(ix)
0167   00FE E5          			PUSH	hl
0168   00FF 21 C5 08    			LD		hl,MODE
0169   0102 CB 46       			BIT		0,(hl)
0170   0104 CA 09 01    			JP		z,DISL04
0171   0107 F6 10       			OR		$10
0172   0109 E1          DISL04:		POP		hl
0173   010A D3 02       			OUT		(SEGPORT),a
0174   010C 79          			LD		a,c
0175   010D D3 01       			OUT		(CATHPORT),a
0176   010F 06 40       			LD			b,CATHDLY
0177   0111 10 FE       DISL05:		DJNZ	DISL05
0178   0113 AF          			XOR		a
0179   0114 D3 01       			OUT		(CATHPORT),a
0180   0116 CB 19       			RR		c
0181   0118 ED 6F       			RLD
0182   011A DD 21 10 04 			LD		ix,HEX2SEG
0183   011E 16 00       			LD		d,$00
0184   0120 5F          			LD		e,a
0185   0121 DD 19       			ADD		ix,de
0186   0123 DD 7E 00    			LD		a,(ix)
0187   0126 E5          			PUSH	hl
0188   0127 21 C5 08    			LD		hl,MODE
0189   012A CB 46       			BIT		0,(hl)
0190   012C CA 31 01    			JP		z,DISL06
0191   012F F6 10       			OR		$10
0192   0131 E1          DISL06:		POP		hl
0193   0132 D3 02       			OUT		(SEGPORT),a
0194   0134 79          			LD		a,c
0195   0135 D3 01       			OUT		(CATHPORT),a
0196   0137 06 40       			LD		b,CATHDLY
0197   0139 10 FE       DISL07:		DJNZ	DISL07
0198   013B AF          			XOR		a
0199   013C D3 01       			OUT		(CATHPORT),a
0200   013E CB 19       			RR		c
0201   0140 2A C1 08    			LD		hl,(ADDRESS)
0202   0143 7E          			LD		a,(hl)
0203   0144 32 C3 08    			LD		(SCRATCH),a
0204   0147 AF          			XOR		a
0205   0148 21 C3 08    			LD		hl,SCRATCH
0206   014B ED 6F       			RLD
0207   014D DD 21 10 04 			LD		ix,HEX2SEG
0208   0151 16 00       			LD		d,$00
0209   0153 5F          			LD		e,a
0210   0154 DD 19       			ADD		ix,de
0211   0156 DD 7E 00    			LD		a,(ix)
0212   0159 E5          			PUSH	hl
0213   015A 21 C5 08    			LD		hl,MODE
0214   015D CB 46       			BIT		0,(hl)
0215   015F C2 64 01    			JP		nz,DISL08
0216   0162 F6 10       			OR		$10
0217   0164 E1          DISL08:		POP		hl
0218   0165 D3 02       			OUT		(SEGPORT),a
0219   0167 79          			LD		a,c
0220   0168 D3 01       			OUT		(CATHPORT),a
0221   016A 06 40       			LD		b,CATHDLY
0222   016C 10 FE       DISL09:		DJNZ	DISL09
0223   016E AF          			XOR		a
0224   016F D3 01       			OUT		(CATHPORT),a
0225   0171 CB 19       			RR		c
0226   0173 ED 6F       			RLD
0227   0175 DD 21 10 04 			LD		ix,HEX2SEG
0228   0179 16 00       			LD		d,$00
0229   017B 5F          			LD		e,a
0230   017C DD 19       			ADD		ix,de
0231   017E DD 7E 00    			LD		a,(ix)
0232   0181 E5          			PUSH	hl
0233   0182 21 C5 08    			LD		hl,MODE
0234   0185 CB 46       			BIT		0,(hl)
0235   0187 C2 8C 01    			JP		nz,DISL0A
0236   018A F6 10       			OR		$10
0237   018C E1          DISL0A:		POP		hl
0238   018D D3 02       			OUT		(SEGPORT),a
0239   018F 79          			LD		a,c
0240   0190 D3 01       			OUT		(CATHPORT),a
0241   0192 06 40       			LD		b,CATHDLY
0242   0194 10 FE       DISL0B:		DJNZ	DISL0B
0243   0196 C9          			RET
0244   0197             ;
0245   0197 E5          KEYBOARD:	PUSH	hl ; Key decoder routine.
0246   0198 F5          			PUSH	af
0247   0199 21 30 00    			LD		hl,$0030
0248   019C 22 C7 08    			LD		(BEEPLENGTH),hl
0249   019F 21 C9 08    			LD		hl,BEEPFREQ
0250   01A2 36 30       			LD		(hl),$30
0251   01A4 21 C6 08    			LD		hl,KEYDATA
0252   01A7 3E FF       			LD		a,$FF
0253   01A9 BE          			CP		(hl)
0254   01AA CA AB 03    			JP		z,KEYLXX
0255   01AD CD B3 03    			CALL	BEEP
0256   01B0 7E          			LD		a,(hl)
0257   01B1 E6 3F       			AND		$3f ; We only want the first 6 bits.
0258   01B3 EE 20       			XOR		$20 ; Flip bit 6 (Shift key) because it gives a 1 when not being pressed.
0259   01B5             ;
0260   01B5 FE 10       			CP		$10 ; + key.
0261   01B7 C2 CD 01    			JP		nz,KEYL00
0262   01BA 2A C1 08    			LD		hl,(ADDRESS)
0263   01BD 23          			INC		hl
0264   01BE 22 C1 08    			LD		(ADDRESS),hl
0265   01C1 21 C5 08    			LD		hl,MODE
0266   01C4 CB 86       			RES		0,(hl)
0267   01C6 CB 8E       			RES		1,(hl)
0268   01C8 CB 96       			RES		2,(hl)
0269   01CA C3 AB 03    			JP		KEYLXX
0270   01CD             ;
0271   01CD FE 11       KEYL00:		CP		$11 ; - key.
0272   01CF C2 E5 01    			JP		nz,KEYL01
0273   01D2 2A C1 08    			LD		hl,(ADDRESS)
0274   01D5 2B          			DEC		hl
0275   01D6 22 C1 08    			LD		(ADDRESS),hl
0276   01D9 21 C5 08    			LD		hl,MODE
0277   01DC CB 86       			RES		0,(hl)
0278   01DE CB 8E       			RES		1,(hl)
0279   01E0 CB 96       			RES		2,(hl)
0280   01E2 C3 AB 03    			JP		KEYLXX
0281   01E5             ;
0282   01E5 FE 12       KEYL01:		CP		$12 ; GO key.
0283   01E7 C2 F1 01    			JP		nz,KEYL02
0284   01EA 31 C0 08    			LD		sp,STACKTOP
0285   01ED 2A C1 08    			LD		hl,(ADDRESS)
0286   01F0 E9          			JP		(hl)
0287   01F1             ;
0288   01F1 FE 13       KEYL02:		CP		$13 ; AD key.
0289   01F3 C2 07 02    			JP		nz,KEYL03
0290   01F6 47          			LD		b,a
0291   01F7 3A C5 08    			LD		a,(MODE)
0292   01FA EE 01       			XOR		$01
0293   01FC CB 8F       			RES		1,a
0294   01FE CB 97       			RES		2,a
0295   0200 32 C5 08    			LD		(MODE),a
0296   0203 78          			LD		a,b
0297   0204 C3 AB 03    			JP		KEYLXX
0298   0207             ;
0299   0207 FE 20       KEYL03:		CP		$20 ; Shift-0 key - MOD-01: RAMTest
0300   0209 C2 16 02    			JP		nz,KEYL04
0301   020C F5          			PUSH	af
0302   020D E5          			PUSH	hl
0303   020E CD 20 04    			CALL	MOD01
0304   0211 E1          			POP		hl
0305   0212 F1          			POP		af
0306   0213 C3 AB 03    			JP		KEYLXX
0307   0216             ;
0308   0216 FE 21       KEYL04:		CP		$21 ; Shift-1 key - MOD-02: Serial Send
0309   0218 C2 25 02    			JP		nz,KEYL05
0310   021B F5          			PUSH	af
0311   021C E5          			PUSH	hl
0312   021D CD 74 04    			CALL	MOD02
0313   0220 E1          			POP		hl
0314   0221 F1          			POP		af
0315   0222 C3 AB 03    			JP		KEYLXX
0316   0225             ;
0317   0225 FE 22       KEYL05:		CP		$22 ; Shift-2 key - MOD-03: Serial Receive
0318   0227 C2 34 02    			JP		nz,KEYL06
0319   022A F5          			PUSH	af
0320   022B E5          			PUSH	hl
0321   022C CD 95 04    			CALL	MOD03
0322   022F E1          			POP		hl
0323   0230 F1          			POP		af
0324   0231 CA AB 03    			JP		z,KEYLXX
0325   0234             ;
0326   0234 FE 23       KEYL06:		CP		$23 ; Shift-3 key - MOD-04: RAM Copy
0327   0236 C2 43 02    			JP		nz,KEYL07
0328   0239 F5          			PUSH	af
0329   023A E5          			PUSH	hl
0330   023B CD B6 04    			CALL	MOD04
0331   023E E1          			POP		hl
0332   023F F1          			POP		af
0333   0240 CA AB 03    			JP		z,KEYLXX
0334   0243             ;
0335   0243 FE 24       KEYL07:		CP		$24 ; Shift-4 key.
0336   0245 CA AB 03    			JP		z,KEYLXX
0337   0248 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0337   024C 00 00 00 00 
0337   0250 00 00 
0338   0252 FE 25       KEYL08:		CP		$25 ; Shift-5 key.
0339   0254 CA AB 03    			JP		z,KEYLXX
0340   0257 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0340   025B 00 00 00 00 
0340   025F 00 00 
0341   0261 FE 26       KEYL09:		CP		$26 ; Shift-6 key.
0342   0263 CA AB 03    			JP		z,KEYLXX
0343   0266 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0343   026A 00 00 00 00 
0343   026E 00 00 
0344   0270 FE 27       KEYL0A:		CP		$27 ; Shift-7 key.
0345   0272 CA AB 03    			JP		z,KEYLXX
0346   0275 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0346   0279 00 00 00 00 
0346   027D 00 00 
0347   027F FE 28       KEYL0B:		CP		$28 ; Shift-8 key.
0348   0281 CA AB 03    			JP		z,KEYLXX
0349   0284 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0349   0288 00 00 00 00 
0349   028C 00 00 
0350   028E FE 29       KEYL0C:		CP		$29 ; Shift-9 key.
0351   0290 CA AB 03    			JP		z,KEYLXX
0352   0293 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0352   0297 00 00 00 00 
0352   029B 00 00 
0353   029D FE 2A       KEYL0D:		CP		$2A ; Shift-A key.
0354   029F CA AB 03    			JP		z,KEYLXX
0355   02A2 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0355   02A6 00 00 00 00 
0355   02AA 00 00 
0356   02AC FE 2B       KEYL0E:		CP		$2B ; Shift-B key.
0357   02AE CA AB 03    			JP		z,KEYLXX
0358   02B1 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0358   02B5 00 00 00 00 
0358   02B9 00 00 
0359   02BB FE 2C       KEYL0F:		CP		$2C ; Shift-C key.
0360   02BD CA AB 03    			JP		z,KEYLXX
0361   02C0 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0361   02C4 00 00 00 00 
0361   02C8 00 00 
0362   02CA FE 2D       KEYL10:		CP		$2D ; Shift-D key.
0363   02CC CA AB 03    			JP		z,KEYLXX
0364   02CF 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0364   02D3 00 00 00 00 
0364   02D7 00 00 
0365   02D9 FE 2E       KEYL11:		CP		$2E ; Shift-E key.
0366   02DB CA AB 03    			JP		z,KEYLXX
0367   02DE 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00, $00, $00, $00
0367   02E2 00 00 00 00 
0367   02E6 00 00 
0368   02E8 FE 2F       KEYL12:		CP		$2F ; Shift-F key - MOD-10: Serial Echo
0369   02EA C2 F7 02    			JP		nz,KEYL13
0370   02ED C3 C4 04    			JP		MOD10
0371   02F0 00 00 00 00 			.DB		$00, $00, $00, $00, $00, $00, $00
0371   02F4 00 00 00 
0372   02F7             ;
0373   02F7 FE 30       KEYL13:		CP		$30 ; Shift-+ key.
0374   02F9 C2 1D 03    			JP		nz,KEYL14
0375   02FC 21 FF FF    			LD		hl,RAMTOP
0376   02FF ED 5B C1 08 			LD		de,(ADDRESS)
0377   0303 ED 52       			SBC		hl,de
0378   0305 44          			LD		b,h
0379   0306 4D          			LD		c,l
0380   0307 21 FF FF    			LD		hl,RAMTOP
0381   030A 54          			LD		d,h
0382   030B 5D          			LD		e,l
0383   030C 2B          			DEC		hl
0384   030D ED B8       			LDDR
0385   030F 62          			LD		h,d
0386   0310 6B          			LD		l,e
0387   0311 36 00       			LD		(hl),$00
0388   0313 21 C5 08    			LD		hl,MODE
0389   0316 CB 8E       			RES		1,(hl)
0390   0318 CB 96       			RES		2,(hl)
0391   031A C3 AB 03    			JP		KEYLXX
0392   031D             ;
0393   031D FE 31       KEYL14:		CP		$31 ; Shift-- key.
0394   031F C2 43 03    			JP		nz,KEYL15
0395   0322 21 FF FF    			LD		hl,RAMTOP
0396   0325 ED 5B C1 08 			LD		de,(ADDRESS)
0397   0329 ED 52       			SBC		hl,de
0398   032B 44          			LD		b,h
0399   032C 4D          			LD		c,l
0400   032D 2A C1 08    			LD		hl,(ADDRESS)
0401   0330 54          			LD		d,h
0402   0331 5D          			LD		e,l
0403   0332 23          			INC		hl
0404   0333 ED B0       			LDIR
0405   0335 62          			LD		h,d
0406   0336 6B          			LD		l,e
0407   0337 36 00       			LD		(hl),$00
0408   0339 21 C5 08    			LD		hl,MODE
0409   033C CB 8E       			RES		1,(hl)
0410   033E CB 96       			RES		2,(hl)
0411   0340 C3 AB 03    			JP		KEYLXX
0412   0343             ;
0413   0343 FE 32       KEYL15:		CP		$32 ; Shift-GO key.
0414   0345 CA AB 03    			JP		z,KEYLXX
0415   0348 FE 33       KEYL16:		CP		$33 ; Shift-AD key.
0416   034A CA AB 03    			JP		z,KEYLXX
0417   034D             ;
0418   034D 21 C5 08    KEYL17:		LD		hl,MODE ; Non-shifted digit keys entry.
0419   0350 CB 46       			BIT		0,(hl) ; 0 = Data Mode, 1 = Address Mode.
0420   0352 C2 86 03    			JP		nz,KEYL19
0421   0355 CB 4E       			BIT		1,(hl)
0422   0357 CA 72 03    			JP		z,KEYL17B ; Jump on 1st time through a data edit.
0423   035A CB 56       			BIT		2,(hl)
0424   035C CA 70 03    			JP		z,KEYL17A ; Jump on 2nd time through a data edit.
0425   035F CB 8E       			RES		1,(hl) ; Do this the 3rd time round a data edit.
0426   0361 CB 96       			RES		2,(hl)
0427   0363 2A C1 08    			LD		hl,(ADDRESS)
0428   0366 23          			INC		hl
0429   0367 22 C1 08    			LD		(ADDRESS),hl
0430   036A 21 C5 08    			LD		hl,MODE
0431   036D C3 72 03    			JP		KEYL17B
0432   0370 CB D6       KEYL17A:	SET		2,(hl)
0433   0372 CB 4E       KEYL17B:	BIT		1,(hl) ; 0 = first nibble, 1 = second nibble.
0434   0374 C2 7E 03    			JP		nz,KEYL18
0435   0377 CB CE       			SET		1,(hl)
0436   0379 2A C1 08    			LD		hl,(ADDRESS)
0437   037C 36 00       			LD		(hl),$00
0438   037E             ;
0439   037E 2A C1 08    KEYL18:		LD		hl,(ADDRESS)
0440   0381 ED 6F       			RLD
0441   0383 C3 AB 03    KEYL18A:	JP		KEYLXX
0442   0386             ;
0443   0386 CB 4E       KEYL19:		BIT		1,(hl) ; 0 = first nibble, 1 = subsequent nibbles.
0444   0388 C2 93 03    			JP		nz,KEYL1A
0445   038B CB CE       			SET		1,(hl)
0446   038D 21 00 00    			LD		hl,$0000
0447   0390 22 C1 08    			LD		(ADDRESS),hl
0448   0393             ;
0449   0393 21 C1 08    KEYL1A:		LD		hl,ADDRESS
0450   0396 ED 6F       			RLD
0451   0398 2A C1 08    			LD		hl,(ADDRESS)
0452   039B CB 24       			SLA		h
0453   039D CB 24       			SLA		h
0454   039F CB 24       			SLA		h
0455   03A1 CB 24       			SLA		h
0456   03A3 47          			LD		b,a
0457   03A4 AF          			XOR		a
0458   03A5 B4          			OR		h
0459   03A6 B0          			OR		b
0460   03A7 67          			LD		h,a
0461   03A8 22 C1 08    			LD		(ADDRESS),hl
0462   03AB             ;
0463   03AB 21 C6 08    KEYLXX:		LD		hl,KEYDATA ; Done with the key decoder.
0464   03AE 36 FF       			LD		(hl),$FF
0465   03B0 F1          			POP		af
0466   03B1 E1          			POP		hl
0467   03B2 C9          			RET
0468   03B3             ;
0469   03B3 E5          BEEP:		PUSH	hl
0470   03B4 F5          			PUSH	af
0471   03B5 21 C9 08    			LD		hl,BEEPFREQ
0472   03B8 4E          			LD		c,(hl)
0473   03B9 2A C7 08    			LD		hl,(BEEPLENGTH)
0474   03BC AF          			XOR		a
0475   03BD 57          			LD		d,a
0476   03BE 41          BEEPL01:	LD		b,c
0477   03BF 7A          			LD		a,d
0478   03C0 D3 01       			OUT		(CATHPORT),a
0479   03C2 10 FE       BEEPL02:	DJNZ	BEEPL02
0480   03C4 EE 80       			XOR		$80
0481   03C6 2B          			DEC		hl
0482   03C7 57          			LD		d,a
0483   03C8 7C          			LD		a,h
0484   03C9 B5          			OR		l
0485   03CA C2 BE 03    			JP		nz,BEEPL01
0486   03CD F1          			POP		af
0487   03CE E1          			POP		hl
0488   03CF C9          			RET
0489   03D0             ;
0490   03D0 E5          STARTBEEP:	PUSH	hl
0491   03D1 F5          			PUSH	af
0492   03D2 21 7F 00    			LD		hl,$007F
0493   03D5 22 C7 08    			LD		(BEEPLENGTH),hl
0494   03D8 21 C9 08    			LD		hl,BEEPFREQ
0495   03DB 36 35       			LD		(hl),$35
0496   03DD CD B3 03    			CALL	BEEP
0497   03E0 36 30       			LD		(hl),$30
0498   03E2 CD B3 03    			CALL	BEEP
0499   03E5 36 25       			LD		(hl),$25
0500   03E7 CD B3 03    			CALL	BEEP
0501   03EA 36 20       			LD		(hl),$20
0502   03EC CD B3 03    			CALL	BEEP
0503   03EF F1          			POP		af
0504   03F0 E1          			POP		hl
0505   03F1 C9          			RET
0506   03F2             ;			
0507   03F2 31 C0 08    SETUP:		LD		sp,STACKTOP ; Post reset/power up setup.
0508   03F5 21 00 09    			LD		hl,RAMBASE
0509   03F8 22 C1 08    			LD		(ADDRESS),hl
0510   03FB AF          			XOR		a
0511   03FC 32 C5 08    			LD		(MODE),a
0512   03FF 3E FF       			LD		a,$FF
0513   0401 32 C6 08    			LD		(KEYDATA),a
0514   0404 CD D0 03    			CALL	STARTBEEP
0515   0407             ;
0516   0407 CD 80 00    MAIN:		CALL	DISPLAY
0517   040A CD 97 01    			CALL	KEYBOARD
0518   040D C3 07 04    			JP		MAIN
0519   0410             ;
0520   0410 EB 28 CD AD HEX2SEG:	.DB		$EB,$28,$CD,$AD,$2E,$A7,$E7,$29 ; HEX Byte to LED Segment conversion.
0520   0414 2E A7 E7 29 
0521   0418 EF 2F 6F E6 			.DB		$EF,$2F,$6F,$E6,$C3,$EC,$C7,$47
0521   041C C3 EC C7 47 
0522   0420             ;
0523   0420             ; BEGIN MODULES.
0524   0420             ; START MOD-01 - Memory Test
0525   0420 2A F2 08    MOD01:		LD		hl,(M01FINISH)
0526   0423 23          			INC		hl
0527   0424 ED 5B F0 08 			LD		de,(M01START)
0528   0428 AF          			XOR		a
0529   0429 ED 52       			SBC		hl,de
0530   042B 44          			LD		b,h
0531   042C 4D          			LD		c,l
0532   042D ED 43 F2 08 			LD		(M01FINISH),bc
0533   0431 2A F0 08    			LD		hl,(M01START)
0534   0434 ED 5B F4 08 			LD		de,(M01PATTERN)
0535   0438 D9          			EXX
0536   0439 2A F0 08    			LD		hl,(M01START)
0537   043C ED 4B F2 08 			LD		bc,(M01FINISH)
0538   0440 ED 5B F4 08 			LD		de,(M01PATTERN)
0539   0444             ;
0540   0444 72          M01LDBLK:	LD		(hl),d
0541   0445 23          			INC		hl
0542   0446 0B          			DEC		bc
0543   0447 78          			LD		a,b
0544   0448 B1          			OR		c
0545   0449 C2 44 04    			JP		nz,M01LDBLK
0546   044C 11 00 00    			LD		de,$0000
0547   044F             ;
0548   044F 1B          M01DELAY:	DEC		de
0549   0450 7A          			LD		a,d
0550   0451 B3          			OR		e
0551   0452 C2 4F 04    			JP		nz,M01DELAY
0552   0455 11 00 00    			LD		de,$0000
0553   0458 D9          			EXX
0554   0459             ;
0555   0459 C3 62 04    M01TSTBLK:	JP		M01TEST01
0556   045C D9          M01TEST00:	EXX
0557   045D 13          			INC		de
0558   045E D9          			EXX
0559   045F C3 67 04    			JP		M01TEST02
0560   0462 7E          M01TEST01:	LD		a,(hl)
0561   0463 BA          			CP		d
0562   0464 C2 5C 04    			JP		nz,M01TEST00
0563   0467 23          M01TEST02:	INC		hl
0564   0468 0B          			DEC		bc
0565   0469 78          			LD		a,b
0566   046A B1          			OR		c
0567   046B C2 62 04    			JP		nz,M01TEST01
0568   046E             ;
0569   046E D9          M01STORE:	EXX
0570   046F ED 53 F0 08 			LD		(M01START),de
0571   0473 C9          			RET
0572   0474             ; END MOD-01
0573   0474             ;
0574   0474             ; START MOD-02 - Serial Send
0575   0474 DB 06       MOD02:		IN		a,(SERBUFFER)
0576   0476 2A F8 08    			LD		hl,(SEREND)
0577   0479 ED 5B F6 08 			LD		de,(SERSTART)
0578   047D ED 52       			SBC		hl,de
0579   047F EB          			EX		de,hl
0580   0480 3E 06       			LD		a,SERBUFFER
0581   0482 4F          			LD		c,a
0582   0483 43          			LD		b,e
0583   0484             ;
0584   0484 DB 07       M02MAIN:	IN		a,(SERSTATUS)
0585   0486 CB 47       			BIT		0,a
0586   0488 C2 84 04    			JP		nz,M02MAIN
0587   048B ED A3       			OUTI
0588   048D 7A          			LD		a,d
0589   048E B3          			OR		e
0590   048F C8          			RET		z
0591   0490 1B          			DEC		de
0592   0491 43          			LD		b,e
0593   0492 C3 84 04    			JP		M02MAIN
0594   0495             
0595   0495             ; END MOD-02
0596   0495             ;
0597   0495             ; START MOD-03 - Serial Receive
0598   0495 DB 06       MOD03:		IN		a,(SERBUFFER)
0599   0497 2A F8 08    			LD		hl,(SEREND)
0600   049A ED 5B F6 08 			LD		de,(SERSTART)
0601   049E ED 52       			SBC		hl,de
0602   04A0 EB          			EX		de,hl
0603   04A1 3E 06       			LD		a,SERBUFFER
0604   04A3 4F          			LD		c,a
0605   04A4 43          			LD		b,e
0606   04A5             ;
0607   04A5 DB 07       M03MAIN:	IN		a,(SERSTATUS)
0608   04A7 CB 4F       			BIT		1,a
0609   04A9 CA A5 04    			JP		z,M03MAIN
0610   04AC ED A2       			INI
0611   04AE 7A          			LD		a,d
0612   04AF B3          			OR		e
0613   04B0 C8          			RET		z
0614   04B1 1B          			DEC		de
0615   04B2 43          			LD		b,e
0616   04B3 C3 A5 04    			JP		M03MAIN
0617   04B6             ; END MOD-03
0618   04B6             ;
0619   04B6             ; START MOD-04 - RAM Copy
0620   04B6 2A E0 08    MOD04:		LD		hl,(SRCRAM)
0621   04B9 ED 5B E2 08 			LD		de,(DESTRAM)
0622   04BD ED 4B E4 08 			LD		bc,(BLKSIZE)
0623   04C1 ED B0       			LDIR
0624   04C3 C9          			RET
0625   04C4             ; END MOD-04
0626   04C4             ;
0627   04C4             ; START MOD-10 - Serial Echo
0628   04C4 DB 07       MOD10:		IN		a,(SERSTATUS)
0629   04C6 CB 4F       			BIT		1,a
0630   04C8 C4 CE 04    			CALL	nz,M10RCV ; Have we received data?
0631   04CB C3 C4 04    			JP		MOD10
0632   04CE             
0633   04CE DB 06       M10RCV:		IN		a,(SERBUFFER)
0634   04D0 47          			LD		b,a
0635   04D1 CD D5 04    			CALL	M10XMIT
0636   04D4 C9          			RET
0637   04D5             
0638   04D5 DB 07       M10XMIT:	IN		a,(SERSTATUS)
0639   04D7 CB 47       			BIT		0,a
0640   04D9 C2 D5 04    			JP		nz,M10XMIT
0641   04DC 78          			LD		a,b
0642   04DD D3 06       			OUT		(SERBUFFER),a
0643   04DF AF          			XOR		a
0644   04E0 C9          			RET
0645   04E1             ; END MOD-10
0646   04E1             ; END MODULES.
0647   04E1             ;
0648   04E1             			.END
tasm: Number of errors = 0
